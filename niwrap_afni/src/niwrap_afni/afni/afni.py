# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

AFNI_METADATA = Metadata(
    id="976a6bf171352d9ba286989af93704f8127a9901.boutiques",
    name="afni",
    package="afni",
    container_image_tag="afni/afni_make_build:AFNI_24.2.06",
)


_AfniParamsDictNoTag = typing.TypedDict('_AfniParamsDictNoTag', {
    "session_directories": typing.NotRequired[str | None],
    "bysub": typing.NotRequired[list[str] | None],
    "all_dsets": bool,
    "purge": bool,
    "posfunc": bool,
    "recursive": bool,
    "no1D": bool,
    "nocsv": bool,
    "notsv": bool,
    "unique": bool,
    "orient": typing.NotRequired[str | None],
    "noplugins": bool,
    "seehidden": bool,
    "allow_all_plugins": bool,
    "yesplugouts": bool,
    "debug_plugouts": bool,
    "noplugouts": bool,
    "skip_afnirc": bool,
    "layout": typing.NotRequired[InputPathType | None],
    "niml": bool,
    "np": typing.NotRequired[int | None],
    "npq": typing.NotRequired[int | None],
    "npb": typing.NotRequired[int | None],
    "com": typing.NotRequired[str | None],
    "comsep": typing.NotRequired[str | None],
})
AfniParamsDictTagged = typing.TypedDict('AfniParamsDictTagged', {
    "@type": typing.Literal["afni/afni"],
    "session_directories": typing.NotRequired[str | None],
    "bysub": typing.NotRequired[list[str] | None],
    "all_dsets": bool,
    "purge": bool,
    "posfunc": bool,
    "recursive": bool,
    "no1D": bool,
    "nocsv": bool,
    "notsv": bool,
    "unique": bool,
    "orient": typing.NotRequired[str | None],
    "noplugins": bool,
    "seehidden": bool,
    "allow_all_plugins": bool,
    "yesplugouts": bool,
    "debug_plugouts": bool,
    "noplugouts": bool,
    "skip_afnirc": bool,
    "layout": typing.NotRequired[InputPathType | None],
    "niml": bool,
    "np": typing.NotRequired[int | None],
    "npq": typing.NotRequired[int | None],
    "npb": typing.NotRequired[int | None],
    "com": typing.NotRequired[str | None],
    "comsep": typing.NotRequired[str | None],
})
AfniParamsDict = _AfniParamsDictNoTag | AfniParamsDictTagged


class AfniOutputs(typing.NamedTuple):
    """
    Output object returned when calling `AfniParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    session_output: OutputPathType
    """Output file for the session data"""


def afni_params(
    session_directories: str | None = None,
    bysub: list[str] | None = None,
    all_dsets: bool = False,
    purge: bool = False,
    posfunc: bool = False,
    recursive: bool = False,
    no1_d: bool = False,
    nocsv: bool = False,
    notsv: bool = False,
    unique: bool = False,
    orient: str | None = None,
    noplugins: bool = False,
    seehidden: bool = False,
    allow_all_plugins: bool = False,
    yesplugouts: bool = False,
    debug_plugouts: bool = False,
    noplugouts: bool = False,
    skip_afnirc: bool = False,
    layout: InputPathType | None = None,
    niml: bool = False,
    np: int | None = None,
    npq: int | None = None,
    npb: int | None = None,
    com: str | None = None,
    comsep: str | None = None,
) -> AfniParamsDictTagged:
    """
    Build parameters.
    
    Args:
        session_directories: Input session directories containing the datasets.
        bysub: Gather all datasets corresponding to a single subject identifier.
        all_dsets: Read in all datasets from all listed folders together.
        purge: Conserve memory by purging unused datasets.
        posfunc: Start up the color 'pbar' to use only positive function values.
        recursive: Recursively search each session_directory for more session\
            subdirectories.
        no1_d: Tells AFNI not to read *.1D timeseries files.
        nocsv: Tells AFNI not to read *.csv files.
        notsv: Tells AFNI not to read *.tsv files.
        unique: Create a unique set of colors for each AFNI controller window.
        orient: Orientation code for displaying x-y-z coordinates.
        noplugins: Do not load plugins.
        seehidden: Show hidden plugins.
        allow_all_plugins: Do not hide plugins.
        yesplugouts: Listen for plugouts.
        debug_plugouts: Plugout code prints lots of messages (for debugging).
        noplugouts: Do not listen for plugouts.
        skip_afnirc: Do not read .afnirc file.
        layout: Read initial windows layout from a file.
        niml: Turn on listening for NIML-formatted data from SUMA.
        np: Provide a port offset for multiple instances.
        npq: Like -np but quieter in case of errors.
        npb: Provide a block of port numbers.
        com: Specify command strings to drive AFNI on startup.
        comsep: Character to use as a separator for commands.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "afni/afni",
        "all_dsets": all_dsets,
        "purge": purge,
        "posfunc": posfunc,
        "recursive": recursive,
        "no1D": no1_d,
        "nocsv": nocsv,
        "notsv": notsv,
        "unique": unique,
        "noplugins": noplugins,
        "seehidden": seehidden,
        "allow_all_plugins": allow_all_plugins,
        "yesplugouts": yesplugouts,
        "debug_plugouts": debug_plugouts,
        "noplugouts": noplugouts,
        "skip_afnirc": skip_afnirc,
        "niml": niml,
    }
    if session_directories is not None:
        params["session_directories"] = session_directories
    if bysub is not None:
        params["bysub"] = bysub
    if orient is not None:
        params["orient"] = orient
    if layout is not None:
        params["layout"] = layout
    if np is not None:
        params["np"] = np
    if npq is not None:
        params["npq"] = npq
    if npb is not None:
        params["npb"] = npb
    if com is not None:
        params["com"] = com
    if comsep is not None:
        params["comsep"] = comsep
    return params


def afni_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid `AfniParamsDict`
    object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("session_directories", None) is not None:
        if not isinstance(params["session_directories"], str):
            raise StyxValidationError(f'`session_directories` has the wrong type: Received `{type(params.get("session_directories", None))}` expected `str | None`')
    if params.get("bysub", None) is not None:
        if not isinstance(params["bysub"], list):
            raise StyxValidationError(f'`bysub` has the wrong type: Received `{type(params.get("bysub", None))}` expected `list[str] | None`')
        for e in params["bysub"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`bysub` has the wrong type: Received `{type(params.get("bysub", None))}` expected `list[str] | None`')
    if params.get("all_dsets", False) is None:
        raise StyxValidationError("`all_dsets` must not be None")
    if not isinstance(params["all_dsets"], bool):
        raise StyxValidationError(f'`all_dsets` has the wrong type: Received `{type(params.get("all_dsets", False))}` expected `bool`')
    if params.get("purge", False) is None:
        raise StyxValidationError("`purge` must not be None")
    if not isinstance(params["purge"], bool):
        raise StyxValidationError(f'`purge` has the wrong type: Received `{type(params.get("purge", False))}` expected `bool`')
    if params.get("posfunc", False) is None:
        raise StyxValidationError("`posfunc` must not be None")
    if not isinstance(params["posfunc"], bool):
        raise StyxValidationError(f'`posfunc` has the wrong type: Received `{type(params.get("posfunc", False))}` expected `bool`')
    if params.get("recursive", False) is None:
        raise StyxValidationError("`recursive` must not be None")
    if not isinstance(params["recursive"], bool):
        raise StyxValidationError(f'`recursive` has the wrong type: Received `{type(params.get("recursive", False))}` expected `bool`')
    if params.get("no1D", False) is None:
        raise StyxValidationError("`no1D` must not be None")
    if not isinstance(params["no1D"], bool):
        raise StyxValidationError(f'`no1D` has the wrong type: Received `{type(params.get("no1D", False))}` expected `bool`')
    if params.get("nocsv", False) is None:
        raise StyxValidationError("`nocsv` must not be None")
    if not isinstance(params["nocsv"], bool):
        raise StyxValidationError(f'`nocsv` has the wrong type: Received `{type(params.get("nocsv", False))}` expected `bool`')
    if params.get("notsv", False) is None:
        raise StyxValidationError("`notsv` must not be None")
    if not isinstance(params["notsv"], bool):
        raise StyxValidationError(f'`notsv` has the wrong type: Received `{type(params.get("notsv", False))}` expected `bool`')
    if params.get("unique", False) is None:
        raise StyxValidationError("`unique` must not be None")
    if not isinstance(params["unique"], bool):
        raise StyxValidationError(f'`unique` has the wrong type: Received `{type(params.get("unique", False))}` expected `bool`')
    if params.get("orient", None) is not None:
        if not isinstance(params["orient"], str):
            raise StyxValidationError(f'`orient` has the wrong type: Received `{type(params.get("orient", None))}` expected `str | None`')
    if params.get("noplugins", False) is None:
        raise StyxValidationError("`noplugins` must not be None")
    if not isinstance(params["noplugins"], bool):
        raise StyxValidationError(f'`noplugins` has the wrong type: Received `{type(params.get("noplugins", False))}` expected `bool`')
    if params.get("seehidden", False) is None:
        raise StyxValidationError("`seehidden` must not be None")
    if not isinstance(params["seehidden"], bool):
        raise StyxValidationError(f'`seehidden` has the wrong type: Received `{type(params.get("seehidden", False))}` expected `bool`')
    if params.get("allow_all_plugins", False) is None:
        raise StyxValidationError("`allow_all_plugins` must not be None")
    if not isinstance(params["allow_all_plugins"], bool):
        raise StyxValidationError(f'`allow_all_plugins` has the wrong type: Received `{type(params.get("allow_all_plugins", False))}` expected `bool`')
    if params.get("yesplugouts", False) is None:
        raise StyxValidationError("`yesplugouts` must not be None")
    if not isinstance(params["yesplugouts"], bool):
        raise StyxValidationError(f'`yesplugouts` has the wrong type: Received `{type(params.get("yesplugouts", False))}` expected `bool`')
    if params.get("debug_plugouts", False) is None:
        raise StyxValidationError("`debug_plugouts` must not be None")
    if not isinstance(params["debug_plugouts"], bool):
        raise StyxValidationError(f'`debug_plugouts` has the wrong type: Received `{type(params.get("debug_plugouts", False))}` expected `bool`')
    if params.get("noplugouts", False) is None:
        raise StyxValidationError("`noplugouts` must not be None")
    if not isinstance(params["noplugouts"], bool):
        raise StyxValidationError(f'`noplugouts` has the wrong type: Received `{type(params.get("noplugouts", False))}` expected `bool`')
    if params.get("skip_afnirc", False) is None:
        raise StyxValidationError("`skip_afnirc` must not be None")
    if not isinstance(params["skip_afnirc"], bool):
        raise StyxValidationError(f'`skip_afnirc` has the wrong type: Received `{type(params.get("skip_afnirc", False))}` expected `bool`')
    if params.get("layout", None) is not None:
        if not isinstance(params["layout"], (pathlib.Path, str)):
            raise StyxValidationError(f'`layout` has the wrong type: Received `{type(params.get("layout", None))}` expected `InputPathType | None`')
    if params.get("niml", False) is None:
        raise StyxValidationError("`niml` must not be None")
    if not isinstance(params["niml"], bool):
        raise StyxValidationError(f'`niml` has the wrong type: Received `{type(params.get("niml", False))}` expected `bool`')
    if params.get("np", None) is not None:
        if not isinstance(params["np"], int):
            raise StyxValidationError(f'`np` has the wrong type: Received `{type(params.get("np", None))}` expected `int | None`')
    if params.get("npq", None) is not None:
        if not isinstance(params["npq"], int):
            raise StyxValidationError(f'`npq` has the wrong type: Received `{type(params.get("npq", None))}` expected `int | None`')
    if params.get("npb", None) is not None:
        if not isinstance(params["npb"], int):
            raise StyxValidationError(f'`npb` has the wrong type: Received `{type(params.get("npb", None))}` expected `int | None`')
    if params.get("com", None) is not None:
        if not isinstance(params["com"], str):
            raise StyxValidationError(f'`com` has the wrong type: Received `{type(params.get("com", None))}` expected `str | None`')
    if params.get("comsep", None) is not None:
        if not isinstance(params["comsep"], str):
            raise StyxValidationError(f'`comsep` has the wrong type: Received `{type(params.get("comsep", None))}` expected `str | None`')


def afni_cargs(
    params: AfniParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("afni")
    if params.get("session_directories", None) is not None:
        cargs.append(params.get("session_directories", None))
    if params.get("bysub", None) is not None:
        cargs.extend([
            "-bysub",
            *params.get("bysub", None)
        ])
    if params.get("all_dsets", False):
        cargs.append("-all_dsets")
    if params.get("purge", False):
        cargs.append("-purge")
    if params.get("posfunc", False):
        cargs.append("-posfunc")
    if params.get("recursive", False):
        cargs.append("-R")
    if params.get("no1D", False):
        cargs.append("-no1D")
    if params.get("nocsv", False):
        cargs.append("-nocsv")
    if params.get("notsv", False):
        cargs.append("-notsv")
    if params.get("unique", False):
        cargs.append("-unique")
    if params.get("orient", None) is not None:
        cargs.extend([
            "-orient",
            params.get("orient", None)
        ])
    if params.get("noplugins", False):
        cargs.append("-noplugins")
    if params.get("seehidden", False):
        cargs.append("-seehidden")
    if params.get("allow_all_plugins", False):
        cargs.append("-DAFNI_ALLOW_ALL_PLUGINS=YES")
    if params.get("yesplugouts", False):
        cargs.append("-yesplugouts")
    if params.get("debug_plugouts", False):
        cargs.append("-YESplugouts")
    if params.get("noplugouts", False):
        cargs.append("-noplugouts")
    if params.get("skip_afnirc", False):
        cargs.append("-skip_afnirc")
    if params.get("layout", None) is not None:
        cargs.extend([
            "-layout",
            execution.input_file(params.get("layout", None))
        ])
    if params.get("niml", False):
        cargs.append("-niml")
    if params.get("np", None) is not None:
        cargs.extend([
            "-np",
            str(params.get("np", None))
        ])
    if params.get("npq", None) is not None:
        cargs.extend([
            "-npq",
            str(params.get("npq", None))
        ])
    if params.get("npb", None) is not None:
        cargs.extend([
            "-npb",
            str(params.get("npb", None))
        ])
    if params.get("com", None) is not None:
        cargs.extend([
            "-com",
            params.get("com", None)
        ])
    if params.get("comsep", None) is not None:
        cargs.extend([
            "-comsep",
            params.get("comsep", None)
        ])
    return cargs


def afni_outputs(
    params: AfniParamsDict,
    execution: Execution,
) -> AfniOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = AfniOutputs(
        root=execution.output_file("."),
        session_output=execution.output_file("output_session.nii.gz"),
    )
    return ret


def afni_execute(
    params: AfniParamsDict,
    runner: Runner | None = None,
) -> AfniOutputs:
    """
    afni
    
    Tool for reading in sessions of 3D datasets and visualizing them.
    
    Author: AFNI Developers
    
    URL: https://afni.nimh.nih.gov/
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `AfniOutputs`).
    """
    afni_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(AFNI_METADATA)
    params = execution.params(params)
    cargs = afni_cargs(params, execution)
    ret = afni_outputs(params, execution)
    execution.run(cargs)
    return ret


def afni_(
    session_directories: str | None = None,
    bysub: list[str] | None = None,
    all_dsets: bool = False,
    purge: bool = False,
    posfunc: bool = False,
    recursive: bool = False,
    no1_d: bool = False,
    nocsv: bool = False,
    notsv: bool = False,
    unique: bool = False,
    orient: str | None = None,
    noplugins: bool = False,
    seehidden: bool = False,
    allow_all_plugins: bool = False,
    yesplugouts: bool = False,
    debug_plugouts: bool = False,
    noplugouts: bool = False,
    skip_afnirc: bool = False,
    layout: InputPathType | None = None,
    niml: bool = False,
    np: int | None = None,
    npq: int | None = None,
    npb: int | None = None,
    com: str | None = None,
    comsep: str | None = None,
    runner: Runner | None = None,
) -> AfniOutputs:
    """
    afni
    
    Tool for reading in sessions of 3D datasets and visualizing them.
    
    Author: AFNI Developers
    
    URL: https://afni.nimh.nih.gov/
    
    Args:
        session_directories: Input session directories containing the datasets.
        bysub: Gather all datasets corresponding to a single subject identifier.
        all_dsets: Read in all datasets from all listed folders together.
        purge: Conserve memory by purging unused datasets.
        posfunc: Start up the color 'pbar' to use only positive function values.
        recursive: Recursively search each session_directory for more session\
            subdirectories.
        no1_d: Tells AFNI not to read *.1D timeseries files.
        nocsv: Tells AFNI not to read *.csv files.
        notsv: Tells AFNI not to read *.tsv files.
        unique: Create a unique set of colors for each AFNI controller window.
        orient: Orientation code for displaying x-y-z coordinates.
        noplugins: Do not load plugins.
        seehidden: Show hidden plugins.
        allow_all_plugins: Do not hide plugins.
        yesplugouts: Listen for plugouts.
        debug_plugouts: Plugout code prints lots of messages (for debugging).
        noplugouts: Do not listen for plugouts.
        skip_afnirc: Do not read .afnirc file.
        layout: Read initial windows layout from a file.
        niml: Turn on listening for NIML-formatted data from SUMA.
        np: Provide a port offset for multiple instances.
        npq: Like -np but quieter in case of errors.
        npb: Provide a block of port numbers.
        com: Specify command strings to drive AFNI on startup.
        comsep: Character to use as a separator for commands.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `AfniOutputs`).
    """
    params = afni_params(
        session_directories=session_directories,
        bysub=bysub,
        all_dsets=all_dsets,
        purge=purge,
        posfunc=posfunc,
        recursive=recursive,
        no1_d=no1_d,
        nocsv=nocsv,
        notsv=notsv,
        unique=unique,
        orient=orient,
        noplugins=noplugins,
        seehidden=seehidden,
        allow_all_plugins=allow_all_plugins,
        yesplugouts=yesplugouts,
        debug_plugouts=debug_plugouts,
        noplugouts=noplugouts,
        skip_afnirc=skip_afnirc,
        layout=layout,
        niml=niml,
        np=np,
        npq=npq,
        npb=npb,
        com=com,
        comsep=comsep,
    )
    return afni_execute(params, runner)


__all__ = [
    "AFNI_METADATA",
    "AfniOutputs",
    "AfniParamsDict",
    "AfniParamsDictTagged",
    "afni_",
    "afni_execute",
    "afni_params",
]
