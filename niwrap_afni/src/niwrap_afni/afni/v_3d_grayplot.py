# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

V_3D_GRAYPLOT_METADATA = Metadata(
    id="f6e3887ef52f450f8f7c42c285ca11d1dca72962.boutiques",
    name="3dGrayplot",
    package="afni",
    container_image_tag="afni/afni_make_build:AFNI_24.2.06",
)


_V3dGrayplotParamsDictNoTag = typing.TypedDict('_V3dGrayplotParamsDictNoTag', {
    "input": InputPathType,
    "mask": typing.NotRequired[InputPathType | None],
    "prefix": typing.NotRequired[str | None],
    "dimensions": typing.NotRequired[list[float] | None],
    "resample_old": bool,
    "polort": typing.NotRequired[float | None],
    "fwhm": typing.NotRequired[float | None],
    "pvorder": bool,
    "LJorder": bool,
    "peelorder": bool,
    "ijkorder": bool,
    "range": typing.NotRequired[float | None],
    "percent": bool,
    "raw_with_bounds": typing.NotRequired[list[float] | None],
})
V3dGrayplotParamsDictTagged = typing.TypedDict('V3dGrayplotParamsDictTagged', {
    "@type": typing.Literal["afni/3dGrayplot"],
    "input": InputPathType,
    "mask": typing.NotRequired[InputPathType | None],
    "prefix": typing.NotRequired[str | None],
    "dimensions": typing.NotRequired[list[float] | None],
    "resample_old": bool,
    "polort": typing.NotRequired[float | None],
    "fwhm": typing.NotRequired[float | None],
    "pvorder": bool,
    "LJorder": bool,
    "peelorder": bool,
    "ijkorder": bool,
    "range": typing.NotRequired[float | None],
    "percent": bool,
    "raw_with_bounds": typing.NotRequired[list[float] | None],
})
V3dGrayplotParamsDict = _V3dGrayplotParamsDictNoTag | V3dGrayplotParamsDictTagged


class V3dGrayplotOutputs(typing.NamedTuple):
    """
    Output object returned when calling `V3dGrayplotParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    grayplot_img: OutputPathType | None
    """Grayplot image file"""


def v_3d_grayplot_params(
    input_: InputPathType,
    mask: InputPathType | None = None,
    prefix: str | None = None,
    dimensions: list[float] | None = None,
    resample_old: bool = False,
    polort: float | None = None,
    fwhm: float | None = None,
    pvorder: bool = False,
    ljorder: bool = False,
    peelorder: bool = False,
    ijkorder: bool = False,
    range_: float | None = None,
    percent: bool = False,
    raw_with_bounds: list[float] | None = None,
) -> V3dGrayplotParamsDictTagged:
    """
    Build parameters.
    
    Args:
        input_: Input dataset.
        mask: Name of mask dataset. Voxels that are 0 in the mask will not be\
            processed.
        prefix: Name for the output file. Default is Grayplot.png.
        dimensions: Output size of image in pixels: [width height]. Defaults\
            are width=1024 and height=512.
        resample_old: Original resampling method for processed dataset.
        polort: Order of polynomials for detrending. Default is 2. Use '-1' if\
            data is already detrended and de-meaned.
        fwhm: FWHM of blurring radius to use in the dataset before making the\
            image. Default is 0 mm.
        pvorder: Order the voxels by how well they match the two leading\
            principal components of their partition.
        ljorder: Order the voxels by their Ljung-Box statistics, a measure of\
            temporal correlation.
        peelorder: Order the voxels by how many 'peel' steps are needed to get\
            from the partition boundary to the voxel.
        ijkorder: Default intra-partition ordering by dataset 3D index ('ijk').
        range_: Set the range of the data to be plotted. Value of 0 is\
            middle-gray, +X is white, -X is black.
        percent: Scale values to percent differences from the mean of each\
            voxel timeseries. Suitable for raw time series datasets.
        raw_with_bounds: Map values <= A to black, values >= B to white, and\
            intermediate values to grays.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "afni/3dGrayplot",
        "input": input_,
        "resample_old": resample_old,
        "pvorder": pvorder,
        "LJorder": ljorder,
        "peelorder": peelorder,
        "ijkorder": ijkorder,
        "percent": percent,
    }
    if mask is not None:
        params["mask"] = mask
    if prefix is not None:
        params["prefix"] = prefix
    if dimensions is not None:
        params["dimensions"] = dimensions
    if polort is not None:
        params["polort"] = polort
    if fwhm is not None:
        params["fwhm"] = fwhm
    if range_ is not None:
        params["range"] = range_
    if raw_with_bounds is not None:
        params["raw_with_bounds"] = raw_with_bounds
    return params


def v_3d_grayplot_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `V3dGrayplotParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("input", None) is None:
        raise StyxValidationError("`input` must not be None")
    if not isinstance(params["input"], (pathlib.Path, str)):
        raise StyxValidationError(f'`input` has the wrong type: Received `{type(params.get("input", None))}` expected `InputPathType`')
    if params.get("mask", None) is not None:
        if not isinstance(params["mask"], (pathlib.Path, str)):
            raise StyxValidationError(f'`mask` has the wrong type: Received `{type(params.get("mask", None))}` expected `InputPathType | None`')
    if params.get("prefix", None) is not None:
        if not isinstance(params["prefix"], str):
            raise StyxValidationError(f'`prefix` has the wrong type: Received `{type(params.get("prefix", None))}` expected `str | None`')
    if params.get("dimensions", None) is not None:
        if not isinstance(params["dimensions"], list):
            raise StyxValidationError(f'`dimensions` has the wrong type: Received `{type(params.get("dimensions", None))}` expected `list[float] | None`')
        if len(params["dimensions"]) != 2:
            raise StyxValidationError("Parameter `dimensions` must contain exactly 2 elements")
        for e in params["dimensions"]:
            if not isinstance(e, (float, int)):
                raise StyxValidationError(f'`dimensions` has the wrong type: Received `{type(params.get("dimensions", None))}` expected `list[float] | None`')
    if params.get("resample_old", False) is None:
        raise StyxValidationError("`resample_old` must not be None")
    if not isinstance(params["resample_old"], bool):
        raise StyxValidationError(f'`resample_old` has the wrong type: Received `{type(params.get("resample_old", False))}` expected `bool`')
    if params.get("polort", None) is not None:
        if not isinstance(params["polort"], (float, int)):
            raise StyxValidationError(f'`polort` has the wrong type: Received `{type(params.get("polort", None))}` expected `float | None`')
    if params.get("fwhm", None) is not None:
        if not isinstance(params["fwhm"], (float, int)):
            raise StyxValidationError(f'`fwhm` has the wrong type: Received `{type(params.get("fwhm", None))}` expected `float | None`')
    if params.get("pvorder", False) is None:
        raise StyxValidationError("`pvorder` must not be None")
    if not isinstance(params["pvorder"], bool):
        raise StyxValidationError(f'`pvorder` has the wrong type: Received `{type(params.get("pvorder", False))}` expected `bool`')
    if params.get("LJorder", False) is None:
        raise StyxValidationError("`LJorder` must not be None")
    if not isinstance(params["LJorder"], bool):
        raise StyxValidationError(f'`LJorder` has the wrong type: Received `{type(params.get("LJorder", False))}` expected `bool`')
    if params.get("peelorder", False) is None:
        raise StyxValidationError("`peelorder` must not be None")
    if not isinstance(params["peelorder"], bool):
        raise StyxValidationError(f'`peelorder` has the wrong type: Received `{type(params.get("peelorder", False))}` expected `bool`')
    if params.get("ijkorder", False) is None:
        raise StyxValidationError("`ijkorder` must not be None")
    if not isinstance(params["ijkorder"], bool):
        raise StyxValidationError(f'`ijkorder` has the wrong type: Received `{type(params.get("ijkorder", False))}` expected `bool`')
    if params.get("range", None) is not None:
        if not isinstance(params["range"], (float, int)):
            raise StyxValidationError(f'`range` has the wrong type: Received `{type(params.get("range", None))}` expected `float | None`')
    if params.get("percent", False) is None:
        raise StyxValidationError("`percent` must not be None")
    if not isinstance(params["percent"], bool):
        raise StyxValidationError(f'`percent` has the wrong type: Received `{type(params.get("percent", False))}` expected `bool`')
    if params.get("raw_with_bounds", None) is not None:
        if not isinstance(params["raw_with_bounds"], list):
            raise StyxValidationError(f'`raw_with_bounds` has the wrong type: Received `{type(params.get("raw_with_bounds", None))}` expected `list[float] | None`')
        if len(params["raw_with_bounds"]) != 2:
            raise StyxValidationError("Parameter `raw_with_bounds` must contain exactly 2 elements")
        for e in params["raw_with_bounds"]:
            if not isinstance(e, (float, int)):
                raise StyxValidationError(f'`raw_with_bounds` has the wrong type: Received `{type(params.get("raw_with_bounds", None))}` expected `list[float] | None`')


def v_3d_grayplot_cargs(
    params: V3dGrayplotParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("3dGrayplot")
    cargs.append(execution.input_file(params.get("input", None)))
    if params.get("mask", None) is not None:
        cargs.extend([
            "-mask",
            execution.input_file(params.get("mask", None))
        ])
    if params.get("prefix", None) is not None:
        cargs.extend([
            "-prefix",
            params.get("prefix", None)
        ])
    if params.get("dimensions", None) is not None:
        cargs.extend([
            "-dimen",
            *map(str, params.get("dimensions", None))
        ])
    if params.get("resample_old", False):
        cargs.append("-oldresam")
    if params.get("polort", None) is not None:
        cargs.extend([
            "-polort",
            str(params.get("polort", None))
        ])
    if params.get("fwhm", None) is not None:
        cargs.extend([
            "-fwhm",
            str(params.get("fwhm", None))
        ])
    if params.get("pvorder", False):
        cargs.append("-pvorder")
    if params.get("LJorder", False):
        cargs.append("-LJorder")
    if params.get("peelorder", False):
        cargs.append("-peelorder")
    if params.get("ijkorder", False):
        cargs.append("-ijkorder")
    if params.get("range", None) is not None:
        cargs.extend([
            "-range",
            str(params.get("range", None))
        ])
    if params.get("percent", False):
        cargs.append("-percent")
    if params.get("raw_with_bounds", None) is not None:
        cargs.extend([
            "-raw_with_bounds",
            *map(str, params.get("raw_with_bounds", None))
        ])
    return cargs


def v_3d_grayplot_outputs(
    params: V3dGrayplotParamsDict,
    execution: Execution,
) -> V3dGrayplotOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = V3dGrayplotOutputs(
        root=execution.output_file("."),
        grayplot_img=execution.output_file(params.get("prefix", None)) if (params.get("prefix") is not None) else None,
    )
    return ret


def v_3d_grayplot_execute(
    params: V3dGrayplotParamsDict,
    runner: Runner | None = None,
) -> V3dGrayplotOutputs:
    """
    3dGrayplot
    
    Make a grayplot from a 3D+time dataset, like a carpet plot. Result is saved
    to a PNG image.
    
    Author: AFNI Developers
    
    URL: https://afni.nimh.nih.gov/
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `V3dGrayplotOutputs`).
    """
    v_3d_grayplot_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(V_3D_GRAYPLOT_METADATA)
    params = execution.params(params)
    cargs = v_3d_grayplot_cargs(params, execution)
    ret = v_3d_grayplot_outputs(params, execution)
    execution.run(cargs)
    return ret


def v_3d_grayplot(
    input_: InputPathType,
    mask: InputPathType | None = None,
    prefix: str | None = None,
    dimensions: list[float] | None = None,
    resample_old: bool = False,
    polort: float | None = None,
    fwhm: float | None = None,
    pvorder: bool = False,
    ljorder: bool = False,
    peelorder: bool = False,
    ijkorder: bool = False,
    range_: float | None = None,
    percent: bool = False,
    raw_with_bounds: list[float] | None = None,
    runner: Runner | None = None,
) -> V3dGrayplotOutputs:
    """
    3dGrayplot
    
    Make a grayplot from a 3D+time dataset, like a carpet plot. Result is saved
    to a PNG image.
    
    Author: AFNI Developers
    
    URL: https://afni.nimh.nih.gov/
    
    Args:
        input_: Input dataset.
        mask: Name of mask dataset. Voxels that are 0 in the mask will not be\
            processed.
        prefix: Name for the output file. Default is Grayplot.png.
        dimensions: Output size of image in pixels: [width height]. Defaults\
            are width=1024 and height=512.
        resample_old: Original resampling method for processed dataset.
        polort: Order of polynomials for detrending. Default is 2. Use '-1' if\
            data is already detrended and de-meaned.
        fwhm: FWHM of blurring radius to use in the dataset before making the\
            image. Default is 0 mm.
        pvorder: Order the voxels by how well they match the two leading\
            principal components of their partition.
        ljorder: Order the voxels by their Ljung-Box statistics, a measure of\
            temporal correlation.
        peelorder: Order the voxels by how many 'peel' steps are needed to get\
            from the partition boundary to the voxel.
        ijkorder: Default intra-partition ordering by dataset 3D index ('ijk').
        range_: Set the range of the data to be plotted. Value of 0 is\
            middle-gray, +X is white, -X is black.
        percent: Scale values to percent differences from the mean of each\
            voxel timeseries. Suitable for raw time series datasets.
        raw_with_bounds: Map values <= A to black, values >= B to white, and\
            intermediate values to grays.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `V3dGrayplotOutputs`).
    """
    params = v_3d_grayplot_params(
        input_=input_,
        mask=mask,
        prefix=prefix,
        dimensions=dimensions,
        resample_old=resample_old,
        polort=polort,
        fwhm=fwhm,
        pvorder=pvorder,
        ljorder=ljorder,
        peelorder=peelorder,
        ijkorder=ijkorder,
        range_=range_,
        percent=percent,
        raw_with_bounds=raw_with_bounds,
    )
    return v_3d_grayplot_execute(params, runner)


__all__ = [
    "V3dGrayplotOutputs",
    "V3dGrayplotParamsDict",
    "V3dGrayplotParamsDictTagged",
    "V_3D_GRAYPLOT_METADATA",
    "v_3d_grayplot",
    "v_3d_grayplot_execute",
    "v_3d_grayplot_params",
]
