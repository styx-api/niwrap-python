# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

RTFEEDME_METADATA = Metadata(
    id="031662f7ace1e435c0c343699a3380e8eef5d84a.boutiques",
    name="rtfeedme",
    package="afni",
    container_image_tag="afni/afni_make_build:AFNI_24.2.06",
)


_RtfeedmeParamsDictNoTag = typing.TypedDict('_RtfeedmeParamsDictNoTag', {
    "datasets": list[InputPathType],
    "host": typing.NotRequired[str | None],
    "interval_ms": typing.NotRequired[float | None],
    "send_3d": bool,
    "buffer_mb": typing.NotRequired[float | None],
    "verbose": bool,
    "swap_bytes": bool,
    "nz_fake": typing.NotRequired[float | None],
    "drive_cmd": typing.NotRequired[list[str] | None],
    "note": typing.NotRequired[list[str] | None],
    "yrange": typing.NotRequired[float | None],
})
RtfeedmeParamsDictTagged = typing.TypedDict('RtfeedmeParamsDictTagged', {
    "@type": typing.Literal["afni/rtfeedme"],
    "datasets": list[InputPathType],
    "host": typing.NotRequired[str | None],
    "interval_ms": typing.NotRequired[float | None],
    "send_3d": bool,
    "buffer_mb": typing.NotRequired[float | None],
    "verbose": bool,
    "swap_bytes": bool,
    "nz_fake": typing.NotRequired[float | None],
    "drive_cmd": typing.NotRequired[list[str] | None],
    "note": typing.NotRequired[list[str] | None],
    "yrange": typing.NotRequired[float | None],
})
RtfeedmeParamsDict = _RtfeedmeParamsDictNoTag | RtfeedmeParamsDictTagged


class RtfeedmeOutputs(typing.NamedTuple):
    """
    Output object returned when calling `RtfeedmeParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""


def rtfeedme_params(
    datasets: list[InputPathType],
    host: str | None = None,
    interval_ms: float | None = None,
    send_3d: bool = False,
    buffer_mb: float | None = None,
    verbose: bool = False,
    swap_bytes: bool = False,
    nz_fake: float | None = None,
    drive_cmd: list[str] | None = None,
    note: list[str] | None = None,
    yrange: float | None = None,
) -> RtfeedmeParamsDictTagged:
    """
    Build parameters.
    
    Args:
        datasets: List of datasets to send to AFNI, specified as paths to\
            dataset files. Multiple datasets can be specified.
        host: Send data via TCP/IP to AFNI running on the specified computer\
            system 'sname'. Default is the current system using shared memory. Use\
            'localhost' to send on the current system using TCP/IP.
        interval_ms: Inter-transmit interval in milliseconds. Default is to\
            send data as fast as possible.
        send_3d: Send data in 3D bricks. Default is 2D slices.
        buffer_mb: Set the interprocess communications buffer size in megabytes\
            when using shared memory. Has no effect if using TCP/IP. Default is 1\
            MB; if set to 0, a 50 KB buffer is used.
        verbose: Be talkative about actions.
        swap_bytes: Swap byte pairs before sending data.
        nz_fake: Send 'nz' as the value of nzz for debugging purposes.
        drive_cmd: Send 'cmd' as a DRIVE_AFNI command. If 'cmd' contains\
            spaces, it must be quoted. Multiple -drive options can be used.
        note: Send 'sss' as a NOTE to the realtime plugin. Multiple -note\
            options can be used.
        yrange: Send value 'v' as the y-range for realtime motion estimation\
            graphing.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "afni/rtfeedme",
        "datasets": datasets,
        "send_3d": send_3d,
        "verbose": verbose,
        "swap_bytes": swap_bytes,
    }
    if host is not None:
        params["host"] = host
    if interval_ms is not None:
        params["interval_ms"] = interval_ms
    if buffer_mb is not None:
        params["buffer_mb"] = buffer_mb
    if nz_fake is not None:
        params["nz_fake"] = nz_fake
    if drive_cmd is not None:
        params["drive_cmd"] = drive_cmd
    if note is not None:
        params["note"] = note
    if yrange is not None:
        params["yrange"] = yrange
    return params


def rtfeedme_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `RtfeedmeParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("datasets", None) is None:
        raise StyxValidationError("`datasets` must not be None")
    if not isinstance(params["datasets"], list):
        raise StyxValidationError(f'`datasets` has the wrong type: Received `{type(params.get("datasets", None))}` expected `list[InputPathType]`')
    for e in params["datasets"]:
        if not isinstance(e, (pathlib.Path, str)):
            raise StyxValidationError(f'`datasets` has the wrong type: Received `{type(params.get("datasets", None))}` expected `list[InputPathType]`')
    if params.get("host", None) is not None:
        if not isinstance(params["host"], str):
            raise StyxValidationError(f'`host` has the wrong type: Received `{type(params.get("host", None))}` expected `str | None`')
    if params.get("interval_ms", None) is not None:
        if not isinstance(params["interval_ms"], (float, int)):
            raise StyxValidationError(f'`interval_ms` has the wrong type: Received `{type(params.get("interval_ms", None))}` expected `float | None`')
    if params.get("send_3d", False) is None:
        raise StyxValidationError("`send_3d` must not be None")
    if not isinstance(params["send_3d"], bool):
        raise StyxValidationError(f'`send_3d` has the wrong type: Received `{type(params.get("send_3d", False))}` expected `bool`')
    if params.get("buffer_mb", None) is not None:
        if not isinstance(params["buffer_mb"], (float, int)):
            raise StyxValidationError(f'`buffer_mb` has the wrong type: Received `{type(params.get("buffer_mb", None))}` expected `float | None`')
    if params.get("verbose", False) is None:
        raise StyxValidationError("`verbose` must not be None")
    if not isinstance(params["verbose"], bool):
        raise StyxValidationError(f'`verbose` has the wrong type: Received `{type(params.get("verbose", False))}` expected `bool`')
    if params.get("swap_bytes", False) is None:
        raise StyxValidationError("`swap_bytes` must not be None")
    if not isinstance(params["swap_bytes"], bool):
        raise StyxValidationError(f'`swap_bytes` has the wrong type: Received `{type(params.get("swap_bytes", False))}` expected `bool`')
    if params.get("nz_fake", None) is not None:
        if not isinstance(params["nz_fake"], (float, int)):
            raise StyxValidationError(f'`nz_fake` has the wrong type: Received `{type(params.get("nz_fake", None))}` expected `float | None`')
    if params.get("drive_cmd", None) is not None:
        if not isinstance(params["drive_cmd"], list):
            raise StyxValidationError(f'`drive_cmd` has the wrong type: Received `{type(params.get("drive_cmd", None))}` expected `list[str] | None`')
        for e in params["drive_cmd"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`drive_cmd` has the wrong type: Received `{type(params.get("drive_cmd", None))}` expected `list[str] | None`')
    if params.get("note", None) is not None:
        if not isinstance(params["note"], list):
            raise StyxValidationError(f'`note` has the wrong type: Received `{type(params.get("note", None))}` expected `list[str] | None`')
        for e in params["note"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`note` has the wrong type: Received `{type(params.get("note", None))}` expected `list[str] | None`')
    if params.get("yrange", None) is not None:
        if not isinstance(params["yrange"], (float, int)):
            raise StyxValidationError(f'`yrange` has the wrong type: Received `{type(params.get("yrange", None))}` expected `float | None`')


def rtfeedme_cargs(
    params: RtfeedmeParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("rtfeedme")
    cargs.extend([execution.input_file(f) for f in params.get("datasets", None)])
    if params.get("host", None) is not None:
        cargs.extend([
            "-host",
            params.get("host", None)
        ])
    if params.get("interval_ms", None) is not None:
        cargs.extend([
            "-dt",
            str(params.get("interval_ms", None))
        ])
    if params.get("send_3d", False):
        cargs.append("-3D")
    if params.get("buffer_mb", None) is not None:
        cargs.extend([
            "-buf",
            str(params.get("buffer_mb", None))
        ])
    if params.get("verbose", False):
        cargs.append("-verbose")
    if params.get("swap_bytes", False):
        cargs.append("-swap2")
    if params.get("nz_fake", None) is not None:
        cargs.extend([
            "-nzfake",
            str(params.get("nz_fake", None))
        ])
    if params.get("drive_cmd", None) is not None:
        cargs.extend([
            "-drive",
            *params.get("drive_cmd", None)
        ])
    if params.get("note", None) is not None:
        cargs.extend([
            "-note",
            *params.get("note", None)
        ])
    if params.get("yrange", None) is not None:
        cargs.extend([
            "-gyr",
            str(params.get("yrange", None))
        ])
    return cargs


def rtfeedme_outputs(
    params: RtfeedmeParamsDict,
    execution: Execution,
) -> RtfeedmeOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = RtfeedmeOutputs(
        root=execution.output_file("."),
    )
    return ret


def rtfeedme_execute(
    params: RtfeedmeParamsDict,
    runner: Runner | None = None,
) -> RtfeedmeOutputs:
    """
    rtfeedme
    
    Test the real-time plugin by sending all the bricks in 'dataset' to AFNI.
    
    Author: AFNI Developers
    
    URL: https://afni.nimh.nih.gov/
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `RtfeedmeOutputs`).
    """
    rtfeedme_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(RTFEEDME_METADATA)
    params = execution.params(params)
    cargs = rtfeedme_cargs(params, execution)
    ret = rtfeedme_outputs(params, execution)
    execution.run(cargs)
    return ret


def rtfeedme(
    datasets: list[InputPathType],
    host: str | None = None,
    interval_ms: float | None = None,
    send_3d: bool = False,
    buffer_mb: float | None = None,
    verbose: bool = False,
    swap_bytes: bool = False,
    nz_fake: float | None = None,
    drive_cmd: list[str] | None = None,
    note: list[str] | None = None,
    yrange: float | None = None,
    runner: Runner | None = None,
) -> RtfeedmeOutputs:
    """
    rtfeedme
    
    Test the real-time plugin by sending all the bricks in 'dataset' to AFNI.
    
    Author: AFNI Developers
    
    URL: https://afni.nimh.nih.gov/
    
    Args:
        datasets: List of datasets to send to AFNI, specified as paths to\
            dataset files. Multiple datasets can be specified.
        host: Send data via TCP/IP to AFNI running on the specified computer\
            system 'sname'. Default is the current system using shared memory. Use\
            'localhost' to send on the current system using TCP/IP.
        interval_ms: Inter-transmit interval in milliseconds. Default is to\
            send data as fast as possible.
        send_3d: Send data in 3D bricks. Default is 2D slices.
        buffer_mb: Set the interprocess communications buffer size in megabytes\
            when using shared memory. Has no effect if using TCP/IP. Default is 1\
            MB; if set to 0, a 50 KB buffer is used.
        verbose: Be talkative about actions.
        swap_bytes: Swap byte pairs before sending data.
        nz_fake: Send 'nz' as the value of nzz for debugging purposes.
        drive_cmd: Send 'cmd' as a DRIVE_AFNI command. If 'cmd' contains\
            spaces, it must be quoted. Multiple -drive options can be used.
        note: Send 'sss' as a NOTE to the realtime plugin. Multiple -note\
            options can be used.
        yrange: Send value 'v' as the y-range for realtime motion estimation\
            graphing.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `RtfeedmeOutputs`).
    """
    params = rtfeedme_params(
        datasets=datasets,
        host=host,
        interval_ms=interval_ms,
        send_3d=send_3d,
        buffer_mb=buffer_mb,
        verbose=verbose,
        swap_bytes=swap_bytes,
        nz_fake=nz_fake,
        drive_cmd=drive_cmd,
        note=note,
        yrange=yrange,
    )
    return rtfeedme_execute(params, runner)


__all__ = [
    "RTFEEDME_METADATA",
    "RtfeedmeOutputs",
    "RtfeedmeParamsDict",
    "RtfeedmeParamsDictTagged",
    "rtfeedme",
    "rtfeedme_execute",
    "rtfeedme_params",
]
