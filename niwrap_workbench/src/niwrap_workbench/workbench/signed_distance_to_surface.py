# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

SIGNED_DISTANCE_TO_SURFACE_METADATA = Metadata(
    id="344a7869e0c667f1b8e4af3135dc6ab6eadc0253.workbench",
    name="signed-distance-to-surface",
    package="workbench",
    container_image_tag="nx10x/workbench:2.1.0",
)


_SignedDistanceToSurfaceParamsDictNoTag = typing.TypedDict('_SignedDistanceToSurfaceParamsDictNoTag', {
    "surface-comp": InputPathType,
    "surface-ref": InputPathType,
    "metric": str,
    "method": typing.NotRequired[str | None],
})
SignedDistanceToSurfaceParamsDictTagged = typing.TypedDict('SignedDistanceToSurfaceParamsDictTagged', {
    "@type": typing.Literal["workbench/signed-distance-to-surface"],
    "surface-comp": InputPathType,
    "surface-ref": InputPathType,
    "metric": str,
    "method": typing.NotRequired[str | None],
})
SignedDistanceToSurfaceParamsDict = _SignedDistanceToSurfaceParamsDictNoTag | SignedDistanceToSurfaceParamsDictTagged


class SignedDistanceToSurfaceOutputs(typing.NamedTuple):
    """
    Output object returned when calling `SignedDistanceToSurfaceParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    metric: OutputPathType
    """the output metric"""


def signed_distance_to_surface_params(
    surface_comp: InputPathType,
    surface_ref: InputPathType,
    metric: str,
    method: str | None = None,
) -> SignedDistanceToSurfaceParamsDictTagged:
    """
    Build parameters.
    
    Args:
        surface_comp: the comparison surface to measure the signed distance on.
        surface_ref: the reference surface that defines the signed distance\
            function.
        metric: the output metric.
        method: winding method for point inside surface test\
            \
            name of the method (default EVEN_ODD).
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "workbench/signed-distance-to-surface",
        "surface-comp": surface_comp,
        "surface-ref": surface_ref,
        "metric": metric,
    }
    if method is not None:
        params["method"] = method
    return params


def signed_distance_to_surface_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `SignedDistanceToSurfaceParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("surface-comp", None) is None:
        raise StyxValidationError("`surface-comp` must not be None")
    if not isinstance(params["surface-comp"], (pathlib.Path, str)):
        raise StyxValidationError(f'`surface-comp` has the wrong type: Received `{type(params.get("surface-comp", None))}` expected `InputPathType`')
    if params.get("surface-ref", None) is None:
        raise StyxValidationError("`surface-ref` must not be None")
    if not isinstance(params["surface-ref"], (pathlib.Path, str)):
        raise StyxValidationError(f'`surface-ref` has the wrong type: Received `{type(params.get("surface-ref", None))}` expected `InputPathType`')
    if params.get("metric", None) is None:
        raise StyxValidationError("`metric` must not be None")
    if not isinstance(params["metric"], str):
        raise StyxValidationError(f'`metric` has the wrong type: Received `{type(params.get("metric", None))}` expected `str`')
    if params.get("method", None) is not None:
        if not isinstance(params["method"], str):
            raise StyxValidationError(f'`method` has the wrong type: Received `{type(params.get("method", None))}` expected `str | None`')


def signed_distance_to_surface_cargs(
    params: SignedDistanceToSurfaceParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "wb_command",
        "-signed-distance-to-surface"
    ])
    cargs.append(execution.input_file(params.get("surface-comp", None)))
    cargs.append(execution.input_file(params.get("surface-ref", None)))
    cargs.append(params.get("metric", None))
    if params.get("method", None) is not None:
        cargs.extend([
            "-winding",
            params.get("method", None)
        ])
    return cargs


def signed_distance_to_surface_outputs(
    params: SignedDistanceToSurfaceParamsDict,
    execution: Execution,
) -> SignedDistanceToSurfaceOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = SignedDistanceToSurfaceOutputs(
        root=execution.output_file("."),
        metric=execution.output_file(params.get("metric", None)),
    )
    return ret


def signed_distance_to_surface_execute(
    params: SignedDistanceToSurfaceParamsDict,
    runner: Runner | None = None,
) -> SignedDistanceToSurfaceOutputs:
    """
    COMPUTE SIGNED DISTANCE FROM ONE SURFACE TO ANOTHER.
    
    Compute the signed distance function of the reference surface at every
    vertex on the comparison surface. NOTE: this relation is NOT symmetric, the
    line from a vertex to the closest point on the 'ref' surface (the one that
    defines the signed distance function) will only align with the normal of the
    'ref' surface. Valid specifiers for winding methods are as follows:
    
    EVEN_ODD (default)
    NEGATIVE
    NONZERO
    NORMALS
    
    The NORMALS method uses the normals of triangles and edges, or the closest
    triangle hit by a ray from the point. This method may be slightly faster,
    but is only reliable for a closed surface that does not cross through
    itself. All other methods count entry (positive) and exit (negative)
    crossings of a vertical ray from the point, then counts as inside if the
    total is odd, negative, or nonzero, respectively.
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `SignedDistanceToSurfaceOutputs`).
    """
    signed_distance_to_surface_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(SIGNED_DISTANCE_TO_SURFACE_METADATA)
    params = execution.params(params)
    cargs = signed_distance_to_surface_cargs(params, execution)
    ret = signed_distance_to_surface_outputs(params, execution)
    execution.run(cargs)
    return ret


def signed_distance_to_surface(
    surface_comp: InputPathType,
    surface_ref: InputPathType,
    metric: str,
    method: str | None = None,
    runner: Runner | None = None,
) -> SignedDistanceToSurfaceOutputs:
    """
    COMPUTE SIGNED DISTANCE FROM ONE SURFACE TO ANOTHER.
    
    Compute the signed distance function of the reference surface at every
    vertex on the comparison surface. NOTE: this relation is NOT symmetric, the
    line from a vertex to the closest point on the 'ref' surface (the one that
    defines the signed distance function) will only align with the normal of the
    'ref' surface. Valid specifiers for winding methods are as follows:
    
    EVEN_ODD (default)
    NEGATIVE
    NONZERO
    NORMALS
    
    The NORMALS method uses the normals of triangles and edges, or the closest
    triangle hit by a ray from the point. This method may be slightly faster,
    but is only reliable for a closed surface that does not cross through
    itself. All other methods count entry (positive) and exit (negative)
    crossings of a vertical ray from the point, then counts as inside if the
    total is odd, negative, or nonzero, respectively.
    
    Args:
        surface_comp: the comparison surface to measure the signed distance on.
        surface_ref: the reference surface that defines the signed distance\
            function.
        metric: the output metric.
        method: winding method for point inside surface test\
            \
            name of the method (default EVEN_ODD).
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `SignedDistanceToSurfaceOutputs`).
    """
    params = signed_distance_to_surface_params(
        surface_comp=surface_comp,
        surface_ref=surface_ref,
        metric=metric,
        method=method,
    )
    return signed_distance_to_surface_execute(params, runner)


__all__ = [
    "SIGNED_DISTANCE_TO_SURFACE_METADATA",
    "SignedDistanceToSurfaceOutputs",
    "SignedDistanceToSurfaceParamsDict",
    "SignedDistanceToSurfaceParamsDictTagged",
    "signed_distance_to_surface",
    "signed_distance_to_surface_execute",
    "signed_distance_to_surface_params",
]
