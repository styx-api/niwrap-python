# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

CIFTI_GRADIENT_METADATA = Metadata(
    id="d2460b1cd46e52f13e61657937e6834a86e13b49.workbench",
    name="cifti-gradient",
    package="workbench",
)


CiftiGradientLeftSurfaceParameters = typing.TypedDict('CiftiGradientLeftSurfaceParameters', {
    "@type": typing.NotRequired[typing.Literal["left-surface"]],
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})
CiftiGradientLeftSurfaceParametersTagged = typing.TypedDict('CiftiGradientLeftSurfaceParametersTagged', {
    "@type": typing.Literal["left-surface"],
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})


CiftiGradientRightSurfaceParameters = typing.TypedDict('CiftiGradientRightSurfaceParameters', {
    "@type": typing.NotRequired[typing.Literal["right-surface"]],
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})
CiftiGradientRightSurfaceParametersTagged = typing.TypedDict('CiftiGradientRightSurfaceParametersTagged', {
    "@type": typing.Literal["right-surface"],
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})


CiftiGradientCerebellumSurfaceParameters = typing.TypedDict('CiftiGradientCerebellumSurfaceParameters', {
    "@type": typing.NotRequired[typing.Literal["cerebellum-surface"]],
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})
CiftiGradientCerebellumSurfaceParametersTagged = typing.TypedDict('CiftiGradientCerebellumSurfaceParametersTagged', {
    "@type": typing.Literal["cerebellum-surface"],
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})


CiftiGradientSurfaceParameters = typing.TypedDict('CiftiGradientSurfaceParameters', {
    "@type": typing.NotRequired[typing.Literal["surface"]],
    "structure": str,
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})
CiftiGradientSurfaceParametersTagged = typing.TypedDict('CiftiGradientSurfaceParametersTagged', {
    "@type": typing.Literal["surface"],
    "structure": str,
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})


CiftiGradientParameters = typing.TypedDict('CiftiGradientParameters', {
    "@type": typing.NotRequired[typing.Literal["workbench/cifti-gradient"]],
    "cifti-out": str,
    "left-surface": typing.NotRequired[CiftiGradientLeftSurfaceParameters | None],
    "right-surface": typing.NotRequired[CiftiGradientRightSurfaceParameters | None],
    "cerebellum-surface": typing.NotRequired[CiftiGradientCerebellumSurfaceParameters | None],
    "surface-kernel": typing.NotRequired[float | None],
    "volume-kernel": typing.NotRequired[float | None],
    "presmooth-fwhm": bool,
    "average-output": bool,
    "vectors-out": typing.NotRequired[str | None],
    "surface": typing.NotRequired[list[CiftiGradientSurfaceParameters] | None],
    "cifti": InputPathType,
    "direction": str,
})
CiftiGradientParametersTagged = typing.TypedDict('CiftiGradientParametersTagged', {
    "@type": typing.Literal["workbench/cifti-gradient"],
    "cifti-out": str,
    "left-surface": typing.NotRequired[CiftiGradientLeftSurfaceParameters | None],
    "right-surface": typing.NotRequired[CiftiGradientRightSurfaceParameters | None],
    "cerebellum-surface": typing.NotRequired[CiftiGradientCerebellumSurfaceParameters | None],
    "surface-kernel": typing.NotRequired[float | None],
    "volume-kernel": typing.NotRequired[float | None],
    "presmooth-fwhm": bool,
    "average-output": bool,
    "vectors-out": typing.NotRequired[str | None],
    "surface": typing.NotRequired[list[CiftiGradientSurfaceParameters] | None],
    "cifti": InputPathType,
    "direction": str,
})


def cifti_gradient_left_surface_params(
    surface: InputPathType,
    area_metric: InputPathType | None,
) -> CiftiGradientLeftSurfaceParametersTagged:
    """
    Build parameters.
    
    Args:
        surface: the left surface file.
        area_metric: vertex areas to use instead of computing them from the\
            left surface\
            \
            the corrected vertex areas, as a metric.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "left-surface",
        "surface": surface,
    }
    if area_metric is not None:
        params["area-metric"] = area_metric
    return params


def cifti_gradient_left_surface_cargs(
    params: CiftiGradientLeftSurfaceParameters,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    if params.get("area-metric", None) is not None:
        cargs.extend([
            "-left-surface",
            execution.input_file(params.get("surface", None)),
            "-left-corrected-areas",
            execution.input_file(params.get("area-metric", None))
        ])
    return cargs


def cifti_gradient_right_surface_params(
    surface: InputPathType,
    area_metric: InputPathType | None,
) -> CiftiGradientRightSurfaceParametersTagged:
    """
    Build parameters.
    
    Args:
        surface: the right surface file.
        area_metric: vertex areas to use instead of computing them from the\
            right surface\
            \
            the corrected vertex areas, as a metric.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "right-surface",
        "surface": surface,
    }
    if area_metric is not None:
        params["area-metric"] = area_metric
    return params


def cifti_gradient_right_surface_cargs(
    params: CiftiGradientRightSurfaceParameters,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    if params.get("area-metric", None) is not None:
        cargs.extend([
            "-right-surface",
            execution.input_file(params.get("surface", None)),
            "-right-corrected-areas",
            execution.input_file(params.get("area-metric", None))
        ])
    return cargs


def cifti_gradient_cerebellum_surface_params(
    surface: InputPathType,
    area_metric: InputPathType | None,
) -> CiftiGradientCerebellumSurfaceParametersTagged:
    """
    Build parameters.
    
    Args:
        surface: the cerebellum surface file.
        area_metric: vertex areas to use instead of computing them from the\
            cerebellum surface\
            \
            the corrected vertex areas, as a metric.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "cerebellum-surface",
        "surface": surface,
    }
    if area_metric is not None:
        params["area-metric"] = area_metric
    return params


def cifti_gradient_cerebellum_surface_cargs(
    params: CiftiGradientCerebellumSurfaceParameters,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    if params.get("area-metric", None) is not None:
        cargs.extend([
            "-cerebellum-surface",
            execution.input_file(params.get("surface", None)),
            "-cerebellum-corrected-areas",
            execution.input_file(params.get("area-metric", None))
        ])
    return cargs


def cifti_gradient_surface_params(
    structure: str,
    surface: InputPathType,
    area_metric: InputPathType | None,
) -> CiftiGradientSurfaceParametersTagged:
    """
    Build parameters.
    
    Args:
        structure: the surface structure name.
        surface: the surface file.
        area_metric: vertex areas to use instead of computing them from the\
            surface\
            \
            the corrected vertex areas, as a metric.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "surface",
        "structure": structure,
        "surface": surface,
    }
    if area_metric is not None:
        params["area-metric"] = area_metric
    return params


def cifti_gradient_surface_cargs(
    params: CiftiGradientSurfaceParameters,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    if params.get("area-metric", None) is not None:
        cargs.extend([
            "-surface",
            params.get("structure", None),
            execution.input_file(params.get("surface", None)),
            "-corrected-areas",
            execution.input_file(params.get("area-metric", None))
        ])
    return cargs


class CiftiGradientOutputs(typing.NamedTuple):
    """
    Output object returned when calling `CiftiGradientParameters(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    cifti_out: OutputPathType
    """the output cifti"""


def cifti_gradient_params(
    cifti_out: str,
    surface_kernel: float | None,
    volume_kernel: float | None,
    vectors_out: str | None,
    cifti: InputPathType,
    direction: str,
    left_surface: CiftiGradientLeftSurfaceParameters | None = None,
    right_surface: CiftiGradientRightSurfaceParameters | None = None,
    cerebellum_surface: CiftiGradientCerebellumSurfaceParameters | None = None,
    presmooth_fwhm: bool = False,
    average_output: bool = False,
    surface: list[CiftiGradientSurfaceParameters] | None = None,
) -> CiftiGradientParametersTagged:
    """
    Build parameters.
    
    Args:
        cifti_out: the output cifti.
        surface_kernel: smooth on the surface before computing the gradient\
            \
            the size of the gaussian surface smoothing kernel in mm, as sigma\
            by default.
        volume_kernel: smooth on the surface before computing the gradient\
            \
            the size of the gaussian volume smoothing kernel in mm, as sigma by\
            default.
        vectors_out: output gradient vectors\
            \
            the vectors, as a dscalar file.
        cifti: the input cifti.
        direction: which dimension to take the gradient along, ROW or COLUMN.
        left_surface: specify the left surface to use.
        right_surface: specify the right surface to use.
        cerebellum_surface: specify the cerebellum surface to use.
        presmooth_fwhm: smoothing kernel sizes are FWHM, not sigma.
        average_output: output the average of the gradient magnitude maps\
            instead of each gradient map separately.
        surface: specify a surface by structure name.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "workbench/cifti-gradient",
        "cifti-out": cifti_out,
        "presmooth-fwhm": presmooth_fwhm,
        "average-output": average_output,
        "cifti": cifti,
        "direction": direction,
    }
    if left_surface is not None:
        params["left-surface"] = left_surface
    if right_surface is not None:
        params["right-surface"] = right_surface
    if cerebellum_surface is not None:
        params["cerebellum-surface"] = cerebellum_surface
    if surface_kernel is not None:
        params["surface-kernel"] = surface_kernel
    if volume_kernel is not None:
        params["volume-kernel"] = volume_kernel
    if vectors_out is not None:
        params["vectors-out"] = vectors_out
    if surface is not None:
        params["surface"] = surface
    return params


def cifti_gradient_cargs(
    params: CiftiGradientParameters,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    if params.get("left-surface", None) is not None or params.get("right-surface", None) is not None or params.get("cerebellum-surface", None) is not None or params.get("surface-kernel", None) is not None or params.get("volume-kernel", None) is not None or params.get("presmooth-fwhm", False) or params.get("average-output", False) or params.get("vectors-out", None) is not None or params.get("surface", None) is not None:
        cargs.extend([
            "wb_command",
            "-cifti-gradient",
            params.get("cifti-out", None),
            *(cifti_gradient_left_surface_cargs(params.get("left-surface", None), execution) if (params.get("left-surface", None) is not None) else []),
            *(cifti_gradient_right_surface_cargs(params.get("right-surface", None), execution) if (params.get("right-surface", None) is not None) else []),
            *(cifti_gradient_cerebellum_surface_cargs(params.get("cerebellum-surface", None), execution) if (params.get("cerebellum-surface", None) is not None) else []),
            "-surface-presmooth",
            (str(params.get("surface-kernel", None)) if (params.get("surface-kernel", None) is not None) else ""),
            "-volume-presmooth",
            (str(params.get("volume-kernel", None)) if (params.get("volume-kernel", None) is not None) else ""),
            ("-presmooth-fwhm" if (params.get("presmooth-fwhm", False)) else ""),
            ("-average-output" if (params.get("average-output", False)) else ""),
            "-vectors",
            (params.get("vectors-out", None) if (params.get("vectors-out", None) is not None) else ""),
            *([a for c in [cifti_gradient_surface_cargs(s, execution) for s in params.get("surface", None)] for a in c] if (params.get("surface", None) is not None) else [])
        ])
    cargs.append(execution.input_file(params.get("cifti", None)))
    cargs.append(params.get("direction", None))
    return cargs


def cifti_gradient_outputs(
    params: CiftiGradientParameters,
    execution: Execution,
) -> CiftiGradientOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = CiftiGradientOutputs(
        root=execution.output_file("."),
        cifti_out=execution.output_file(params.get("cifti-out", None)),
    )
    return ret


def cifti_gradient_execute(
    params: CiftiGradientParameters,
    runner: Runner | None = None,
) -> CiftiGradientOutputs:
    """
    TAKE GRADIENT OF A CIFTI FILE.
    
    Performs gradient calculation on each component of the cifti file, and
    optionally averages the resulting gradients. The -vectors and
    -average-output options may not be used together. You must specify a surface
    for each surface structure in the cifti file. The COLUMN direction should be
    faster, and is the direction that works on dtseries. For dconn, you probably
    want ROW, unless you are using -average-output.
    
    The <structure> argument to -surface must be one of the following strings:
    
    CORTEX_LEFT
    CORTEX_RIGHT
    CEREBELLUM
    ACCUMBENS_LEFT
    ACCUMBENS_RIGHT
    ALL_GREY_MATTER
    ALL_WHITE_MATTER
    AMYGDALA_LEFT
    AMYGDALA_RIGHT
    BRAIN_STEM
    CAUDATE_LEFT
    CAUDATE_RIGHT
    CEREBELLAR_WHITE_MATTER_LEFT
    CEREBELLAR_WHITE_MATTER_RIGHT
    CEREBELLUM_LEFT
    CEREBELLUM_RIGHT
    CEREBRAL_WHITE_MATTER_LEFT
    CEREBRAL_WHITE_MATTER_RIGHT
    CORTEX
    DIENCEPHALON_VENTRAL_LEFT
    DIENCEPHALON_VENTRAL_RIGHT
    HIPPOCAMPUS_LEFT
    HIPPOCAMPUS_RIGHT
    HIPPOCAMPUS_DENTATE_LEFT
    HIPPOCAMPUS_DENTATE_RIGHT
    INVALID
    OTHER
    OTHER_GREY_MATTER
    OTHER_WHITE_MATTER
    PALLIDUM_LEFT
    PALLIDUM_RIGHT
    PUTAMEN_LEFT
    PUTAMEN_RIGHT
    THALAMUS_LEFT
    THALAMUS_RIGHT.
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `CiftiGradientOutputs`).
    """
    runner = runner or get_global_runner()
    execution = runner.start_execution(CIFTI_GRADIENT_METADATA)
    params = execution.params(params)
    cargs = cifti_gradient_cargs(params, execution)
    ret = cifti_gradient_outputs(params, execution)
    execution.run(cargs)
    return ret


def cifti_gradient(
    cifti_out: str,
    surface_kernel: float | None,
    volume_kernel: float | None,
    vectors_out: str | None,
    cifti: InputPathType,
    direction: str,
    left_surface: CiftiGradientLeftSurfaceParameters | None = None,
    right_surface: CiftiGradientRightSurfaceParameters | None = None,
    cerebellum_surface: CiftiGradientCerebellumSurfaceParameters | None = None,
    presmooth_fwhm: bool = False,
    average_output: bool = False,
    surface: list[CiftiGradientSurfaceParameters] | None = None,
    runner: Runner | None = None,
) -> CiftiGradientOutputs:
    """
    TAKE GRADIENT OF A CIFTI FILE.
    
    Performs gradient calculation on each component of the cifti file, and
    optionally averages the resulting gradients. The -vectors and
    -average-output options may not be used together. You must specify a surface
    for each surface structure in the cifti file. The COLUMN direction should be
    faster, and is the direction that works on dtseries. For dconn, you probably
    want ROW, unless you are using -average-output.
    
    The <structure> argument to -surface must be one of the following strings:
    
    CORTEX_LEFT
    CORTEX_RIGHT
    CEREBELLUM
    ACCUMBENS_LEFT
    ACCUMBENS_RIGHT
    ALL_GREY_MATTER
    ALL_WHITE_MATTER
    AMYGDALA_LEFT
    AMYGDALA_RIGHT
    BRAIN_STEM
    CAUDATE_LEFT
    CAUDATE_RIGHT
    CEREBELLAR_WHITE_MATTER_LEFT
    CEREBELLAR_WHITE_MATTER_RIGHT
    CEREBELLUM_LEFT
    CEREBELLUM_RIGHT
    CEREBRAL_WHITE_MATTER_LEFT
    CEREBRAL_WHITE_MATTER_RIGHT
    CORTEX
    DIENCEPHALON_VENTRAL_LEFT
    DIENCEPHALON_VENTRAL_RIGHT
    HIPPOCAMPUS_LEFT
    HIPPOCAMPUS_RIGHT
    HIPPOCAMPUS_DENTATE_LEFT
    HIPPOCAMPUS_DENTATE_RIGHT
    INVALID
    OTHER
    OTHER_GREY_MATTER
    OTHER_WHITE_MATTER
    PALLIDUM_LEFT
    PALLIDUM_RIGHT
    PUTAMEN_LEFT
    PUTAMEN_RIGHT
    THALAMUS_LEFT
    THALAMUS_RIGHT.
    
    Args:
        cifti_out: the output cifti.
        surface_kernel: smooth on the surface before computing the gradient\
            \
            the size of the gaussian surface smoothing kernel in mm, as sigma\
            by default.
        volume_kernel: smooth on the surface before computing the gradient\
            \
            the size of the gaussian volume smoothing kernel in mm, as sigma by\
            default.
        vectors_out: output gradient vectors\
            \
            the vectors, as a dscalar file.
        cifti: the input cifti.
        direction: which dimension to take the gradient along, ROW or COLUMN.
        left_surface: specify the left surface to use.
        right_surface: specify the right surface to use.
        cerebellum_surface: specify the cerebellum surface to use.
        presmooth_fwhm: smoothing kernel sizes are FWHM, not sigma.
        average_output: output the average of the gradient magnitude maps\
            instead of each gradient map separately.
        surface: specify a surface by structure name.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `CiftiGradientOutputs`).
    """
    params = cifti_gradient_params(
        cifti_out=cifti_out,
        left_surface=left_surface,
        right_surface=right_surface,
        cerebellum_surface=cerebellum_surface,
        surface_kernel=surface_kernel,
        volume_kernel=volume_kernel,
        presmooth_fwhm=presmooth_fwhm,
        average_output=average_output,
        vectors_out=vectors_out,
        surface=surface,
        cifti=cifti,
        direction=direction,
    )
    return cifti_gradient_execute(params, runner)


__all__ = [
    "CIFTI_GRADIENT_METADATA",
    "CiftiGradientOutputs",
    "cifti_gradient",
    "cifti_gradient_cerebellum_surface_params",
    "cifti_gradient_execute",
    "cifti_gradient_left_surface_params",
    "cifti_gradient_params",
    "cifti_gradient_right_surface_params",
    "cifti_gradient_surface_params",
]
