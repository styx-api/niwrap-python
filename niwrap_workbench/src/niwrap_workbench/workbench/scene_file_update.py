# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

SCENE_FILE_UPDATE_METADATA = Metadata(
    id="74fc5b736152760ce25b6a49aed11ec82a2d48ab.workbench",
    name="scene-file-update",
    package="workbench",
    container_image_tag="nx10x/workbench:2.1.0",
)


_SceneFileUpdateCopyMapOnePaletteParamsDictNoTag = typing.TypedDict('_SceneFileUpdateCopyMapOnePaletteParamsDictNoTag', {
    "Data File Name Suffix": str,
})
SceneFileUpdateCopyMapOnePaletteParamsDictTagged = typing.TypedDict('SceneFileUpdateCopyMapOnePaletteParamsDictTagged', {
    "@type": typing.Literal["copy-map-one-palette"],
    "Data File Name Suffix": str,
})
SceneFileUpdateCopyMapOnePaletteParamsDict = _SceneFileUpdateCopyMapOnePaletteParamsDictNoTag | SceneFileUpdateCopyMapOnePaletteParamsDictTagged


_SceneFileUpdateDataFileAddParamsDictNoTag = typing.TypedDict('_SceneFileUpdateDataFileAddParamsDictNoTag', {
    "Name of data file": str,
})
SceneFileUpdateDataFileAddParamsDictTagged = typing.TypedDict('SceneFileUpdateDataFileAddParamsDictTagged', {
    "@type": typing.Literal["data-file-add"],
    "Name of data file": str,
})
SceneFileUpdateDataFileAddParamsDict = _SceneFileUpdateDataFileAddParamsDictNoTag | SceneFileUpdateDataFileAddParamsDictTagged


_SceneFileUpdateDataFileRemoveParamsDictNoTag = typing.TypedDict('_SceneFileUpdateDataFileRemoveParamsDictNoTag', {
    "Name of data file": str,
})
SceneFileUpdateDataFileRemoveParamsDictTagged = typing.TypedDict('SceneFileUpdateDataFileRemoveParamsDictTagged', {
    "@type": typing.Literal["data-file-remove"],
    "Name of data file": str,
})
SceneFileUpdateDataFileRemoveParamsDict = _SceneFileUpdateDataFileRemoveParamsDictNoTag | SceneFileUpdateDataFileRemoveParamsDictTagged


_SceneFileUpdateParamsDictNoTag = typing.TypedDict('_SceneFileUpdateParamsDictNoTag', {
    "input-scene-file": str,
    "output-scene-file": str,
    "scene-name-or-number": str,
    "copy-map-one-palette": typing.NotRequired[list[SceneFileUpdateCopyMapOnePaletteParamsDict] | None],
    "data-file-add": typing.NotRequired[list[SceneFileUpdateDataFileAddParamsDict] | None],
    "data-file-remove": typing.NotRequired[list[SceneFileUpdateDataFileRemoveParamsDict] | None],
    "verbose": bool,
    "error": bool,
    "remove-missing-files": bool,
    "fix-map-palette-settings": bool,
})
SceneFileUpdateParamsDictTagged = typing.TypedDict('SceneFileUpdateParamsDictTagged', {
    "@type": typing.Literal["workbench/scene-file-update"],
    "input-scene-file": str,
    "output-scene-file": str,
    "scene-name-or-number": str,
    "copy-map-one-palette": typing.NotRequired[list[SceneFileUpdateCopyMapOnePaletteParamsDict] | None],
    "data-file-add": typing.NotRequired[list[SceneFileUpdateDataFileAddParamsDict] | None],
    "data-file-remove": typing.NotRequired[list[SceneFileUpdateDataFileRemoveParamsDict] | None],
    "verbose": bool,
    "error": bool,
    "remove-missing-files": bool,
    "fix-map-palette-settings": bool,
})
SceneFileUpdateParamsDict = _SceneFileUpdateParamsDictNoTag | SceneFileUpdateParamsDictTagged


def scene_file_update_copy_map_one_palette(
    data_file_name_suffix: str,
) -> SceneFileUpdateCopyMapOnePaletteParamsDictTagged:
    """
    Build parameters.
    
    Args:
        data_file_name_suffix: Name of palette mapped data file (cifti, metric,\
            volume).
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "copy-map-one-palette",
        "Data File Name Suffix": data_file_name_suffix,
    }
    return params


def scene_file_update_copy_map_one_palette_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `SceneFileUpdateCopyMapOnePaletteParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("Data File Name Suffix", None) is None:
        raise StyxValidationError("`Data File Name Suffix` must not be None")
    if not isinstance(params["Data File Name Suffix"], str):
        raise StyxValidationError(f'`Data File Name Suffix` has the wrong type: Received `{type(params.get("Data File Name Suffix", None))}` expected `str`')


def scene_file_update_copy_map_one_palette_cargs(
    params: SceneFileUpdateCopyMapOnePaletteParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "-copy-map-one-palette",
        params.get("Data File Name Suffix", None)
    ])
    return cargs


def scene_file_update_data_file_add(
    name_of_data_file: str,
) -> SceneFileUpdateDataFileAddParamsDictTagged:
    """
    Build parameters.
    
    Args:
        name_of_data_file: Name of data file. If a data file not in the current\
            directory, it is best to use an absolute path (a relative path may\
            work). Instead of a data file, this value may be the name of a text\
            file (must end in ".txt") that contains the names of one or more data\
            files, one per line.\
            Example on UNIX to create a text file containing all CIFTI scalar\
            files in the current directory with absolute paths:\
            ls -d $PWD/*dscalar.nii > file.txt.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "data-file-add",
        "Name of data file": name_of_data_file,
    }
    return params


def scene_file_update_data_file_add_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `SceneFileUpdateDataFileAddParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("Name of data file", None) is None:
        raise StyxValidationError("`Name of data file` must not be None")
    if not isinstance(params["Name of data file"], str):
        raise StyxValidationError(f'`Name of data file` has the wrong type: Received `{type(params.get("Name of data file", None))}` expected `str`')


def scene_file_update_data_file_add_cargs(
    params: SceneFileUpdateDataFileAddParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "-data-file-add",
        params.get("Name of data file", None)
    ])
    return cargs


def scene_file_update_data_file_remove(
    name_of_data_file: str,
) -> SceneFileUpdateDataFileRemoveParamsDictTagged:
    """
    Build parameters.
    
    Args:
        name_of_data_file: Name of data file. If a data file not in the current\
            directory, it is best to use an absolute path (a relative path may\
            work). Instead of a data file, this value may be the name of a text\
            file (must end in ".txt") that contains the names of one or more data\
            files, one per line.\
            Example on UNIX to create a text file containing all CIFTI scalar\
            files in the current directory with absolute paths:\
            ls -d $PWD/*dscalar.nii > file.txt.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "data-file-remove",
        "Name of data file": name_of_data_file,
    }
    return params


def scene_file_update_data_file_remove_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `SceneFileUpdateDataFileRemoveParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("Name of data file", None) is None:
        raise StyxValidationError("`Name of data file` must not be None")
    if not isinstance(params["Name of data file"], str):
        raise StyxValidationError(f'`Name of data file` has the wrong type: Received `{type(params.get("Name of data file", None))}` expected `str`')


def scene_file_update_data_file_remove_cargs(
    params: SceneFileUpdateDataFileRemoveParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "-data-file-remove",
        params.get("Name of data file", None)
    ])
    return cargs


class SceneFileUpdateOutputs(typing.NamedTuple):
    """
    Output object returned when calling `SceneFileUpdateParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""


def scene_file_update_params(
    input_scene_file: str,
    output_scene_file: str,
    scene_name_or_number: str,
    copy_map_one_palette: list[SceneFileUpdateCopyMapOnePaletteParamsDict] | None = None,
    data_file_add: list[SceneFileUpdateDataFileAddParamsDict] | None = None,
    data_file_remove: list[SceneFileUpdateDataFileRemoveParamsDict] | None = None,
    verbose: bool = False,
    error: bool = False,
    remove_missing_files: bool = False,
    fix_map_palette_settings: bool = False,
) -> SceneFileUpdateParamsDictTagged:
    """
    Build parameters.
    
    Args:
        input_scene_file: the input scene file.
        output_scene_file: the new scene file to create.
        scene_name_or_number: name or number (starting at one) of the scene in\
            the scene file.
        copy_map_one_palette: Copy palettes settings from first map to all maps\
            in a data file.
        data_file_add: Add a data file to scene's loaded files.
        data_file_remove: Remove a data file from scene's loaded files.
        verbose: Print names of files that have palettes updated.
        error: Abort command if there is an error performing any of the\
            operations on the scene file.
        remove_missing_files: Remove missing files from SpecFile.
        fix_map_palette_settings: Fix palette settings for files with change in\
            number of maps.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "workbench/scene-file-update",
        "input-scene-file": input_scene_file,
        "output-scene-file": output_scene_file,
        "scene-name-or-number": scene_name_or_number,
        "verbose": verbose,
        "error": error,
        "remove-missing-files": remove_missing_files,
        "fix-map-palette-settings": fix_map_palette_settings,
    }
    if copy_map_one_palette is not None:
        params["copy-map-one-palette"] = copy_map_one_palette
    if data_file_add is not None:
        params["data-file-add"] = data_file_add
    if data_file_remove is not None:
        params["data-file-remove"] = data_file_remove
    return params


def scene_file_update_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `SceneFileUpdateParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("input-scene-file", None) is None:
        raise StyxValidationError("`input-scene-file` must not be None")
    if not isinstance(params["input-scene-file"], str):
        raise StyxValidationError(f'`input-scene-file` has the wrong type: Received `{type(params.get("input-scene-file", None))}` expected `str`')
    if params.get("output-scene-file", None) is None:
        raise StyxValidationError("`output-scene-file` must not be None")
    if not isinstance(params["output-scene-file"], str):
        raise StyxValidationError(f'`output-scene-file` has the wrong type: Received `{type(params.get("output-scene-file", None))}` expected `str`')
    if params.get("scene-name-or-number", None) is None:
        raise StyxValidationError("`scene-name-or-number` must not be None")
    if not isinstance(params["scene-name-or-number"], str):
        raise StyxValidationError(f'`scene-name-or-number` has the wrong type: Received `{type(params.get("scene-name-or-number", None))}` expected `str`')
    if params.get("copy-map-one-palette", None) is not None:
        if not isinstance(params["copy-map-one-palette"], list):
            raise StyxValidationError(f'`copy-map-one-palette` has the wrong type: Received `{type(params.get("copy-map-one-palette", None))}` expected `list[SceneFileUpdateCopyMapOnePaletteParamsDict] | None`')
        for e in params["copy-map-one-palette"]:
            scene_file_update_copy_map_one_palette_validate(e)
    if params.get("data-file-add", None) is not None:
        if not isinstance(params["data-file-add"], list):
            raise StyxValidationError(f'`data-file-add` has the wrong type: Received `{type(params.get("data-file-add", None))}` expected `list[SceneFileUpdateDataFileAddParamsDict] | None`')
        for e in params["data-file-add"]:
            scene_file_update_data_file_add_validate(e)
    if params.get("data-file-remove", None) is not None:
        if not isinstance(params["data-file-remove"], list):
            raise StyxValidationError(f'`data-file-remove` has the wrong type: Received `{type(params.get("data-file-remove", None))}` expected `list[SceneFileUpdateDataFileRemoveParamsDict] | None`')
        for e in params["data-file-remove"]:
            scene_file_update_data_file_remove_validate(e)
    if params.get("verbose", False) is None:
        raise StyxValidationError("`verbose` must not be None")
    if not isinstance(params["verbose"], bool):
        raise StyxValidationError(f'`verbose` has the wrong type: Received `{type(params.get("verbose", False))}` expected `bool`')
    if params.get("error", False) is None:
        raise StyxValidationError("`error` must not be None")
    if not isinstance(params["error"], bool):
        raise StyxValidationError(f'`error` has the wrong type: Received `{type(params.get("error", False))}` expected `bool`')
    if params.get("remove-missing-files", False) is None:
        raise StyxValidationError("`remove-missing-files` must not be None")
    if not isinstance(params["remove-missing-files"], bool):
        raise StyxValidationError(f'`remove-missing-files` has the wrong type: Received `{type(params.get("remove-missing-files", False))}` expected `bool`')
    if params.get("fix-map-palette-settings", False) is None:
        raise StyxValidationError("`fix-map-palette-settings` must not be None")
    if not isinstance(params["fix-map-palette-settings"], bool):
        raise StyxValidationError(f'`fix-map-palette-settings` has the wrong type: Received `{type(params.get("fix-map-palette-settings", False))}` expected `bool`')


def scene_file_update_cargs(
    params: SceneFileUpdateParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "wb_command",
        "-scene-file-update"
    ])
    cargs.append(params.get("input-scene-file", None))
    cargs.append(params.get("output-scene-file", None))
    cargs.append(params.get("scene-name-or-number", None))
    if params.get("copy-map-one-palette", None) is not None or params.get("data-file-add", None) is not None or params.get("data-file-remove", None) is not None:
        cargs.extend([
            *([a for c in [scene_file_update_copy_map_one_palette_cargs(s, execution) for s in params.get("copy-map-one-palette", None)] for a in c] if (params.get("copy-map-one-palette", None) is not None) else []),
            *([a for c in [scene_file_update_data_file_add_cargs(s, execution) for s in params.get("data-file-add", None)] for a in c] if (params.get("data-file-add", None) is not None) else []),
            *([a for c in [scene_file_update_data_file_remove_cargs(s, execution) for s in params.get("data-file-remove", None)] for a in c] if (params.get("data-file-remove", None) is not None) else [])
        ])
    if params.get("verbose", False):
        cargs.append("-verbose")
    if params.get("error", False):
        cargs.append("-error")
    if params.get("remove-missing-files", False):
        cargs.append("-remove-missing-files")
    if params.get("fix-map-palette-settings", False):
        cargs.append("-fix-map-palette-settings")
    return cargs


def scene_file_update_outputs(
    params: SceneFileUpdateParamsDict,
    execution: Execution,
) -> SceneFileUpdateOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = SceneFileUpdateOutputs(
        root=execution.output_file("."),
    )
    return ret


def scene_file_update_execute(
    params: SceneFileUpdateParamsDict,
    runner: Runner | None = None,
) -> SceneFileUpdateOutputs:
    """
    UPDATE SCENE FILE.
    
    This command will update a scene for specific changes in data files.
    
    "-fix-map-palette-settings" will find all data files that have had a change
    in the number of maps since the scene scene was created. If the file has its
    "Apply to All Maps" property enabled, the palette setting in the first map
    is copied to all maps in the file. Note: This modifies the palette settings
    for the file in the scene (data file is NOT modified).
    
    "-copy-map-one-palette" will copy the palette settings from the first map to
    all other maps in a data file. This option is typically used when the number
    of maps in a data file changes. It changes the palette settings in the scene
    that are applied to the data file when the scene is loaded (the data file is
    not modified). The name of the data file specified on the command line is
    matched to the end of file names in the scene. This allows matching multiple
    files if their names end with the same characters. It also allows including
    a relative path when there is more than one file with the same name but in
    different paths and only one of the files to be updated.
    
    "-remove-missing-files" Any files that fail to load when the scene is read
    will be removed from the scene. Thus, if one deletes files prior to running
    with this option, the deleted files are removed from the scene.
    
    "-error" If this option is provided and there is an error while performing
    any of the scene operations, the command will immediately cease processing
    and the output scene file will not be created. Otherwise any errors will be
    listed after the command finishes.
    .
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `SceneFileUpdateOutputs`).
    """
    scene_file_update_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(SCENE_FILE_UPDATE_METADATA)
    params = execution.params(params)
    cargs = scene_file_update_cargs(params, execution)
    ret = scene_file_update_outputs(params, execution)
    execution.run(cargs)
    return ret


def scene_file_update(
    input_scene_file: str,
    output_scene_file: str,
    scene_name_or_number: str,
    copy_map_one_palette: list[SceneFileUpdateCopyMapOnePaletteParamsDict] | None = None,
    data_file_add: list[SceneFileUpdateDataFileAddParamsDict] | None = None,
    data_file_remove: list[SceneFileUpdateDataFileRemoveParamsDict] | None = None,
    verbose: bool = False,
    error: bool = False,
    remove_missing_files: bool = False,
    fix_map_palette_settings: bool = False,
    runner: Runner | None = None,
) -> SceneFileUpdateOutputs:
    """
    UPDATE SCENE FILE.
    
    This command will update a scene for specific changes in data files.
    
    "-fix-map-palette-settings" will find all data files that have had a change
    in the number of maps since the scene scene was created. If the file has its
    "Apply to All Maps" property enabled, the palette setting in the first map
    is copied to all maps in the file. Note: This modifies the palette settings
    for the file in the scene (data file is NOT modified).
    
    "-copy-map-one-palette" will copy the palette settings from the first map to
    all other maps in a data file. This option is typically used when the number
    of maps in a data file changes. It changes the palette settings in the scene
    that are applied to the data file when the scene is loaded (the data file is
    not modified). The name of the data file specified on the command line is
    matched to the end of file names in the scene. This allows matching multiple
    files if their names end with the same characters. It also allows including
    a relative path when there is more than one file with the same name but in
    different paths and only one of the files to be updated.
    
    "-remove-missing-files" Any files that fail to load when the scene is read
    will be removed from the scene. Thus, if one deletes files prior to running
    with this option, the deleted files are removed from the scene.
    
    "-error" If this option is provided and there is an error while performing
    any of the scene operations, the command will immediately cease processing
    and the output scene file will not be created. Otherwise any errors will be
    listed after the command finishes.
    .
    
    Args:
        input_scene_file: the input scene file.
        output_scene_file: the new scene file to create.
        scene_name_or_number: name or number (starting at one) of the scene in\
            the scene file.
        copy_map_one_palette: Copy palettes settings from first map to all maps\
            in a data file.
        data_file_add: Add a data file to scene's loaded files.
        data_file_remove: Remove a data file from scene's loaded files.
        verbose: Print names of files that have palettes updated.
        error: Abort command if there is an error performing any of the\
            operations on the scene file.
        remove_missing_files: Remove missing files from SpecFile.
        fix_map_palette_settings: Fix palette settings for files with change in\
            number of maps.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `SceneFileUpdateOutputs`).
    """
    params = scene_file_update_params(
        input_scene_file=input_scene_file,
        output_scene_file=output_scene_file,
        scene_name_or_number=scene_name_or_number,
        copy_map_one_palette=copy_map_one_palette,
        data_file_add=data_file_add,
        data_file_remove=data_file_remove,
        verbose=verbose,
        error=error,
        remove_missing_files=remove_missing_files,
        fix_map_palette_settings=fix_map_palette_settings,
    )
    return scene_file_update_execute(params, runner)


__all__ = [
    "SCENE_FILE_UPDATE_METADATA",
    "SceneFileUpdateCopyMapOnePaletteParamsDict",
    "SceneFileUpdateCopyMapOnePaletteParamsDictTagged",
    "SceneFileUpdateDataFileAddParamsDict",
    "SceneFileUpdateDataFileAddParamsDictTagged",
    "SceneFileUpdateDataFileRemoveParamsDict",
    "SceneFileUpdateDataFileRemoveParamsDictTagged",
    "SceneFileUpdateOutputs",
    "SceneFileUpdateParamsDict",
    "SceneFileUpdateParamsDictTagged",
    "scene_file_update",
    "scene_file_update_copy_map_one_palette",
    "scene_file_update_data_file_add",
    "scene_file_update_data_file_remove",
    "scene_file_update_execute",
    "scene_file_update_params",
]
