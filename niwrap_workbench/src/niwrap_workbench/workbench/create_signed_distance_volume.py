# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

CREATE_SIGNED_DISTANCE_VOLUME_METADATA = Metadata(
    id="4d61fcbc40072b03f96c88c490ff99bbafba1379.workbench",
    name="create-signed-distance-volume",
    package="workbench",
)


_CreateSignedDistanceVolumeParamsDictNoTag = typing.TypedDict('_CreateSignedDistanceVolumeParamsDictNoTag', {
    "outvol": str,
    "roi-vol": typing.NotRequired[str | None],
    "value": typing.NotRequired[float | None],
    "dist": typing.NotRequired[float | None],
    "dist": typing.NotRequired[float | None],
    "num": typing.NotRequired[int | None],
    "method": typing.NotRequired[str | None],
    "surface": InputPathType,
    "refspace": str,
})
CreateSignedDistanceVolumeParamsDictTagged = typing.TypedDict('CreateSignedDistanceVolumeParamsDictTagged', {
    "@type": typing.Literal["workbench/create-signed-distance-volume"],
    "outvol": str,
    "roi-vol": typing.NotRequired[str | None],
    "value": typing.NotRequired[float | None],
    "dist": typing.NotRequired[float | None],
    "dist": typing.NotRequired[float | None],
    "num": typing.NotRequired[int | None],
    "method": typing.NotRequired[str | None],
    "surface": InputPathType,
    "refspace": str,
})
CreateSignedDistanceVolumeParamsDict = _CreateSignedDistanceVolumeParamsDictNoTag | CreateSignedDistanceVolumeParamsDictTagged


class CreateSignedDistanceVolumeOutputs(typing.NamedTuple):
    """
    Output object returned when calling `CreateSignedDistanceVolumeParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    outvol: OutputPathType
    """the output volume"""


def create_signed_distance_volume_params(
    outvol: str,
    surface: InputPathType,
    refspace: str,
    roi_vol: str | None = None,
    value: float | None = None,
    dist: float | None = None,
    dist_: float | None = None,
    num: int | None = None,
    method: str | None = None,
) -> CreateSignedDistanceVolumeParamsDictTagged:
    """
    Build parameters.
    
    Args:
        outvol: the output volume.
        surface: the input surface.
        refspace: a volume in the desired output space (dims, spacing, origin).
        roi_vol: output an roi volume of where the output has a computed value\
            \
            the output roi volume.
        value: specify a value to put in all voxels that don't get assigned a\
            distance\
            \
            value to fill with (default 0).
        dist: specify distance for exact output\
            \
            distance in mm (default 5).
        dist_: specify distance for approximate output\
            \
            distance in mm (default 20).
        num: voxel neighborhood for approximate calculation\
            \
            size of neighborhood cube measured from center to face, in voxels\
            (default 2 = 5x5x5).
        method: winding method for point inside surface test\
            \
            name of the method (default EVEN_ODD).
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "workbench/create-signed-distance-volume",
        "outvol": outvol,
        "surface": surface,
        "refspace": refspace,
    }
    if roi_vol is not None:
        params["roi-vol"] = roi_vol
    if value is not None:
        params["value"] = value
    if dist is not None:
        params["dist"] = dist
    if dist_ is not None:
        params["dist"] = dist_
    if num is not None:
        params["num"] = num
    if method is not None:
        params["method"] = method
    return params


def create_signed_distance_volume_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `CreateSignedDistanceVolumeParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("outvol", None) is None:
        raise StyxValidationError("`outvol` must not be None")
    if not isinstance(params["outvol"], str):
        raise StyxValidationError(f'`outvol` has the wrong type: Received `{type(params.get("outvol", None))}` expected `str`')
    if params.get("roi-vol", None) is not None:
        if not isinstance(params["roi-vol"], str):
            raise StyxValidationError(f'`roi-vol` has the wrong type: Received `{type(params.get("roi-vol", None))}` expected `str | None`')
    if params.get("value", None) is not None:
        if not isinstance(params["value"], (float, int)):
            raise StyxValidationError(f'`value` has the wrong type: Received `{type(params.get("value", None))}` expected `float | None`')
    if params.get("dist", None) is not None:
        if not isinstance(params["dist"], (float, int)):
            raise StyxValidationError(f'`dist` has the wrong type: Received `{type(params.get("dist", None))}` expected `float | None`')
    if params.get("dist", None) is not None:
        if not isinstance(params["dist"], (float, int)):
            raise StyxValidationError(f'`dist` has the wrong type: Received `{type(params.get("dist", None))}` expected `float | None`')
    if params.get("num", None) is not None:
        if not isinstance(params["num"], int):
            raise StyxValidationError(f'`num` has the wrong type: Received `{type(params.get("num", None))}` expected `int | None`')
    if params.get("method", None) is not None:
        if not isinstance(params["method"], str):
            raise StyxValidationError(f'`method` has the wrong type: Received `{type(params.get("method", None))}` expected `str | None`')
    if params.get("surface", None) is None:
        raise StyxValidationError("`surface` must not be None")
    if not isinstance(params["surface"], (pathlib.Path, str)):
        raise StyxValidationError(f'`surface` has the wrong type: Received `{type(params.get("surface", None))}` expected `InputPathType`')
    if params.get("refspace", None) is None:
        raise StyxValidationError("`refspace` must not be None")
    if not isinstance(params["refspace"], str):
        raise StyxValidationError(f'`refspace` has the wrong type: Received `{type(params.get("refspace", None))}` expected `str`')


def create_signed_distance_volume_cargs(
    params: CreateSignedDistanceVolumeParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    if params.get("roi-vol", None) is not None or params.get("value", None) is not None or params.get("dist", None) is not None or params.get("dist", None) is not None or params.get("num", None) is not None or params.get("method", None) is not None:
        cargs.extend([
            "wb_command",
            "-create-signed-distance-volume",
            params.get("outvol", None),
            "-roi-out",
            (params.get("roi-vol", None) if (params.get("roi-vol", None) is not None) else ""),
            "-fill-value",
            (str(params.get("value", None)) if (params.get("value", None) is not None) else ""),
            "-exact-limit",
            (str(params.get("dist", None)) if (params.get("dist", None) is not None) else ""),
            "-approx-limit",
            (str(params.get("dist", None)) if (params.get("dist", None) is not None) else ""),
            "-approx-neighborhood",
            (str(params.get("num", None)) if (params.get("num", None) is not None) else ""),
            "-winding",
            (params.get("method", None) if (params.get("method", None) is not None) else "")
        ])
    cargs.append(execution.input_file(params.get("surface", None)))
    cargs.append(params.get("refspace", None))
    return cargs


def create_signed_distance_volume_outputs(
    params: CreateSignedDistanceVolumeParamsDict,
    execution: Execution,
) -> CreateSignedDistanceVolumeOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = CreateSignedDistanceVolumeOutputs(
        root=execution.output_file("."),
        outvol=execution.output_file(params.get("outvol", None)),
    )
    return ret


def create_signed_distance_volume_execute(
    params: CreateSignedDistanceVolumeParamsDict,
    runner: Runner | None = None,
) -> CreateSignedDistanceVolumeOutputs:
    """
    CREATE SIGNED DISTANCE VOLUME FROM SURFACE.
    
    Computes the signed distance function of the surface. Exact distance is
    calculated by finding the closest point on any surface triangle to the
    center of the voxel. Approximate distance is calculated starting with these
    distances, using dijkstra's method with a neighborhood of voxels. Specifying
    too small of an exact distance may produce unexpected results. Valid
    specifiers for winding methods are as follows:
    
    EVEN_ODD (default)
    NEGATIVE
    NONZERO
    NORMALS
    
    The NORMALS method uses the normals of triangles and edges, or the closest
    triangle hit by a ray from the point. This method may be slightly faster,
    but is only reliable for a closed surface that does not cross through
    itself. All other methods count entry (positive) and exit (negative)
    crossings of a vertical ray from the point, then counts as inside if the
    total is odd, negative, or nonzero, respectively.
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `CreateSignedDistanceVolumeOutputs`).
    """
    create_signed_distance_volume_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(CREATE_SIGNED_DISTANCE_VOLUME_METADATA)
    params = execution.params(params)
    cargs = create_signed_distance_volume_cargs(params, execution)
    ret = create_signed_distance_volume_outputs(params, execution)
    execution.run(cargs)
    return ret


def create_signed_distance_volume(
    outvol: str,
    surface: InputPathType,
    refspace: str,
    roi_vol: str | None = None,
    value: float | None = None,
    dist: float | None = None,
    dist_: float | None = None,
    num: int | None = None,
    method: str | None = None,
    runner: Runner | None = None,
) -> CreateSignedDistanceVolumeOutputs:
    """
    CREATE SIGNED DISTANCE VOLUME FROM SURFACE.
    
    Computes the signed distance function of the surface. Exact distance is
    calculated by finding the closest point on any surface triangle to the
    center of the voxel. Approximate distance is calculated starting with these
    distances, using dijkstra's method with a neighborhood of voxels. Specifying
    too small of an exact distance may produce unexpected results. Valid
    specifiers for winding methods are as follows:
    
    EVEN_ODD (default)
    NEGATIVE
    NONZERO
    NORMALS
    
    The NORMALS method uses the normals of triangles and edges, or the closest
    triangle hit by a ray from the point. This method may be slightly faster,
    but is only reliable for a closed surface that does not cross through
    itself. All other methods count entry (positive) and exit (negative)
    crossings of a vertical ray from the point, then counts as inside if the
    total is odd, negative, or nonzero, respectively.
    
    Args:
        outvol: the output volume.
        surface: the input surface.
        refspace: a volume in the desired output space (dims, spacing, origin).
        roi_vol: output an roi volume of where the output has a computed value\
            \
            the output roi volume.
        value: specify a value to put in all voxels that don't get assigned a\
            distance\
            \
            value to fill with (default 0).
        dist: specify distance for exact output\
            \
            distance in mm (default 5).
        dist_: specify distance for approximate output\
            \
            distance in mm (default 20).
        num: voxel neighborhood for approximate calculation\
            \
            size of neighborhood cube measured from center to face, in voxels\
            (default 2 = 5x5x5).
        method: winding method for point inside surface test\
            \
            name of the method (default EVEN_ODD).
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `CreateSignedDistanceVolumeOutputs`).
    """
    params = create_signed_distance_volume_params(
        outvol=outvol,
        roi_vol=roi_vol,
        value=value,
        dist=dist,
        dist_=dist_,
        num=num,
        method=method,
        surface=surface,
        refspace=refspace,
    )
    return create_signed_distance_volume_execute(params, runner)


__all__ = [
    "CREATE_SIGNED_DISTANCE_VOLUME_METADATA",
    "CreateSignedDistanceVolumeOutputs",
    "CreateSignedDistanceVolumeParamsDict",
    "CreateSignedDistanceVolumeParamsDictTagged",
    "create_signed_distance_volume",
    "create_signed_distance_volume_execute",
    "create_signed_distance_volume_params",
]
