# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

CIFTI_FIND_CLUSTERS_METADATA = Metadata(
    id="72f5480b9af6a98bf8c924c75b2fd0dcccbf6c11.workbench",
    name="cifti-find-clusters",
    package="workbench",
    container_image_tag="nx10x/workbench:2.1.0",
)


_CiftiFindClustersLeftSurfaceParamsDictNoTag = typing.TypedDict('_CiftiFindClustersLeftSurfaceParamsDictNoTag', {
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})
CiftiFindClustersLeftSurfaceParamsDictTagged = typing.TypedDict('CiftiFindClustersLeftSurfaceParamsDictTagged', {
    "@type": typing.Literal["left-surface"],
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})
CiftiFindClustersLeftSurfaceParamsDict = _CiftiFindClustersLeftSurfaceParamsDictNoTag | CiftiFindClustersLeftSurfaceParamsDictTagged


_CiftiFindClustersRightSurfaceParamsDictNoTag = typing.TypedDict('_CiftiFindClustersRightSurfaceParamsDictNoTag', {
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})
CiftiFindClustersRightSurfaceParamsDictTagged = typing.TypedDict('CiftiFindClustersRightSurfaceParamsDictTagged', {
    "@type": typing.Literal["right-surface"],
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})
CiftiFindClustersRightSurfaceParamsDict = _CiftiFindClustersRightSurfaceParamsDictNoTag | CiftiFindClustersRightSurfaceParamsDictTagged


_CiftiFindClustersCerebellumSurfaceParamsDictNoTag = typing.TypedDict('_CiftiFindClustersCerebellumSurfaceParamsDictNoTag', {
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})
CiftiFindClustersCerebellumSurfaceParamsDictTagged = typing.TypedDict('CiftiFindClustersCerebellumSurfaceParamsDictTagged', {
    "@type": typing.Literal["cerebellum-surface"],
    "surface": InputPathType,
    "area-metric": typing.NotRequired[InputPathType | None],
})
CiftiFindClustersCerebellumSurfaceParamsDict = _CiftiFindClustersCerebellumSurfaceParamsDictNoTag | CiftiFindClustersCerebellumSurfaceParamsDictTagged


_CiftiFindClustersSizeRatioParamsDictNoTag = typing.TypedDict('_CiftiFindClustersSizeRatioParamsDictNoTag', {
    "surface-ratio": float,
    "volume-ratio": float,
})
CiftiFindClustersSizeRatioParamsDictTagged = typing.TypedDict('CiftiFindClustersSizeRatioParamsDictTagged', {
    "@type": typing.Literal["size-ratio"],
    "surface-ratio": float,
    "volume-ratio": float,
})
CiftiFindClustersSizeRatioParamsDict = _CiftiFindClustersSizeRatioParamsDictNoTag | CiftiFindClustersSizeRatioParamsDictTagged


_CiftiFindClustersDistanceParamsDictNoTag = typing.TypedDict('_CiftiFindClustersDistanceParamsDictNoTag', {
    "surface-distance": float,
    "volume-distance": float,
})
CiftiFindClustersDistanceParamsDictTagged = typing.TypedDict('CiftiFindClustersDistanceParamsDictTagged', {
    "@type": typing.Literal["distance"],
    "surface-distance": float,
    "volume-distance": float,
})
CiftiFindClustersDistanceParamsDict = _CiftiFindClustersDistanceParamsDictNoTag | CiftiFindClustersDistanceParamsDictTagged


_CiftiFindClustersParamsDictNoTag = typing.TypedDict('_CiftiFindClustersParamsDictNoTag', {
    "cifti": InputPathType,
    "surface-value-threshold": float,
    "surface-minimum-area": float,
    "volume-value-threshold": float,
    "volume-minimum-size": float,
    "direction": str,
    "cifti-out": str,
    "left-surface": typing.NotRequired[CiftiFindClustersLeftSurfaceParamsDict | None],
    "right-surface": typing.NotRequired[CiftiFindClustersRightSurfaceParamsDict | None],
    "cerebellum-surface": typing.NotRequired[CiftiFindClustersCerebellumSurfaceParamsDict | None],
    "size-ratio": typing.NotRequired[CiftiFindClustersSizeRatioParamsDict | None],
    "distance": typing.NotRequired[CiftiFindClustersDistanceParamsDict | None],
    "startval": typing.NotRequired[int | None],
    "roi-cifti": typing.NotRequired[InputPathType | None],
    "merged-volume": bool,
    "less-than": bool,
})
CiftiFindClustersParamsDictTagged = typing.TypedDict('CiftiFindClustersParamsDictTagged', {
    "@type": typing.Literal["workbench/cifti-find-clusters"],
    "cifti": InputPathType,
    "surface-value-threshold": float,
    "surface-minimum-area": float,
    "volume-value-threshold": float,
    "volume-minimum-size": float,
    "direction": str,
    "cifti-out": str,
    "left-surface": typing.NotRequired[CiftiFindClustersLeftSurfaceParamsDict | None],
    "right-surface": typing.NotRequired[CiftiFindClustersRightSurfaceParamsDict | None],
    "cerebellum-surface": typing.NotRequired[CiftiFindClustersCerebellumSurfaceParamsDict | None],
    "size-ratio": typing.NotRequired[CiftiFindClustersSizeRatioParamsDict | None],
    "distance": typing.NotRequired[CiftiFindClustersDistanceParamsDict | None],
    "startval": typing.NotRequired[int | None],
    "roi-cifti": typing.NotRequired[InputPathType | None],
    "merged-volume": bool,
    "less-than": bool,
})
CiftiFindClustersParamsDict = _CiftiFindClustersParamsDictNoTag | CiftiFindClustersParamsDictTagged


def cifti_find_clusters_left_surface(
    surface: InputPathType,
    area_metric: InputPathType | None = None,
) -> CiftiFindClustersLeftSurfaceParamsDictTagged:
    """
    Build parameters.
    
    Args:
        surface: the left surface file.
        area_metric: vertex areas to use instead of computing them from the\
            surface\
            \
            the corrected vertex areas, as a metric.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "left-surface",
        "surface": surface,
    }
    if area_metric is not None:
        params["area-metric"] = area_metric
    return params


def cifti_find_clusters_left_surface_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `CiftiFindClustersLeftSurfaceParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("surface", None) is None:
        raise StyxValidationError("`surface` must not be None")
    if not isinstance(params["surface"], (pathlib.Path, str)):
        raise StyxValidationError(f'`surface` has the wrong type: Received `{type(params.get("surface", None))}` expected `InputPathType`')
    if params.get("area-metric", None) is not None:
        if not isinstance(params["area-metric"], (pathlib.Path, str)):
            raise StyxValidationError(f'`area-metric` has the wrong type: Received `{type(params.get("area-metric", None))}` expected `InputPathType | None`')


def cifti_find_clusters_left_surface_cargs(
    params: CiftiFindClustersLeftSurfaceParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "-left-surface",
        execution.input_file(params.get("surface", None))
    ])
    if params.get("area-metric", None) is not None:
        cargs.extend([
            "-corrected-areas",
            execution.input_file(params.get("area-metric", None))
        ])
    return cargs


def cifti_find_clusters_right_surface(
    surface: InputPathType,
    area_metric: InputPathType | None = None,
) -> CiftiFindClustersRightSurfaceParamsDictTagged:
    """
    Build parameters.
    
    Args:
        surface: the right surface file.
        area_metric: vertex areas to use instead of computing them from the\
            surface\
            \
            the corrected vertex areas, as a metric.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "right-surface",
        "surface": surface,
    }
    if area_metric is not None:
        params["area-metric"] = area_metric
    return params


def cifti_find_clusters_right_surface_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `CiftiFindClustersRightSurfaceParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("surface", None) is None:
        raise StyxValidationError("`surface` must not be None")
    if not isinstance(params["surface"], (pathlib.Path, str)):
        raise StyxValidationError(f'`surface` has the wrong type: Received `{type(params.get("surface", None))}` expected `InputPathType`')
    if params.get("area-metric", None) is not None:
        if not isinstance(params["area-metric"], (pathlib.Path, str)):
            raise StyxValidationError(f'`area-metric` has the wrong type: Received `{type(params.get("area-metric", None))}` expected `InputPathType | None`')


def cifti_find_clusters_right_surface_cargs(
    params: CiftiFindClustersRightSurfaceParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "-right-surface",
        execution.input_file(params.get("surface", None))
    ])
    if params.get("area-metric", None) is not None:
        cargs.extend([
            "-corrected-areas",
            execution.input_file(params.get("area-metric", None))
        ])
    return cargs


def cifti_find_clusters_cerebellum_surface(
    surface: InputPathType,
    area_metric: InputPathType | None = None,
) -> CiftiFindClustersCerebellumSurfaceParamsDictTagged:
    """
    Build parameters.
    
    Args:
        surface: the cerebellum surface file.
        area_metric: vertex areas to use instead of computing them from the\
            surface\
            \
            the corrected vertex areas, as a metric.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "cerebellum-surface",
        "surface": surface,
    }
    if area_metric is not None:
        params["area-metric"] = area_metric
    return params


def cifti_find_clusters_cerebellum_surface_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `CiftiFindClustersCerebellumSurfaceParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("surface", None) is None:
        raise StyxValidationError("`surface` must not be None")
    if not isinstance(params["surface"], (pathlib.Path, str)):
        raise StyxValidationError(f'`surface` has the wrong type: Received `{type(params.get("surface", None))}` expected `InputPathType`')
    if params.get("area-metric", None) is not None:
        if not isinstance(params["area-metric"], (pathlib.Path, str)):
            raise StyxValidationError(f'`area-metric` has the wrong type: Received `{type(params.get("area-metric", None))}` expected `InputPathType | None`')


def cifti_find_clusters_cerebellum_surface_cargs(
    params: CiftiFindClustersCerebellumSurfaceParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "-cerebellum-surface",
        execution.input_file(params.get("surface", None))
    ])
    if params.get("area-metric", None) is not None:
        cargs.extend([
            "-corrected-areas",
            execution.input_file(params.get("area-metric", None))
        ])
    return cargs


def cifti_find_clusters_size_ratio(
    surface_ratio: float,
    volume_ratio: float,
) -> CiftiFindClustersSizeRatioParamsDictTagged:
    """
    Build parameters.
    
    Args:
        surface_ratio: fraction of the structure's largest cluster area.
        volume_ratio: fraction of the structure's largest cluster volume.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "size-ratio",
        "surface-ratio": surface_ratio,
        "volume-ratio": volume_ratio,
    }
    return params


def cifti_find_clusters_size_ratio_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `CiftiFindClustersSizeRatioParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("surface-ratio", None) is None:
        raise StyxValidationError("`surface-ratio` must not be None")
    if not isinstance(params["surface-ratio"], (float, int)):
        raise StyxValidationError(f'`surface-ratio` has the wrong type: Received `{type(params.get("surface-ratio", None))}` expected `float`')
    if params.get("volume-ratio", None) is None:
        raise StyxValidationError("`volume-ratio` must not be None")
    if not isinstance(params["volume-ratio"], (float, int)):
        raise StyxValidationError(f'`volume-ratio` has the wrong type: Received `{type(params.get("volume-ratio", None))}` expected `float`')


def cifti_find_clusters_size_ratio_cargs(
    params: CiftiFindClustersSizeRatioParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "-size-ratio",
        str(params.get("surface-ratio", None)),
        str(params.get("volume-ratio", None))
    ])
    return cargs


def cifti_find_clusters_distance(
    surface_distance: float,
    volume_distance: float,
) -> CiftiFindClustersDistanceParamsDictTagged:
    """
    Build parameters.
    
    Args:
        surface_distance: how far from the largest cluster a cluster can be,\
            edge to edge, in mm.
        volume_distance: how far from the largest cluster a cluster can be,\
            edge to edge, in mm.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "distance",
        "surface-distance": surface_distance,
        "volume-distance": volume_distance,
    }
    return params


def cifti_find_clusters_distance_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `CiftiFindClustersDistanceParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("surface-distance", None) is None:
        raise StyxValidationError("`surface-distance` must not be None")
    if not isinstance(params["surface-distance"], (float, int)):
        raise StyxValidationError(f'`surface-distance` has the wrong type: Received `{type(params.get("surface-distance", None))}` expected `float`')
    if params.get("volume-distance", None) is None:
        raise StyxValidationError("`volume-distance` must not be None")
    if not isinstance(params["volume-distance"], (float, int)):
        raise StyxValidationError(f'`volume-distance` has the wrong type: Received `{type(params.get("volume-distance", None))}` expected `float`')


def cifti_find_clusters_distance_cargs(
    params: CiftiFindClustersDistanceParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "-distance",
        str(params.get("surface-distance", None)),
        str(params.get("volume-distance", None))
    ])
    return cargs


class CiftiFindClustersOutputs(typing.NamedTuple):
    """
    Output object returned when calling `CiftiFindClustersParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    cifti_out: OutputPathType
    """the output cifti"""


def cifti_find_clusters_params(
    cifti: InputPathType,
    surface_value_threshold: float,
    surface_minimum_area: float,
    volume_value_threshold: float,
    volume_minimum_size: float,
    direction: str,
    cifti_out: str,
    left_surface: CiftiFindClustersLeftSurfaceParamsDict | None = None,
    right_surface: CiftiFindClustersRightSurfaceParamsDict | None = None,
    cerebellum_surface: CiftiFindClustersCerebellumSurfaceParamsDict | None = None,
    size_ratio: CiftiFindClustersSizeRatioParamsDict | None = None,
    distance: CiftiFindClustersDistanceParamsDict | None = None,
    startval: int | None = None,
    roi_cifti: InputPathType | None = None,
    merged_volume: bool = False,
    less_than: bool = False,
) -> CiftiFindClustersParamsDictTagged:
    """
    Build parameters.
    
    Args:
        cifti: the input cifti.
        surface_value_threshold: threshold for surface data values.
        surface_minimum_area: threshold for surface cluster area, in mm^2.
        volume_value_threshold: threshold for volume data values.
        volume_minimum_size: threshold for volume cluster size, in mm^3.
        direction: which dimension to use for spatial information, ROW or\
            COLUMN.
        cifti_out: the output cifti.
        left_surface: specify the left surface to use.
        right_surface: specify the right surface to use.
        cerebellum_surface: specify the cerebellum surface to use.
        size_ratio: ignore clusters smaller than a given fraction of the\
            largest cluster in the structure.
        distance: ignore clusters further than a given distance from the\
            largest cluster in the structure.
        startval: start labeling clusters from a value other than 1\
            \
            the value to give the first cluster found.
        roi_cifti: search only within regions of interest\
            \
            the regions to search within, as a cifti file.
        merged_volume: treat volume components as if they were a single\
            component.
        less_than: find values less than <value-threshold>, rather than greater.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "workbench/cifti-find-clusters",
        "cifti": cifti,
        "surface-value-threshold": surface_value_threshold,
        "surface-minimum-area": surface_minimum_area,
        "volume-value-threshold": volume_value_threshold,
        "volume-minimum-size": volume_minimum_size,
        "direction": direction,
        "cifti-out": cifti_out,
        "merged-volume": merged_volume,
        "less-than": less_than,
    }
    if left_surface is not None:
        params["left-surface"] = left_surface
    if right_surface is not None:
        params["right-surface"] = right_surface
    if cerebellum_surface is not None:
        params["cerebellum-surface"] = cerebellum_surface
    if size_ratio is not None:
        params["size-ratio"] = size_ratio
    if distance is not None:
        params["distance"] = distance
    if startval is not None:
        params["startval"] = startval
    if roi_cifti is not None:
        params["roi-cifti"] = roi_cifti
    return params


def cifti_find_clusters_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `CiftiFindClustersParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("cifti", None) is None:
        raise StyxValidationError("`cifti` must not be None")
    if not isinstance(params["cifti"], (pathlib.Path, str)):
        raise StyxValidationError(f'`cifti` has the wrong type: Received `{type(params.get("cifti", None))}` expected `InputPathType`')
    if params.get("surface-value-threshold", None) is None:
        raise StyxValidationError("`surface-value-threshold` must not be None")
    if not isinstance(params["surface-value-threshold"], (float, int)):
        raise StyxValidationError(f'`surface-value-threshold` has the wrong type: Received `{type(params.get("surface-value-threshold", None))}` expected `float`')
    if params.get("surface-minimum-area", None) is None:
        raise StyxValidationError("`surface-minimum-area` must not be None")
    if not isinstance(params["surface-minimum-area"], (float, int)):
        raise StyxValidationError(f'`surface-minimum-area` has the wrong type: Received `{type(params.get("surface-minimum-area", None))}` expected `float`')
    if params.get("volume-value-threshold", None) is None:
        raise StyxValidationError("`volume-value-threshold` must not be None")
    if not isinstance(params["volume-value-threshold"], (float, int)):
        raise StyxValidationError(f'`volume-value-threshold` has the wrong type: Received `{type(params.get("volume-value-threshold", None))}` expected `float`')
    if params.get("volume-minimum-size", None) is None:
        raise StyxValidationError("`volume-minimum-size` must not be None")
    if not isinstance(params["volume-minimum-size"], (float, int)):
        raise StyxValidationError(f'`volume-minimum-size` has the wrong type: Received `{type(params.get("volume-minimum-size", None))}` expected `float`')
    if params.get("direction", None) is None:
        raise StyxValidationError("`direction` must not be None")
    if not isinstance(params["direction"], str):
        raise StyxValidationError(f'`direction` has the wrong type: Received `{type(params.get("direction", None))}` expected `str`')
    if params.get("cifti-out", None) is None:
        raise StyxValidationError("`cifti-out` must not be None")
    if not isinstance(params["cifti-out"], str):
        raise StyxValidationError(f'`cifti-out` has the wrong type: Received `{type(params.get("cifti-out", None))}` expected `str`')
    if params.get("left-surface", None) is not None:
        cifti_find_clusters_left_surface_validate(params["left-surface"])
    if params.get("right-surface", None) is not None:
        cifti_find_clusters_right_surface_validate(params["right-surface"])
    if params.get("cerebellum-surface", None) is not None:
        cifti_find_clusters_cerebellum_surface_validate(params["cerebellum-surface"])
    if params.get("size-ratio", None) is not None:
        cifti_find_clusters_size_ratio_validate(params["size-ratio"])
    if params.get("distance", None) is not None:
        cifti_find_clusters_distance_validate(params["distance"])
    if params.get("startval", None) is not None:
        if not isinstance(params["startval"], int):
            raise StyxValidationError(f'`startval` has the wrong type: Received `{type(params.get("startval", None))}` expected `int | None`')
    if params.get("roi-cifti", None) is not None:
        if not isinstance(params["roi-cifti"], (pathlib.Path, str)):
            raise StyxValidationError(f'`roi-cifti` has the wrong type: Received `{type(params.get("roi-cifti", None))}` expected `InputPathType | None`')
    if params.get("merged-volume", False) is None:
        raise StyxValidationError("`merged-volume` must not be None")
    if not isinstance(params["merged-volume"], bool):
        raise StyxValidationError(f'`merged-volume` has the wrong type: Received `{type(params.get("merged-volume", False))}` expected `bool`')
    if params.get("less-than", False) is None:
        raise StyxValidationError("`less-than` must not be None")
    if not isinstance(params["less-than"], bool):
        raise StyxValidationError(f'`less-than` has the wrong type: Received `{type(params.get("less-than", False))}` expected `bool`')


def cifti_find_clusters_cargs(
    params: CiftiFindClustersParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "wb_command",
        "-cifti-find-clusters"
    ])
    cargs.append(execution.input_file(params.get("cifti", None)))
    cargs.append(str(params.get("surface-value-threshold", None)))
    cargs.append(str(params.get("surface-minimum-area", None)))
    cargs.append(str(params.get("volume-value-threshold", None)))
    cargs.append(str(params.get("volume-minimum-size", None)))
    cargs.append(params.get("direction", None))
    cargs.append(params.get("cifti-out", None))
    if params.get("left-surface", None) is not None or params.get("right-surface", None) is not None or params.get("cerebellum-surface", None) is not None or params.get("size-ratio", None) is not None or params.get("distance", None) is not None:
        cargs.extend([
            *(cifti_find_clusters_left_surface_cargs(params.get("left-surface", None), execution) if (params.get("left-surface", None) is not None) else []),
            *(cifti_find_clusters_right_surface_cargs(params.get("right-surface", None), execution) if (params.get("right-surface", None) is not None) else []),
            *(cifti_find_clusters_cerebellum_surface_cargs(params.get("cerebellum-surface", None), execution) if (params.get("cerebellum-surface", None) is not None) else []),
            *(cifti_find_clusters_size_ratio_cargs(params.get("size-ratio", None), execution) if (params.get("size-ratio", None) is not None) else []),
            *(cifti_find_clusters_distance_cargs(params.get("distance", None), execution) if (params.get("distance", None) is not None) else [])
        ])
    if params.get("startval", None) is not None:
        cargs.extend([
            "-start",
            str(params.get("startval", None))
        ])
    if params.get("roi-cifti", None) is not None:
        cargs.extend([
            "-cifti-roi",
            execution.input_file(params.get("roi-cifti", None))
        ])
    if params.get("merged-volume", False):
        cargs.append("-merged-volume")
    if params.get("less-than", False):
        cargs.append("-less-than")
    return cargs


def cifti_find_clusters_outputs(
    params: CiftiFindClustersParamsDict,
    execution: Execution,
) -> CiftiFindClustersOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = CiftiFindClustersOutputs(
        root=execution.output_file("."),
        cifti_out=execution.output_file(params.get("cifti-out", None)),
    )
    return ret


def cifti_find_clusters_execute(
    params: CiftiFindClustersParamsDict,
    runner: Runner | None = None,
) -> CiftiFindClustersOutputs:
    """
    FILTER CLUSTERS BY AREA/VOLUME.
    
    Outputs a cifti file with nonzero integers for all brainordinates within a
    large enough cluster, and zeros elsewhere. The integers denote cluster
    membership (by default, first cluster found will use value 1, second cluster
    2, etc). Cluster values are not reused across maps of the output, but
    instead keep counting up. The input cifti file must have a brain models
    mapping on the chosen dimension, columns for .dtseries, and either for
    .dconn. The ROI should have a brain models mapping along columns, exactly
    matching the mapping of the chosen direction in the input file. Data outside
    the ROI is ignored.
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `CiftiFindClustersOutputs`).
    """
    cifti_find_clusters_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(CIFTI_FIND_CLUSTERS_METADATA)
    params = execution.params(params)
    cargs = cifti_find_clusters_cargs(params, execution)
    ret = cifti_find_clusters_outputs(params, execution)
    execution.run(cargs)
    return ret


def cifti_find_clusters(
    cifti: InputPathType,
    surface_value_threshold: float,
    surface_minimum_area: float,
    volume_value_threshold: float,
    volume_minimum_size: float,
    direction: str,
    cifti_out: str,
    left_surface: CiftiFindClustersLeftSurfaceParamsDict | None = None,
    right_surface: CiftiFindClustersRightSurfaceParamsDict | None = None,
    cerebellum_surface: CiftiFindClustersCerebellumSurfaceParamsDict | None = None,
    size_ratio: CiftiFindClustersSizeRatioParamsDict | None = None,
    distance: CiftiFindClustersDistanceParamsDict | None = None,
    startval: int | None = None,
    roi_cifti: InputPathType | None = None,
    merged_volume: bool = False,
    less_than: bool = False,
    runner: Runner | None = None,
) -> CiftiFindClustersOutputs:
    """
    FILTER CLUSTERS BY AREA/VOLUME.
    
    Outputs a cifti file with nonzero integers for all brainordinates within a
    large enough cluster, and zeros elsewhere. The integers denote cluster
    membership (by default, first cluster found will use value 1, second cluster
    2, etc). Cluster values are not reused across maps of the output, but
    instead keep counting up. The input cifti file must have a brain models
    mapping on the chosen dimension, columns for .dtseries, and either for
    .dconn. The ROI should have a brain models mapping along columns, exactly
    matching the mapping of the chosen direction in the input file. Data outside
    the ROI is ignored.
    
    Args:
        cifti: the input cifti.
        surface_value_threshold: threshold for surface data values.
        surface_minimum_area: threshold for surface cluster area, in mm^2.
        volume_value_threshold: threshold for volume data values.
        volume_minimum_size: threshold for volume cluster size, in mm^3.
        direction: which dimension to use for spatial information, ROW or\
            COLUMN.
        cifti_out: the output cifti.
        left_surface: specify the left surface to use.
        right_surface: specify the right surface to use.
        cerebellum_surface: specify the cerebellum surface to use.
        size_ratio: ignore clusters smaller than a given fraction of the\
            largest cluster in the structure.
        distance: ignore clusters further than a given distance from the\
            largest cluster in the structure.
        startval: start labeling clusters from a value other than 1\
            \
            the value to give the first cluster found.
        roi_cifti: search only within regions of interest\
            \
            the regions to search within, as a cifti file.
        merged_volume: treat volume components as if they were a single\
            component.
        less_than: find values less than <value-threshold>, rather than greater.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `CiftiFindClustersOutputs`).
    """
    params = cifti_find_clusters_params(
        cifti=cifti,
        surface_value_threshold=surface_value_threshold,
        surface_minimum_area=surface_minimum_area,
        volume_value_threshold=volume_value_threshold,
        volume_minimum_size=volume_minimum_size,
        direction=direction,
        cifti_out=cifti_out,
        left_surface=left_surface,
        right_surface=right_surface,
        cerebellum_surface=cerebellum_surface,
        size_ratio=size_ratio,
        distance=distance,
        startval=startval,
        roi_cifti=roi_cifti,
        merged_volume=merged_volume,
        less_than=less_than,
    )
    return cifti_find_clusters_execute(params, runner)


__all__ = [
    "CIFTI_FIND_CLUSTERS_METADATA",
    "CiftiFindClustersCerebellumSurfaceParamsDict",
    "CiftiFindClustersCerebellumSurfaceParamsDictTagged",
    "CiftiFindClustersDistanceParamsDict",
    "CiftiFindClustersDistanceParamsDictTagged",
    "CiftiFindClustersLeftSurfaceParamsDict",
    "CiftiFindClustersLeftSurfaceParamsDictTagged",
    "CiftiFindClustersOutputs",
    "CiftiFindClustersParamsDict",
    "CiftiFindClustersParamsDictTagged",
    "CiftiFindClustersRightSurfaceParamsDict",
    "CiftiFindClustersRightSurfaceParamsDictTagged",
    "CiftiFindClustersSizeRatioParamsDict",
    "CiftiFindClustersSizeRatioParamsDictTagged",
    "cifti_find_clusters",
    "cifti_find_clusters_cerebellum_surface",
    "cifti_find_clusters_distance",
    "cifti_find_clusters_execute",
    "cifti_find_clusters_left_surface",
    "cifti_find_clusters_params",
    "cifti_find_clusters_right_surface",
    "cifti_find_clusters_size_ratio",
]
