# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

CIFTI_LABEL_MODIFY_KEYS_METADATA = Metadata(
    id="c1b64c2a3ef6542f7a8f34965d349c950dd4cb74.workbench",
    name="cifti-label-modify-keys",
    package="workbench",
    container_image_tag="nx10x/workbench:2.1.0",
)


_CiftiLabelModifyKeysParamsDictNoTag = typing.TypedDict('_CiftiLabelModifyKeysParamsDictNoTag', {
    "cifti-in": InputPathType,
    "remap-file": str,
    "cifti-out": str,
    "column": typing.NotRequired[str | None],
})
CiftiLabelModifyKeysParamsDictTagged = typing.TypedDict('CiftiLabelModifyKeysParamsDictTagged', {
    "@type": typing.Literal["workbench/cifti-label-modify-keys"],
    "cifti-in": InputPathType,
    "remap-file": str,
    "cifti-out": str,
    "column": typing.NotRequired[str | None],
})
CiftiLabelModifyKeysParamsDict = _CiftiLabelModifyKeysParamsDictNoTag | CiftiLabelModifyKeysParamsDictTagged


class CiftiLabelModifyKeysOutputs(typing.NamedTuple):
    """
    Output object returned when calling `CiftiLabelModifyKeysParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    cifti_out: OutputPathType
    """the output dlabel file"""


def cifti_label_modify_keys_params(
    cifti_in: InputPathType,
    remap_file: str,
    cifti_out: str,
    column: str | None = None,
) -> CiftiLabelModifyKeysParamsDictTagged:
    """
    Build parameters.
    
    Args:
        cifti_in: the input dlabel file.
        remap_file: text file with old and new key values.
        cifti_out: the output dlabel file.
        column: select a single column to use\
            \
            the column number or name.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "workbench/cifti-label-modify-keys",
        "cifti-in": cifti_in,
        "remap-file": remap_file,
        "cifti-out": cifti_out,
    }
    if column is not None:
        params["column"] = column
    return params


def cifti_label_modify_keys_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `CiftiLabelModifyKeysParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("cifti-in", None) is None:
        raise StyxValidationError("`cifti-in` must not be None")
    if not isinstance(params["cifti-in"], (pathlib.Path, str)):
        raise StyxValidationError(f'`cifti-in` has the wrong type: Received `{type(params.get("cifti-in", None))}` expected `InputPathType`')
    if params.get("remap-file", None) is None:
        raise StyxValidationError("`remap-file` must not be None")
    if not isinstance(params["remap-file"], str):
        raise StyxValidationError(f'`remap-file` has the wrong type: Received `{type(params.get("remap-file", None))}` expected `str`')
    if params.get("cifti-out", None) is None:
        raise StyxValidationError("`cifti-out` must not be None")
    if not isinstance(params["cifti-out"], str):
        raise StyxValidationError(f'`cifti-out` has the wrong type: Received `{type(params.get("cifti-out", None))}` expected `str`')
    if params.get("column", None) is not None:
        if not isinstance(params["column"], str):
            raise StyxValidationError(f'`column` has the wrong type: Received `{type(params.get("column", None))}` expected `str | None`')


def cifti_label_modify_keys_cargs(
    params: CiftiLabelModifyKeysParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.extend([
        "wb_command",
        "-cifti-label-modify-keys"
    ])
    cargs.append(execution.input_file(params.get("cifti-in", None)))
    cargs.append(params.get("remap-file", None))
    cargs.append(params.get("cifti-out", None))
    if params.get("column", None) is not None:
        cargs.extend([
            "-column",
            params.get("column", None)
        ])
    return cargs


def cifti_label_modify_keys_outputs(
    params: CiftiLabelModifyKeysParamsDict,
    execution: Execution,
) -> CiftiLabelModifyKeysOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = CiftiLabelModifyKeysOutputs(
        root=execution.output_file("."),
        cifti_out=execution.output_file(params.get("cifti-out", None)),
    )
    return ret


def cifti_label_modify_keys_execute(
    params: CiftiLabelModifyKeysParamsDict,
    runner: Runner | None = None,
) -> CiftiLabelModifyKeysOutputs:
    """
    CHANGE KEY VALUES IN A DLABEL FILE.
    
    <remap-file> should have lines of the form 'oldkey newkey', like so:
    
    3 5
    5 8
    8 2
    
    This would change the current label with key '3' to use the key '5' instead,
    5 would use 8, and 8 would use 2. Any collision in key values results in the
    label that was not specified in the remap file getting remapped to an
    otherwise unused key. Remapping more than one key to the same new key, or
    the same key to more than one new key, results in an error. This will not
    change the appearance of the file when displayed, as it will change the key
    values in the data at the same time.
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `CiftiLabelModifyKeysOutputs`).
    """
    cifti_label_modify_keys_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(CIFTI_LABEL_MODIFY_KEYS_METADATA)
    params = execution.params(params)
    cargs = cifti_label_modify_keys_cargs(params, execution)
    ret = cifti_label_modify_keys_outputs(params, execution)
    execution.run(cargs)
    return ret


def cifti_label_modify_keys(
    cifti_in: InputPathType,
    remap_file: str,
    cifti_out: str,
    column: str | None = None,
    runner: Runner | None = None,
) -> CiftiLabelModifyKeysOutputs:
    """
    CHANGE KEY VALUES IN A DLABEL FILE.
    
    <remap-file> should have lines of the form 'oldkey newkey', like so:
    
    3 5
    5 8
    8 2
    
    This would change the current label with key '3' to use the key '5' instead,
    5 would use 8, and 8 would use 2. Any collision in key values results in the
    label that was not specified in the remap file getting remapped to an
    otherwise unused key. Remapping more than one key to the same new key, or
    the same key to more than one new key, results in an error. This will not
    change the appearance of the file when displayed, as it will change the key
    values in the data at the same time.
    
    Args:
        cifti_in: the input dlabel file.
        remap_file: text file with old and new key values.
        cifti_out: the output dlabel file.
        column: select a single column to use\
            \
            the column number or name.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `CiftiLabelModifyKeysOutputs`).
    """
    params = cifti_label_modify_keys_params(
        cifti_in=cifti_in,
        remap_file=remap_file,
        cifti_out=cifti_out,
        column=column,
    )
    return cifti_label_modify_keys_execute(params, runner)


__all__ = [
    "CIFTI_LABEL_MODIFY_KEYS_METADATA",
    "CiftiLabelModifyKeysOutputs",
    "CiftiLabelModifyKeysParamsDict",
    "CiftiLabelModifyKeysParamsDictTagged",
    "cifti_label_modify_keys",
    "cifti_label_modify_keys_execute",
    "cifti_label_modify_keys_params",
]
