# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

MRI_GLMFIT_METADATA = Metadata(
    id="9bb5b7f2411737a2aa71418a6c6225bccd298876.boutiques",
    name="mri_glmfit",
    package="freesurfer",
    container_image_tag="freesurfer/freesurfer:7.4.1",
)


_MriGlmfitParamsDictNoTag = typing.TypedDict('_MriGlmfitParamsDictNoTag', {
    "glmdir": typing.NotRequired[str | None],
    "y_input": InputPathType,
    "table_input": typing.NotRequired[InputPathType | None],
    "fsgd": typing.NotRequired[InputPathType | None],
    "design_matrix": typing.NotRequired[InputPathType | None],
    "contrast_matrix": typing.NotRequired[list[InputPathType] | None],
    "osgm_flag": bool,
    "no_contrasts_ok_flag": bool,
    "dti_params": typing.NotRequired[list[str] | None],
    "dti_matrix": typing.NotRequired[InputPathType | None],
    "pvr": typing.NotRequired[list[InputPathType] | None],
    "selfreg": typing.NotRequired[list[float] | None],
    "wls": typing.NotRequired[str | None],
    "yffxvar": typing.NotRequired[InputPathType | None],
    "ffxdof": typing.NotRequired[float | None],
    "ffxdofdat": typing.NotRequired[InputPathType | None],
    "weight": typing.NotRequired[InputPathType | None],
    "weight_inv_flag": bool,
    "weight_sqrt_flag": bool,
    "fwhm": typing.NotRequired[float | None],
    "var_fwhm": typing.NotRequired[float | None],
    "no_mask_smooth_flag": bool,
    "no_est_fwhm_flag": bool,
    "mask": typing.NotRequired[InputPathType | None],
    "label": typing.NotRequired[InputPathType | None],
    "no_mask_flag": bool,
    "no_cortex_flag": bool,
    "mask_inv_flag": bool,
    "prune_flag": bool,
    "no_prune_flag": bool,
    "logy_flag": bool,
    "no_logy_flag": bool,
    "rm_spatial_mean_flag": bool,
    "yhat_save_flag": bool,
    "eres_save_flag": bool,
    "eres_scm_flag": bool,
    "save_fwhm_map_flag": bool,
    "y_out": typing.NotRequired[InputPathType | None],
    "surface": typing.NotRequired[str | None],
    "skew_flag": bool,
    "kurtosis_flag": bool,
    "sim_params": typing.NotRequired[list[str] | None],
    "sim_sign": typing.NotRequired[str | None],
    "uniform_params": typing.NotRequired[list[str] | None],
    "permute_input_flag": bool,
    "pca_flag": bool,
    "tar1_flag": bool,
    "save_yhat_flag": bool,
    "save_cond_flag": bool,
    "voxdump": typing.NotRequired[list[float] | None],
    "seed": typing.NotRequired[float | None],
    "synth_flag": bool,
    "resynthtest_it": typing.NotRequired[float | None],
    "profile_it": typing.NotRequired[float | None],
    "mrtm1_params": typing.NotRequired[list[str] | None],
    "mrtm2_params": typing.NotRequired[list[str] | None],
    "logan_params": typing.NotRequired[list[str] | None],
    "bp_clip_neg_flag": bool,
    "bp_clip_max": typing.NotRequired[float | None],
    "perm_force_flag": bool,
    "diag_level": typing.NotRequired[float | None],
    "diag_cluster_flag": bool,
    "debug_flag": bool,
    "checkopts_flag": bool,
    "help_flag": bool,
    "version_flag": bool,
    "no_fix_vertex_area_flag": bool,
    "allowsubjrep_flag": bool,
    "allow_zero_dof_flag": bool,
    "illcond_flag": bool,
    "sim_done_file": typing.NotRequired[InputPathType | None],
    "no_sig_double_flag": bool,
})
MriGlmfitParamsDictTagged = typing.TypedDict('MriGlmfitParamsDictTagged', {
    "@type": typing.Literal["freesurfer/mri_glmfit"],
    "glmdir": typing.NotRequired[str | None],
    "y_input": InputPathType,
    "table_input": typing.NotRequired[InputPathType | None],
    "fsgd": typing.NotRequired[InputPathType | None],
    "design_matrix": typing.NotRequired[InputPathType | None],
    "contrast_matrix": typing.NotRequired[list[InputPathType] | None],
    "osgm_flag": bool,
    "no_contrasts_ok_flag": bool,
    "dti_params": typing.NotRequired[list[str] | None],
    "dti_matrix": typing.NotRequired[InputPathType | None],
    "pvr": typing.NotRequired[list[InputPathType] | None],
    "selfreg": typing.NotRequired[list[float] | None],
    "wls": typing.NotRequired[str | None],
    "yffxvar": typing.NotRequired[InputPathType | None],
    "ffxdof": typing.NotRequired[float | None],
    "ffxdofdat": typing.NotRequired[InputPathType | None],
    "weight": typing.NotRequired[InputPathType | None],
    "weight_inv_flag": bool,
    "weight_sqrt_flag": bool,
    "fwhm": typing.NotRequired[float | None],
    "var_fwhm": typing.NotRequired[float | None],
    "no_mask_smooth_flag": bool,
    "no_est_fwhm_flag": bool,
    "mask": typing.NotRequired[InputPathType | None],
    "label": typing.NotRequired[InputPathType | None],
    "no_mask_flag": bool,
    "no_cortex_flag": bool,
    "mask_inv_flag": bool,
    "prune_flag": bool,
    "no_prune_flag": bool,
    "logy_flag": bool,
    "no_logy_flag": bool,
    "rm_spatial_mean_flag": bool,
    "yhat_save_flag": bool,
    "eres_save_flag": bool,
    "eres_scm_flag": bool,
    "save_fwhm_map_flag": bool,
    "y_out": typing.NotRequired[InputPathType | None],
    "surface": typing.NotRequired[str | None],
    "skew_flag": bool,
    "kurtosis_flag": bool,
    "sim_params": typing.NotRequired[list[str] | None],
    "sim_sign": typing.NotRequired[str | None],
    "uniform_params": typing.NotRequired[list[str] | None],
    "permute_input_flag": bool,
    "pca_flag": bool,
    "tar1_flag": bool,
    "save_yhat_flag": bool,
    "save_cond_flag": bool,
    "voxdump": typing.NotRequired[list[float] | None],
    "seed": typing.NotRequired[float | None],
    "synth_flag": bool,
    "resynthtest_it": typing.NotRequired[float | None],
    "profile_it": typing.NotRequired[float | None],
    "mrtm1_params": typing.NotRequired[list[str] | None],
    "mrtm2_params": typing.NotRequired[list[str] | None],
    "logan_params": typing.NotRequired[list[str] | None],
    "bp_clip_neg_flag": bool,
    "bp_clip_max": typing.NotRequired[float | None],
    "perm_force_flag": bool,
    "diag_level": typing.NotRequired[float | None],
    "diag_cluster_flag": bool,
    "debug_flag": bool,
    "checkopts_flag": bool,
    "help_flag": bool,
    "version_flag": bool,
    "no_fix_vertex_area_flag": bool,
    "allowsubjrep_flag": bool,
    "allow_zero_dof_flag": bool,
    "illcond_flag": bool,
    "sim_done_file": typing.NotRequired[InputPathType | None],
    "no_sig_double_flag": bool,
})
MriGlmfitParamsDict = _MriGlmfitParamsDictNoTag | MriGlmfitParamsDictTagged


class MriGlmfitOutputs(typing.NamedTuple):
    """
    Output object returned when calling `MriGlmfitParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    regression_coefs: OutputPathType
    """All regression coefficients (B)."""
    residual_error: OutputPathType
    """Residual error."""
    residual_variance: OutputPathType
    """Residual error variance."""
    residual_stddev: OutputPathType
    """Residual error standard deviation."""
    fsgd_output: OutputPathType
    """FSGD file if one was input."""
    normalized_weights: OutputPathType
    """Normalized weights with --w or --wls."""
    signal_estimate: OutputPathType
    """Signal estimate with --save-yhat."""
    final_mask: OutputPathType
    """Final mask when a mask is used."""
    design_condition: OutputPathType
    """Design matrix condition at each voxel with --save-cond."""
    contrast_output_dir: OutputPathType
    """Directory for each contrast output files."""


def mri_glmfit_params(
    y_input: InputPathType,
    glmdir: str | None = None,
    table_input: InputPathType | None = None,
    fsgd: InputPathType | None = None,
    design_matrix: InputPathType | None = None,
    contrast_matrix: list[InputPathType] | None = None,
    osgm_flag: bool = False,
    no_contrasts_ok_flag: bool = False,
    dti_params: list[str] | None = None,
    dti_matrix: InputPathType | None = None,
    pvr: list[InputPathType] | None = None,
    selfreg: list[float] | None = None,
    wls: str | None = None,
    yffxvar: InputPathType | None = None,
    ffxdof: float | None = None,
    ffxdofdat: InputPathType | None = None,
    weight: InputPathType | None = None,
    weight_inv_flag: bool = False,
    weight_sqrt_flag: bool = False,
    fwhm: float | None = None,
    var_fwhm: float | None = None,
    no_mask_smooth_flag: bool = False,
    no_est_fwhm_flag: bool = False,
    mask: InputPathType | None = None,
    label: InputPathType | None = None,
    no_mask_flag: bool = False,
    no_cortex_flag: bool = False,
    mask_inv_flag: bool = False,
    prune_flag: bool = False,
    no_prune_flag: bool = False,
    logy_flag: bool = False,
    no_logy_flag: bool = False,
    rm_spatial_mean_flag: bool = False,
    yhat_save_flag: bool = False,
    eres_save_flag: bool = False,
    eres_scm_flag: bool = False,
    save_fwhm_map_flag: bool = False,
    y_out: InputPathType | None = None,
    surface: str | None = None,
    skew_flag: bool = False,
    kurtosis_flag: bool = False,
    sim_params: list[str] | None = None,
    sim_sign: str | None = None,
    uniform_params: list[str] | None = None,
    permute_input_flag: bool = False,
    pca_flag: bool = False,
    tar1_flag: bool = False,
    save_yhat_flag: bool = False,
    save_cond_flag: bool = False,
    voxdump: list[float] | None = None,
    seed: float | None = None,
    synth_flag: bool = False,
    resynthtest_it: float | None = None,
    profile_it: float | None = None,
    mrtm1_params: list[str] | None = None,
    mrtm2_params: list[str] | None = None,
    logan_params: list[str] | None = None,
    bp_clip_neg_flag: bool = False,
    bp_clip_max: float | None = None,
    perm_force_flag: bool = False,
    diag_level: float | None = None,
    diag_cluster_flag: bool = False,
    debug_flag: bool = False,
    checkopts_flag: bool = False,
    help_flag: bool = False,
    version_flag: bool = False,
    no_fix_vertex_area_flag: bool = False,
    allowsubjrep_flag: bool = False,
    allow_zero_dof_flag: bool = False,
    illcond_flag: bool = False,
    sim_done_file: InputPathType | None = None,
    no_sig_double_flag: bool = False,
) -> MriGlmfitParamsDictTagged:
    """
    Build parameters.
    
    Args:
        y_input: Path to input file where each frame is a separate input.\
            Accepts volume or surface-based formats.
        glmdir: Directory where output will be saved.
        table_input: Use text table as input instead of --y. Table should be of\
            form produced by asegstats2table or aparcstats2table.
        fsgd: Specify the global design matrix with a FreeSurfer Group\
            Descriptor File (FSGDF).
        design_matrix: Explicitly specify the design matrix. Can be in simple\
            text or in matlab4 format.
        contrast_matrix: Specify one or more contrasts to test. File should be\
            ASCII text with the contrast matrix.
        osgm_flag: Construct X and C as a one-sample group mean.
        no_contrasts_ok_flag: Do not fail if no contrasts are specified.
        dti_params: Do DTI analysis using bvals and bvecs.
        dti_matrix: Do DTI analysis using provided matrix.
        pvr: Per-voxel (or vertex) regressors.
        selfreg: Create a 'self-regressor' from the input data based on the\
            waveform at index col row slice.
        wls: Perform weighted least squares (WLS) random effects analysis\
            instead of ordinary least squares (OLS) using yffxvar.
        yffxvar: For fixed effects analysis.
        ffxdof: Degrees of Freedom (DOF) for fixed effects analysis.
        ffxdofdat: Text file with DOF for fixed effects analysis.
        weight: Perform weighted LMS using per-voxel weights from the\
            weightfile.
        weight_inv_flag: Invert weights.
        weight_sqrt_flag: Square root of (inverted) weights.
        fwhm: Smooth input with a Gaussian kernel, specified in mm.
        var_fwhm: Smooth residual variance map with a Gaussian kernel,\
            specified in mm.
        no_mask_smooth_flag: Do not mask when smoothing.
        no_est_fwhm_flag: Turn off FWHM output estimation.
        mask: Binary mask file for analysis.
        label: Use label as mask for surface data.
        no_mask_flag: Do NOT use a mask, same as --no-cortex.
        no_cortex_flag: Do NOT use subjects ?h.cortex.label as --label.
        mask_inv_flag: Invert mask for analysis.
        prune_flag: Remove voxels that do not have a non-zero value at each\
            frame.
        no_prune_flag: Do not prune zero-value voxels.
        logy_flag: Compute natural log of y prior to analysis.
        no_logy_flag: Do not compute natural log of y prior to analysis.
        rm_spatial_mean_flag: Subtract the (masked) mean from each frame.
        yhat_save_flag: Save signal estimate (yhat).
        eres_save_flag: Save residual error (eres).
        eres_scm_flag: Save residual error spatial correlation matrix\
            (eres.scm).
        save_fwhm_map_flag: Save voxel-wise map of FWHM estimates.
        y_out: Save input after any pre-processing.
        surface: Specify that the input has a surface geometry from the\
            hemisphere of the given FreeSurfer subject. Required for surface data\
            operations.
        skew_flag: Compute skew and p-value for skew.
        kurtosis_flag: Compute kurtosis and p-value for kurtosis.
        sim_params: Simulate data for statistical testing. Specify nulltype,\
            number of simulations, threshold and csd basename.
        sim_sign: Specify sign for simulation: abs, pos, or neg.
        uniform_params: Use uniform distribution for mc-full, specify min and\
            max.
        permute_input_flag: Permute input for testing purposes (not related to\
            simulation).
        pca_flag: Perform PCA/SVD analysis on the residual.
        tar1_flag: Compute and save temporal AR1 of residual.
        save_yhat_flag: Flag to save the signal estimate.
        save_cond_flag: Flag to save design matrix condition at each voxel.
        voxdump: Save GLM data for a single voxel at the specified col, row,\
            slice.
        seed: Use seed for random number generation.
        synth_flag: Replace input data with Gaussian noise for testing.
        resynthtest_it: Test GLM by resynthsis with the number of iterations\
            specified.
        profile_it: Test speed with specified number of iterations.
        mrtm1_params: Perform MRTM1 kinetic modeling with specified reference\
            tissue activity and time in seconds.
        mrtm2_params: Perform MRTM2 kinetic modeling with specified parameters.
        logan_params: Perform Logan kinetic modeling with specified parameters.
        bp_clip_neg_flag: Set negative BP voxels to 0.
        bp_clip_max: Set BP voxels above max to max.
        perm_force_flag: Force permutation test, even when design matrix is not\
            orthogonal.
        diag_level: Set diagnostic level.
        diag_cluster_flag: Save significant volume and exit from first\
            simulation loop.
        debug_flag: Turn on debugging mode.
        checkopts_flag: Check options and exit without executing.
        help_flag: Display help information.
        version_flag: Print out version and exit.
        no_fix_vertex_area_flag: Turn off fixing of vertex area (backward\
            compatibility).
        allowsubjrep_flag: Allow subject names to repeat in the fsgd file.
        allow_zero_dof_flag: Allow analyses with zero degrees of freedom.
        illcond_flag: Allow ill-conditioned design matrices.
        sim_done_file: Create done file when simulation finishes.
        no_sig_double_flag: Compute sig = -log10(p) from float p value, not\
            double.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "freesurfer/mri_glmfit",
        "y_input": y_input,
        "osgm_flag": osgm_flag,
        "no_contrasts_ok_flag": no_contrasts_ok_flag,
        "weight_inv_flag": weight_inv_flag,
        "weight_sqrt_flag": weight_sqrt_flag,
        "no_mask_smooth_flag": no_mask_smooth_flag,
        "no_est_fwhm_flag": no_est_fwhm_flag,
        "no_mask_flag": no_mask_flag,
        "no_cortex_flag": no_cortex_flag,
        "mask_inv_flag": mask_inv_flag,
        "prune_flag": prune_flag,
        "no_prune_flag": no_prune_flag,
        "logy_flag": logy_flag,
        "no_logy_flag": no_logy_flag,
        "rm_spatial_mean_flag": rm_spatial_mean_flag,
        "yhat_save_flag": yhat_save_flag,
        "eres_save_flag": eres_save_flag,
        "eres_scm_flag": eres_scm_flag,
        "save_fwhm_map_flag": save_fwhm_map_flag,
        "skew_flag": skew_flag,
        "kurtosis_flag": kurtosis_flag,
        "permute_input_flag": permute_input_flag,
        "pca_flag": pca_flag,
        "tar1_flag": tar1_flag,
        "save_yhat_flag": save_yhat_flag,
        "save_cond_flag": save_cond_flag,
        "synth_flag": synth_flag,
        "bp_clip_neg_flag": bp_clip_neg_flag,
        "perm_force_flag": perm_force_flag,
        "diag_cluster_flag": diag_cluster_flag,
        "debug_flag": debug_flag,
        "checkopts_flag": checkopts_flag,
        "help_flag": help_flag,
        "version_flag": version_flag,
        "no_fix_vertex_area_flag": no_fix_vertex_area_flag,
        "allowsubjrep_flag": allowsubjrep_flag,
        "allow_zero_dof_flag": allow_zero_dof_flag,
        "illcond_flag": illcond_flag,
        "no_sig_double_flag": no_sig_double_flag,
    }
    if glmdir is not None:
        params["glmdir"] = glmdir
    if table_input is not None:
        params["table_input"] = table_input
    if fsgd is not None:
        params["fsgd"] = fsgd
    if design_matrix is not None:
        params["design_matrix"] = design_matrix
    if contrast_matrix is not None:
        params["contrast_matrix"] = contrast_matrix
    if dti_params is not None:
        params["dti_params"] = dti_params
    if dti_matrix is not None:
        params["dti_matrix"] = dti_matrix
    if pvr is not None:
        params["pvr"] = pvr
    if selfreg is not None:
        params["selfreg"] = selfreg
    if wls is not None:
        params["wls"] = wls
    if yffxvar is not None:
        params["yffxvar"] = yffxvar
    if ffxdof is not None:
        params["ffxdof"] = ffxdof
    if ffxdofdat is not None:
        params["ffxdofdat"] = ffxdofdat
    if weight is not None:
        params["weight"] = weight
    if fwhm is not None:
        params["fwhm"] = fwhm
    if var_fwhm is not None:
        params["var_fwhm"] = var_fwhm
    if mask is not None:
        params["mask"] = mask
    if label is not None:
        params["label"] = label
    if y_out is not None:
        params["y_out"] = y_out
    if surface is not None:
        params["surface"] = surface
    if sim_params is not None:
        params["sim_params"] = sim_params
    if sim_sign is not None:
        params["sim_sign"] = sim_sign
    if uniform_params is not None:
        params["uniform_params"] = uniform_params
    if voxdump is not None:
        params["voxdump"] = voxdump
    if seed is not None:
        params["seed"] = seed
    if resynthtest_it is not None:
        params["resynthtest_it"] = resynthtest_it
    if profile_it is not None:
        params["profile_it"] = profile_it
    if mrtm1_params is not None:
        params["mrtm1_params"] = mrtm1_params
    if mrtm2_params is not None:
        params["mrtm2_params"] = mrtm2_params
    if logan_params is not None:
        params["logan_params"] = logan_params
    if bp_clip_max is not None:
        params["bp_clip_max"] = bp_clip_max
    if diag_level is not None:
        params["diag_level"] = diag_level
    if sim_done_file is not None:
        params["sim_done_file"] = sim_done_file
    return params


def mri_glmfit_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `MriGlmfitParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("glmdir", None) is not None:
        if not isinstance(params["glmdir"], str):
            raise StyxValidationError(f'`glmdir` has the wrong type: Received `{type(params.get("glmdir", None))}` expected `str | None`')
    if params.get("y_input", None) is None:
        raise StyxValidationError("`y_input` must not be None")
    if not isinstance(params["y_input"], (pathlib.Path, str)):
        raise StyxValidationError(f'`y_input` has the wrong type: Received `{type(params.get("y_input", None))}` expected `InputPathType`')
    if params.get("table_input", None) is not None:
        if not isinstance(params["table_input"], (pathlib.Path, str)):
            raise StyxValidationError(f'`table_input` has the wrong type: Received `{type(params.get("table_input", None))}` expected `InputPathType | None`')
    if params.get("fsgd", None) is not None:
        if not isinstance(params["fsgd"], (pathlib.Path, str)):
            raise StyxValidationError(f'`fsgd` has the wrong type: Received `{type(params.get("fsgd", None))}` expected `InputPathType | None`')
    if params.get("design_matrix", None) is not None:
        if not isinstance(params["design_matrix"], (pathlib.Path, str)):
            raise StyxValidationError(f'`design_matrix` has the wrong type: Received `{type(params.get("design_matrix", None))}` expected `InputPathType | None`')
    if params.get("contrast_matrix", None) is not None:
        if not isinstance(params["contrast_matrix"], list):
            raise StyxValidationError(f'`contrast_matrix` has the wrong type: Received `{type(params.get("contrast_matrix", None))}` expected `list[InputPathType] | None`')
        for e in params["contrast_matrix"]:
            if not isinstance(e, (pathlib.Path, str)):
                raise StyxValidationError(f'`contrast_matrix` has the wrong type: Received `{type(params.get("contrast_matrix", None))}` expected `list[InputPathType] | None`')
    if params.get("osgm_flag", False) is None:
        raise StyxValidationError("`osgm_flag` must not be None")
    if not isinstance(params["osgm_flag"], bool):
        raise StyxValidationError(f'`osgm_flag` has the wrong type: Received `{type(params.get("osgm_flag", False))}` expected `bool`')
    if params.get("no_contrasts_ok_flag", False) is None:
        raise StyxValidationError("`no_contrasts_ok_flag` must not be None")
    if not isinstance(params["no_contrasts_ok_flag"], bool):
        raise StyxValidationError(f'`no_contrasts_ok_flag` has the wrong type: Received `{type(params.get("no_contrasts_ok_flag", False))}` expected `bool`')
    if params.get("dti_params", None) is not None:
        if not isinstance(params["dti_params"], list):
            raise StyxValidationError(f'`dti_params` has the wrong type: Received `{type(params.get("dti_params", None))}` expected `list[str] | None`')
        for e in params["dti_params"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`dti_params` has the wrong type: Received `{type(params.get("dti_params", None))}` expected `list[str] | None`')
    if params.get("dti_matrix", None) is not None:
        if not isinstance(params["dti_matrix"], (pathlib.Path, str)):
            raise StyxValidationError(f'`dti_matrix` has the wrong type: Received `{type(params.get("dti_matrix", None))}` expected `InputPathType | None`')
    if params.get("pvr", None) is not None:
        if not isinstance(params["pvr"], list):
            raise StyxValidationError(f'`pvr` has the wrong type: Received `{type(params.get("pvr", None))}` expected `list[InputPathType] | None`')
        for e in params["pvr"]:
            if not isinstance(e, (pathlib.Path, str)):
                raise StyxValidationError(f'`pvr` has the wrong type: Received `{type(params.get("pvr", None))}` expected `list[InputPathType] | None`')
    if params.get("selfreg", None) is not None:
        if not isinstance(params["selfreg"], list):
            raise StyxValidationError(f'`selfreg` has the wrong type: Received `{type(params.get("selfreg", None))}` expected `list[float] | None`')
        if len(params["selfreg"]) != 3:
            raise StyxValidationError("Parameter `selfreg` must contain exactly 3 elements")
        for e in params["selfreg"]:
            if not isinstance(e, (float, int)):
                raise StyxValidationError(f'`selfreg` has the wrong type: Received `{type(params.get("selfreg", None))}` expected `list[float] | None`')
    if params.get("wls", None) is not None:
        if not isinstance(params["wls"], str):
            raise StyxValidationError(f'`wls` has the wrong type: Received `{type(params.get("wls", None))}` expected `str | None`')
    if params.get("yffxvar", None) is not None:
        if not isinstance(params["yffxvar"], (pathlib.Path, str)):
            raise StyxValidationError(f'`yffxvar` has the wrong type: Received `{type(params.get("yffxvar", None))}` expected `InputPathType | None`')
    if params.get("ffxdof", None) is not None:
        if not isinstance(params["ffxdof"], (float, int)):
            raise StyxValidationError(f'`ffxdof` has the wrong type: Received `{type(params.get("ffxdof", None))}` expected `float | None`')
    if params.get("ffxdofdat", None) is not None:
        if not isinstance(params["ffxdofdat"], (pathlib.Path, str)):
            raise StyxValidationError(f'`ffxdofdat` has the wrong type: Received `{type(params.get("ffxdofdat", None))}` expected `InputPathType | None`')
    if params.get("weight", None) is not None:
        if not isinstance(params["weight"], (pathlib.Path, str)):
            raise StyxValidationError(f'`weight` has the wrong type: Received `{type(params.get("weight", None))}` expected `InputPathType | None`')
    if params.get("weight_inv_flag", False) is None:
        raise StyxValidationError("`weight_inv_flag` must not be None")
    if not isinstance(params["weight_inv_flag"], bool):
        raise StyxValidationError(f'`weight_inv_flag` has the wrong type: Received `{type(params.get("weight_inv_flag", False))}` expected `bool`')
    if params.get("weight_sqrt_flag", False) is None:
        raise StyxValidationError("`weight_sqrt_flag` must not be None")
    if not isinstance(params["weight_sqrt_flag"], bool):
        raise StyxValidationError(f'`weight_sqrt_flag` has the wrong type: Received `{type(params.get("weight_sqrt_flag", False))}` expected `bool`')
    if params.get("fwhm", None) is not None:
        if not isinstance(params["fwhm"], (float, int)):
            raise StyxValidationError(f'`fwhm` has the wrong type: Received `{type(params.get("fwhm", None))}` expected `float | None`')
    if params.get("var_fwhm", None) is not None:
        if not isinstance(params["var_fwhm"], (float, int)):
            raise StyxValidationError(f'`var_fwhm` has the wrong type: Received `{type(params.get("var_fwhm", None))}` expected `float | None`')
    if params.get("no_mask_smooth_flag", False) is None:
        raise StyxValidationError("`no_mask_smooth_flag` must not be None")
    if not isinstance(params["no_mask_smooth_flag"], bool):
        raise StyxValidationError(f'`no_mask_smooth_flag` has the wrong type: Received `{type(params.get("no_mask_smooth_flag", False))}` expected `bool`')
    if params.get("no_est_fwhm_flag", False) is None:
        raise StyxValidationError("`no_est_fwhm_flag` must not be None")
    if not isinstance(params["no_est_fwhm_flag"], bool):
        raise StyxValidationError(f'`no_est_fwhm_flag` has the wrong type: Received `{type(params.get("no_est_fwhm_flag", False))}` expected `bool`')
    if params.get("mask", None) is not None:
        if not isinstance(params["mask"], (pathlib.Path, str)):
            raise StyxValidationError(f'`mask` has the wrong type: Received `{type(params.get("mask", None))}` expected `InputPathType | None`')
    if params.get("label", None) is not None:
        if not isinstance(params["label"], (pathlib.Path, str)):
            raise StyxValidationError(f'`label` has the wrong type: Received `{type(params.get("label", None))}` expected `InputPathType | None`')
    if params.get("no_mask_flag", False) is None:
        raise StyxValidationError("`no_mask_flag` must not be None")
    if not isinstance(params["no_mask_flag"], bool):
        raise StyxValidationError(f'`no_mask_flag` has the wrong type: Received `{type(params.get("no_mask_flag", False))}` expected `bool`')
    if params.get("no_cortex_flag", False) is None:
        raise StyxValidationError("`no_cortex_flag` must not be None")
    if not isinstance(params["no_cortex_flag"], bool):
        raise StyxValidationError(f'`no_cortex_flag` has the wrong type: Received `{type(params.get("no_cortex_flag", False))}` expected `bool`')
    if params.get("mask_inv_flag", False) is None:
        raise StyxValidationError("`mask_inv_flag` must not be None")
    if not isinstance(params["mask_inv_flag"], bool):
        raise StyxValidationError(f'`mask_inv_flag` has the wrong type: Received `{type(params.get("mask_inv_flag", False))}` expected `bool`')
    if params.get("prune_flag", False) is None:
        raise StyxValidationError("`prune_flag` must not be None")
    if not isinstance(params["prune_flag"], bool):
        raise StyxValidationError(f'`prune_flag` has the wrong type: Received `{type(params.get("prune_flag", False))}` expected `bool`')
    if params.get("no_prune_flag", False) is None:
        raise StyxValidationError("`no_prune_flag` must not be None")
    if not isinstance(params["no_prune_flag"], bool):
        raise StyxValidationError(f'`no_prune_flag` has the wrong type: Received `{type(params.get("no_prune_flag", False))}` expected `bool`')
    if params.get("logy_flag", False) is None:
        raise StyxValidationError("`logy_flag` must not be None")
    if not isinstance(params["logy_flag"], bool):
        raise StyxValidationError(f'`logy_flag` has the wrong type: Received `{type(params.get("logy_flag", False))}` expected `bool`')
    if params.get("no_logy_flag", False) is None:
        raise StyxValidationError("`no_logy_flag` must not be None")
    if not isinstance(params["no_logy_flag"], bool):
        raise StyxValidationError(f'`no_logy_flag` has the wrong type: Received `{type(params.get("no_logy_flag", False))}` expected `bool`')
    if params.get("rm_spatial_mean_flag", False) is None:
        raise StyxValidationError("`rm_spatial_mean_flag` must not be None")
    if not isinstance(params["rm_spatial_mean_flag"], bool):
        raise StyxValidationError(f'`rm_spatial_mean_flag` has the wrong type: Received `{type(params.get("rm_spatial_mean_flag", False))}` expected `bool`')
    if params.get("yhat_save_flag", False) is None:
        raise StyxValidationError("`yhat_save_flag` must not be None")
    if not isinstance(params["yhat_save_flag"], bool):
        raise StyxValidationError(f'`yhat_save_flag` has the wrong type: Received `{type(params.get("yhat_save_flag", False))}` expected `bool`')
    if params.get("eres_save_flag", False) is None:
        raise StyxValidationError("`eres_save_flag` must not be None")
    if not isinstance(params["eres_save_flag"], bool):
        raise StyxValidationError(f'`eres_save_flag` has the wrong type: Received `{type(params.get("eres_save_flag", False))}` expected `bool`')
    if params.get("eres_scm_flag", False) is None:
        raise StyxValidationError("`eres_scm_flag` must not be None")
    if not isinstance(params["eres_scm_flag"], bool):
        raise StyxValidationError(f'`eres_scm_flag` has the wrong type: Received `{type(params.get("eres_scm_flag", False))}` expected `bool`')
    if params.get("save_fwhm_map_flag", False) is None:
        raise StyxValidationError("`save_fwhm_map_flag` must not be None")
    if not isinstance(params["save_fwhm_map_flag"], bool):
        raise StyxValidationError(f'`save_fwhm_map_flag` has the wrong type: Received `{type(params.get("save_fwhm_map_flag", False))}` expected `bool`')
    if params.get("y_out", None) is not None:
        if not isinstance(params["y_out"], (pathlib.Path, str)):
            raise StyxValidationError(f'`y_out` has the wrong type: Received `{type(params.get("y_out", None))}` expected `InputPathType | None`')
    if params.get("surface", None) is not None:
        if not isinstance(params["surface"], str):
            raise StyxValidationError(f'`surface` has the wrong type: Received `{type(params.get("surface", None))}` expected `str | None`')
    if params.get("skew_flag", False) is None:
        raise StyxValidationError("`skew_flag` must not be None")
    if not isinstance(params["skew_flag"], bool):
        raise StyxValidationError(f'`skew_flag` has the wrong type: Received `{type(params.get("skew_flag", False))}` expected `bool`')
    if params.get("kurtosis_flag", False) is None:
        raise StyxValidationError("`kurtosis_flag` must not be None")
    if not isinstance(params["kurtosis_flag"], bool):
        raise StyxValidationError(f'`kurtosis_flag` has the wrong type: Received `{type(params.get("kurtosis_flag", False))}` expected `bool`')
    if params.get("sim_params", None) is not None:
        if not isinstance(params["sim_params"], list):
            raise StyxValidationError(f'`sim_params` has the wrong type: Received `{type(params.get("sim_params", None))}` expected `list[str] | None`')
        for e in params["sim_params"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`sim_params` has the wrong type: Received `{type(params.get("sim_params", None))}` expected `list[str] | None`')
    if params.get("sim_sign", None) is not None:
        if not isinstance(params["sim_sign"], str):
            raise StyxValidationError(f'`sim_sign` has the wrong type: Received `{type(params.get("sim_sign", None))}` expected `str | None`')
    if params.get("uniform_params", None) is not None:
        if not isinstance(params["uniform_params"], list):
            raise StyxValidationError(f'`uniform_params` has the wrong type: Received `{type(params.get("uniform_params", None))}` expected `list[str] | None`')
        for e in params["uniform_params"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`uniform_params` has the wrong type: Received `{type(params.get("uniform_params", None))}` expected `list[str] | None`')
    if params.get("permute_input_flag", False) is None:
        raise StyxValidationError("`permute_input_flag` must not be None")
    if not isinstance(params["permute_input_flag"], bool):
        raise StyxValidationError(f'`permute_input_flag` has the wrong type: Received `{type(params.get("permute_input_flag", False))}` expected `bool`')
    if params.get("pca_flag", False) is None:
        raise StyxValidationError("`pca_flag` must not be None")
    if not isinstance(params["pca_flag"], bool):
        raise StyxValidationError(f'`pca_flag` has the wrong type: Received `{type(params.get("pca_flag", False))}` expected `bool`')
    if params.get("tar1_flag", False) is None:
        raise StyxValidationError("`tar1_flag` must not be None")
    if not isinstance(params["tar1_flag"], bool):
        raise StyxValidationError(f'`tar1_flag` has the wrong type: Received `{type(params.get("tar1_flag", False))}` expected `bool`')
    if params.get("save_yhat_flag", False) is None:
        raise StyxValidationError("`save_yhat_flag` must not be None")
    if not isinstance(params["save_yhat_flag"], bool):
        raise StyxValidationError(f'`save_yhat_flag` has the wrong type: Received `{type(params.get("save_yhat_flag", False))}` expected `bool`')
    if params.get("save_cond_flag", False) is None:
        raise StyxValidationError("`save_cond_flag` must not be None")
    if not isinstance(params["save_cond_flag"], bool):
        raise StyxValidationError(f'`save_cond_flag` has the wrong type: Received `{type(params.get("save_cond_flag", False))}` expected `bool`')
    if params.get("voxdump", None) is not None:
        if not isinstance(params["voxdump"], list):
            raise StyxValidationError(f'`voxdump` has the wrong type: Received `{type(params.get("voxdump", None))}` expected `list[float] | None`')
        if len(params["voxdump"]) != 3:
            raise StyxValidationError("Parameter `voxdump` must contain exactly 3 elements")
        for e in params["voxdump"]:
            if not isinstance(e, (float, int)):
                raise StyxValidationError(f'`voxdump` has the wrong type: Received `{type(params.get("voxdump", None))}` expected `list[float] | None`')
    if params.get("seed", None) is not None:
        if not isinstance(params["seed"], (float, int)):
            raise StyxValidationError(f'`seed` has the wrong type: Received `{type(params.get("seed", None))}` expected `float | None`')
    if params.get("synth_flag", False) is None:
        raise StyxValidationError("`synth_flag` must not be None")
    if not isinstance(params["synth_flag"], bool):
        raise StyxValidationError(f'`synth_flag` has the wrong type: Received `{type(params.get("synth_flag", False))}` expected `bool`')
    if params.get("resynthtest_it", None) is not None:
        if not isinstance(params["resynthtest_it"], (float, int)):
            raise StyxValidationError(f'`resynthtest_it` has the wrong type: Received `{type(params.get("resynthtest_it", None))}` expected `float | None`')
    if params.get("profile_it", None) is not None:
        if not isinstance(params["profile_it"], (float, int)):
            raise StyxValidationError(f'`profile_it` has the wrong type: Received `{type(params.get("profile_it", None))}` expected `float | None`')
    if params.get("mrtm1_params", None) is not None:
        if not isinstance(params["mrtm1_params"], list):
            raise StyxValidationError(f'`mrtm1_params` has the wrong type: Received `{type(params.get("mrtm1_params", None))}` expected `list[str] | None`')
        for e in params["mrtm1_params"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`mrtm1_params` has the wrong type: Received `{type(params.get("mrtm1_params", None))}` expected `list[str] | None`')
    if params.get("mrtm2_params", None) is not None:
        if not isinstance(params["mrtm2_params"], list):
            raise StyxValidationError(f'`mrtm2_params` has the wrong type: Received `{type(params.get("mrtm2_params", None))}` expected `list[str] | None`')
        for e in params["mrtm2_params"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`mrtm2_params` has the wrong type: Received `{type(params.get("mrtm2_params", None))}` expected `list[str] | None`')
    if params.get("logan_params", None) is not None:
        if not isinstance(params["logan_params"], list):
            raise StyxValidationError(f'`logan_params` has the wrong type: Received `{type(params.get("logan_params", None))}` expected `list[str] | None`')
        for e in params["logan_params"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`logan_params` has the wrong type: Received `{type(params.get("logan_params", None))}` expected `list[str] | None`')
    if params.get("bp_clip_neg_flag", False) is None:
        raise StyxValidationError("`bp_clip_neg_flag` must not be None")
    if not isinstance(params["bp_clip_neg_flag"], bool):
        raise StyxValidationError(f'`bp_clip_neg_flag` has the wrong type: Received `{type(params.get("bp_clip_neg_flag", False))}` expected `bool`')
    if params.get("bp_clip_max", None) is not None:
        if not isinstance(params["bp_clip_max"], (float, int)):
            raise StyxValidationError(f'`bp_clip_max` has the wrong type: Received `{type(params.get("bp_clip_max", None))}` expected `float | None`')
    if params.get("perm_force_flag", False) is None:
        raise StyxValidationError("`perm_force_flag` must not be None")
    if not isinstance(params["perm_force_flag"], bool):
        raise StyxValidationError(f'`perm_force_flag` has the wrong type: Received `{type(params.get("perm_force_flag", False))}` expected `bool`')
    if params.get("diag_level", None) is not None:
        if not isinstance(params["diag_level"], (float, int)):
            raise StyxValidationError(f'`diag_level` has the wrong type: Received `{type(params.get("diag_level", None))}` expected `float | None`')
    if params.get("diag_cluster_flag", False) is None:
        raise StyxValidationError("`diag_cluster_flag` must not be None")
    if not isinstance(params["diag_cluster_flag"], bool):
        raise StyxValidationError(f'`diag_cluster_flag` has the wrong type: Received `{type(params.get("diag_cluster_flag", False))}` expected `bool`')
    if params.get("debug_flag", False) is None:
        raise StyxValidationError("`debug_flag` must not be None")
    if not isinstance(params["debug_flag"], bool):
        raise StyxValidationError(f'`debug_flag` has the wrong type: Received `{type(params.get("debug_flag", False))}` expected `bool`')
    if params.get("checkopts_flag", False) is None:
        raise StyxValidationError("`checkopts_flag` must not be None")
    if not isinstance(params["checkopts_flag"], bool):
        raise StyxValidationError(f'`checkopts_flag` has the wrong type: Received `{type(params.get("checkopts_flag", False))}` expected `bool`')
    if params.get("help_flag", False) is None:
        raise StyxValidationError("`help_flag` must not be None")
    if not isinstance(params["help_flag"], bool):
        raise StyxValidationError(f'`help_flag` has the wrong type: Received `{type(params.get("help_flag", False))}` expected `bool`')
    if params.get("version_flag", False) is None:
        raise StyxValidationError("`version_flag` must not be None")
    if not isinstance(params["version_flag"], bool):
        raise StyxValidationError(f'`version_flag` has the wrong type: Received `{type(params.get("version_flag", False))}` expected `bool`')
    if params.get("no_fix_vertex_area_flag", False) is None:
        raise StyxValidationError("`no_fix_vertex_area_flag` must not be None")
    if not isinstance(params["no_fix_vertex_area_flag"], bool):
        raise StyxValidationError(f'`no_fix_vertex_area_flag` has the wrong type: Received `{type(params.get("no_fix_vertex_area_flag", False))}` expected `bool`')
    if params.get("allowsubjrep_flag", False) is None:
        raise StyxValidationError("`allowsubjrep_flag` must not be None")
    if not isinstance(params["allowsubjrep_flag"], bool):
        raise StyxValidationError(f'`allowsubjrep_flag` has the wrong type: Received `{type(params.get("allowsubjrep_flag", False))}` expected `bool`')
    if params.get("allow_zero_dof_flag", False) is None:
        raise StyxValidationError("`allow_zero_dof_flag` must not be None")
    if not isinstance(params["allow_zero_dof_flag"], bool):
        raise StyxValidationError(f'`allow_zero_dof_flag` has the wrong type: Received `{type(params.get("allow_zero_dof_flag", False))}` expected `bool`')
    if params.get("illcond_flag", False) is None:
        raise StyxValidationError("`illcond_flag` must not be None")
    if not isinstance(params["illcond_flag"], bool):
        raise StyxValidationError(f'`illcond_flag` has the wrong type: Received `{type(params.get("illcond_flag", False))}` expected `bool`')
    if params.get("sim_done_file", None) is not None:
        if not isinstance(params["sim_done_file"], (pathlib.Path, str)):
            raise StyxValidationError(f'`sim_done_file` has the wrong type: Received `{type(params.get("sim_done_file", None))}` expected `InputPathType | None`')
    if params.get("no_sig_double_flag", False) is None:
        raise StyxValidationError("`no_sig_double_flag` must not be None")
    if not isinstance(params["no_sig_double_flag"], bool):
        raise StyxValidationError(f'`no_sig_double_flag` has the wrong type: Received `{type(params.get("no_sig_double_flag", False))}` expected `bool`')


def mri_glmfit_cargs(
    params: MriGlmfitParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("mri_glmfit")
    if params.get("glmdir", None) is not None:
        cargs.extend([
            "--glmdir",
            params.get("glmdir", None)
        ])
    cargs.extend([
        "--y",
        execution.input_file(params.get("y_input", None))
    ])
    if params.get("table_input", None) is not None:
        cargs.extend([
            "--table",
            execution.input_file(params.get("table_input", None))
        ])
    if params.get("fsgd", None) is not None:
        cargs.extend([
            "--fsgd",
            execution.input_file(params.get("fsgd", None))
        ])
    if params.get("design_matrix", None) is not None:
        cargs.extend([
            "--X",
            execution.input_file(params.get("design_matrix", None))
        ])
    if params.get("contrast_matrix", None) is not None:
        cargs.extend([
            "--C",
            *[execution.input_file(f) for f in params.get("contrast_matrix", None)]
        ])
    if params.get("osgm_flag", False):
        cargs.append("--osgm")
    if params.get("no_contrasts_ok_flag", False):
        cargs.append("--no-contrasts-ok")
    if params.get("dti_params", None) is not None:
        cargs.extend([
            "--dti",
            *params.get("dti_params", None)
        ])
    if params.get("dti_matrix", None) is not None:
        cargs.extend([
            "--dti-X",
            execution.input_file(params.get("dti_matrix", None))
        ])
    if params.get("pvr", None) is not None:
        cargs.extend([
            "--pvr",
            *[execution.input_file(f) for f in params.get("pvr", None)]
        ])
    if params.get("selfreg", None) is not None:
        cargs.extend([
            "--selfreg",
            *map(str, params.get("selfreg", None))
        ])
    if params.get("wls", None) is not None:
        cargs.extend([
            "--wls",
            params.get("wls", None)
        ])
    if params.get("yffxvar", None) is not None:
        cargs.extend([
            "--yffxvar",
            execution.input_file(params.get("yffxvar", None))
        ])
    if params.get("ffxdof", None) is not None:
        cargs.extend([
            "--ffxdof",
            str(params.get("ffxdof", None))
        ])
    if params.get("ffxdofdat", None) is not None:
        cargs.extend([
            "--ffxdofdat",
            execution.input_file(params.get("ffxdofdat", None))
        ])
    if params.get("weight", None) is not None:
        cargs.extend([
            "--w",
            execution.input_file(params.get("weight", None))
        ])
    if params.get("weight_inv_flag", False):
        cargs.append("--w-inv")
    if params.get("weight_sqrt_flag", False):
        cargs.append("--w-sqrt")
    if params.get("fwhm", None) is not None:
        cargs.extend([
            "--fwhm",
            str(params.get("fwhm", None))
        ])
    if params.get("var_fwhm", None) is not None:
        cargs.extend([
            "--var-fwhm",
            str(params.get("var_fwhm", None))
        ])
    if params.get("no_mask_smooth_flag", False):
        cargs.append("--no-mask-smooth")
    if params.get("no_est_fwhm_flag", False):
        cargs.append("--no-est-fwhm")
    if params.get("mask", None) is not None:
        cargs.extend([
            "--mask",
            execution.input_file(params.get("mask", None))
        ])
    if params.get("label", None) is not None:
        cargs.extend([
            "--label",
            execution.input_file(params.get("label", None))
        ])
    if params.get("no_mask_flag", False):
        cargs.append("--no-mask")
    if params.get("no_cortex_flag", False):
        cargs.append("--no-cortex")
    if params.get("mask_inv_flag", False):
        cargs.append("--mask-inv")
    if params.get("prune_flag", False):
        cargs.append("--prune")
    if params.get("no_prune_flag", False):
        cargs.append("--no-prune")
    if params.get("logy_flag", False):
        cargs.append("--logy")
    if params.get("no_logy_flag", False):
        cargs.append("--no-logy")
    if params.get("rm_spatial_mean_flag", False):
        cargs.append("--rm-spatial-mean")
    if params.get("yhat_save_flag", False):
        cargs.append("--yhat-save")
    if params.get("eres_save_flag", False):
        cargs.append("--eres-save")
    if params.get("eres_scm_flag", False):
        cargs.append("--eres-scm")
    if params.get("save_fwhm_map_flag", False):
        cargs.append("--save-fwhm-map")
    if params.get("y_out", None) is not None:
        cargs.extend([
            "--y-out",
            execution.input_file(params.get("y_out", None))
        ])
    if params.get("surface", None) is not None:
        cargs.extend([
            "--surf",
            params.get("surface", None)
        ])
    if params.get("skew_flag", False):
        cargs.append("--skew")
    if params.get("kurtosis_flag", False):
        cargs.append("--kurtosis")
    if params.get("sim_params", None) is not None:
        cargs.extend([
            "--sim",
            *params.get("sim_params", None)
        ])
    if params.get("sim_sign", None) is not None:
        cargs.extend([
            "--sim-sign",
            params.get("sim_sign", None)
        ])
    if params.get("uniform_params", None) is not None:
        cargs.extend([
            "--uniform",
            *params.get("uniform_params", None)
        ])
    if params.get("permute_input_flag", False):
        cargs.append("--permute-input")
    if params.get("pca_flag", False):
        cargs.append("--pca")
    if params.get("tar1_flag", False):
        cargs.append("--tar1")
    if params.get("save_yhat_flag", False):
        cargs.append("--save-yhat")
    if params.get("save_cond_flag", False):
        cargs.append("--save-cond")
    if params.get("voxdump", None) is not None:
        cargs.extend([
            "--voxdump",
            *map(str, params.get("voxdump", None))
        ])
    if params.get("seed", None) is not None:
        cargs.extend([
            "--seed",
            str(params.get("seed", None))
        ])
    if params.get("synth_flag", False):
        cargs.append("--synth")
    if params.get("resynthtest_it", None) is not None:
        cargs.extend([
            "--resynthtest",
            str(params.get("resynthtest_it", None))
        ])
    if params.get("profile_it", None) is not None:
        cargs.extend([
            "--profile",
            str(params.get("profile_it", None))
        ])
    if params.get("mrtm1_params", None) is not None:
        cargs.extend([
            "--mrtm1",
            *params.get("mrtm1_params", None)
        ])
    if params.get("mrtm2_params", None) is not None:
        cargs.extend([
            "--mrtm2",
            *params.get("mrtm2_params", None)
        ])
    if params.get("logan_params", None) is not None:
        cargs.extend([
            "--logan",
            *params.get("logan_params", None)
        ])
    if params.get("bp_clip_neg_flag", False):
        cargs.append("--bp-clip-neg")
    if params.get("bp_clip_max", None) is not None:
        cargs.extend([
            "--bp-clip-max",
            str(params.get("bp_clip_max", None))
        ])
    if params.get("perm_force_flag", False):
        cargs.append("--perm-force")
    if params.get("diag_level", None) is not None:
        cargs.extend([
            "--diag",
            str(params.get("diag_level", None))
        ])
    if params.get("diag_cluster_flag", False):
        cargs.append("--diag-cluster")
    if params.get("debug_flag", False):
        cargs.append("--debug")
    if params.get("checkopts_flag", False):
        cargs.append("--checkopts")
    if params.get("help_flag", False):
        cargs.append("--help")
    if params.get("version_flag", False):
        cargs.append("--version")
    if params.get("no_fix_vertex_area_flag", False):
        cargs.append("--no-fix-vertex-area")
    if params.get("allowsubjrep_flag", False):
        cargs.append("--allowsubjrep")
    if params.get("allow_zero_dof_flag", False):
        cargs.append("--allow-zero-dof")
    if params.get("illcond_flag", False):
        cargs.append("--illcond")
    if params.get("sim_done_file", None) is not None:
        cargs.extend([
            "--sim-done",
            execution.input_file(params.get("sim_done_file", None))
        ])
    if params.get("no_sig_double_flag", False):
        cargs.append("--no-sig-double")
    return cargs


def mri_glmfit_outputs(
    params: MriGlmfitParamsDict,
    execution: Execution,
) -> MriGlmfitOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = MriGlmfitOutputs(
        root=execution.output_file("."),
        regression_coefs=execution.output_file("beta.mgh"),
        residual_error=execution.output_file("eres.mgh"),
        residual_variance=execution.output_file("rvar.mgh"),
        residual_stddev=execution.output_file("rstd.mgh"),
        fsgd_output=execution.output_file("y.fsgd"),
        normalized_weights=execution.output_file("wn.mgh"),
        signal_estimate=execution.output_file("yhat.mgh"),
        final_mask=execution.output_file("mask.mgh"),
        design_condition=execution.output_file("cond.mgh"),
        contrast_output_dir=execution.output_file("contrast1name"),
    )
    return ret


def mri_glmfit_execute(
    params: MriGlmfitParamsDict,
    runner: Runner | None = None,
) -> MriGlmfitOutputs:
    """
    mri_glmfit
    
    Performs general linear model (GLM) analysis in the volume or the surface.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MriGlmfitOutputs`).
    """
    mri_glmfit_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(MRI_GLMFIT_METADATA)
    params = execution.params(params)
    cargs = mri_glmfit_cargs(params, execution)
    ret = mri_glmfit_outputs(params, execution)
    execution.run(cargs)
    return ret


def mri_glmfit(
    y_input: InputPathType,
    glmdir: str | None = None,
    table_input: InputPathType | None = None,
    fsgd: InputPathType | None = None,
    design_matrix: InputPathType | None = None,
    contrast_matrix: list[InputPathType] | None = None,
    osgm_flag: bool = False,
    no_contrasts_ok_flag: bool = False,
    dti_params: list[str] | None = None,
    dti_matrix: InputPathType | None = None,
    pvr: list[InputPathType] | None = None,
    selfreg: list[float] | None = None,
    wls: str | None = None,
    yffxvar: InputPathType | None = None,
    ffxdof: float | None = None,
    ffxdofdat: InputPathType | None = None,
    weight: InputPathType | None = None,
    weight_inv_flag: bool = False,
    weight_sqrt_flag: bool = False,
    fwhm: float | None = None,
    var_fwhm: float | None = None,
    no_mask_smooth_flag: bool = False,
    no_est_fwhm_flag: bool = False,
    mask: InputPathType | None = None,
    label: InputPathType | None = None,
    no_mask_flag: bool = False,
    no_cortex_flag: bool = False,
    mask_inv_flag: bool = False,
    prune_flag: bool = False,
    no_prune_flag: bool = False,
    logy_flag: bool = False,
    no_logy_flag: bool = False,
    rm_spatial_mean_flag: bool = False,
    yhat_save_flag: bool = False,
    eres_save_flag: bool = False,
    eres_scm_flag: bool = False,
    save_fwhm_map_flag: bool = False,
    y_out: InputPathType | None = None,
    surface: str | None = None,
    skew_flag: bool = False,
    kurtosis_flag: bool = False,
    sim_params: list[str] | None = None,
    sim_sign: str | None = None,
    uniform_params: list[str] | None = None,
    permute_input_flag: bool = False,
    pca_flag: bool = False,
    tar1_flag: bool = False,
    save_yhat_flag: bool = False,
    save_cond_flag: bool = False,
    voxdump: list[float] | None = None,
    seed: float | None = None,
    synth_flag: bool = False,
    resynthtest_it: float | None = None,
    profile_it: float | None = None,
    mrtm1_params: list[str] | None = None,
    mrtm2_params: list[str] | None = None,
    logan_params: list[str] | None = None,
    bp_clip_neg_flag: bool = False,
    bp_clip_max: float | None = None,
    perm_force_flag: bool = False,
    diag_level: float | None = None,
    diag_cluster_flag: bool = False,
    debug_flag: bool = False,
    checkopts_flag: bool = False,
    help_flag: bool = False,
    version_flag: bool = False,
    no_fix_vertex_area_flag: bool = False,
    allowsubjrep_flag: bool = False,
    allow_zero_dof_flag: bool = False,
    illcond_flag: bool = False,
    sim_done_file: InputPathType | None = None,
    no_sig_double_flag: bool = False,
    runner: Runner | None = None,
) -> MriGlmfitOutputs:
    """
    mri_glmfit
    
    Performs general linear model (GLM) analysis in the volume or the surface.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        y_input: Path to input file where each frame is a separate input.\
            Accepts volume or surface-based formats.
        glmdir: Directory where output will be saved.
        table_input: Use text table as input instead of --y. Table should be of\
            form produced by asegstats2table or aparcstats2table.
        fsgd: Specify the global design matrix with a FreeSurfer Group\
            Descriptor File (FSGDF).
        design_matrix: Explicitly specify the design matrix. Can be in simple\
            text or in matlab4 format.
        contrast_matrix: Specify one or more contrasts to test. File should be\
            ASCII text with the contrast matrix.
        osgm_flag: Construct X and C as a one-sample group mean.
        no_contrasts_ok_flag: Do not fail if no contrasts are specified.
        dti_params: Do DTI analysis using bvals and bvecs.
        dti_matrix: Do DTI analysis using provided matrix.
        pvr: Per-voxel (or vertex) regressors.
        selfreg: Create a 'self-regressor' from the input data based on the\
            waveform at index col row slice.
        wls: Perform weighted least squares (WLS) random effects analysis\
            instead of ordinary least squares (OLS) using yffxvar.
        yffxvar: For fixed effects analysis.
        ffxdof: Degrees of Freedom (DOF) for fixed effects analysis.
        ffxdofdat: Text file with DOF for fixed effects analysis.
        weight: Perform weighted LMS using per-voxel weights from the\
            weightfile.
        weight_inv_flag: Invert weights.
        weight_sqrt_flag: Square root of (inverted) weights.
        fwhm: Smooth input with a Gaussian kernel, specified in mm.
        var_fwhm: Smooth residual variance map with a Gaussian kernel,\
            specified in mm.
        no_mask_smooth_flag: Do not mask when smoothing.
        no_est_fwhm_flag: Turn off FWHM output estimation.
        mask: Binary mask file for analysis.
        label: Use label as mask for surface data.
        no_mask_flag: Do NOT use a mask, same as --no-cortex.
        no_cortex_flag: Do NOT use subjects ?h.cortex.label as --label.
        mask_inv_flag: Invert mask for analysis.
        prune_flag: Remove voxels that do not have a non-zero value at each\
            frame.
        no_prune_flag: Do not prune zero-value voxels.
        logy_flag: Compute natural log of y prior to analysis.
        no_logy_flag: Do not compute natural log of y prior to analysis.
        rm_spatial_mean_flag: Subtract the (masked) mean from each frame.
        yhat_save_flag: Save signal estimate (yhat).
        eres_save_flag: Save residual error (eres).
        eres_scm_flag: Save residual error spatial correlation matrix\
            (eres.scm).
        save_fwhm_map_flag: Save voxel-wise map of FWHM estimates.
        y_out: Save input after any pre-processing.
        surface: Specify that the input has a surface geometry from the\
            hemisphere of the given FreeSurfer subject. Required for surface data\
            operations.
        skew_flag: Compute skew and p-value for skew.
        kurtosis_flag: Compute kurtosis and p-value for kurtosis.
        sim_params: Simulate data for statistical testing. Specify nulltype,\
            number of simulations, threshold and csd basename.
        sim_sign: Specify sign for simulation: abs, pos, or neg.
        uniform_params: Use uniform distribution for mc-full, specify min and\
            max.
        permute_input_flag: Permute input for testing purposes (not related to\
            simulation).
        pca_flag: Perform PCA/SVD analysis on the residual.
        tar1_flag: Compute and save temporal AR1 of residual.
        save_yhat_flag: Flag to save the signal estimate.
        save_cond_flag: Flag to save design matrix condition at each voxel.
        voxdump: Save GLM data for a single voxel at the specified col, row,\
            slice.
        seed: Use seed for random number generation.
        synth_flag: Replace input data with Gaussian noise for testing.
        resynthtest_it: Test GLM by resynthsis with the number of iterations\
            specified.
        profile_it: Test speed with specified number of iterations.
        mrtm1_params: Perform MRTM1 kinetic modeling with specified reference\
            tissue activity and time in seconds.
        mrtm2_params: Perform MRTM2 kinetic modeling with specified parameters.
        logan_params: Perform Logan kinetic modeling with specified parameters.
        bp_clip_neg_flag: Set negative BP voxels to 0.
        bp_clip_max: Set BP voxels above max to max.
        perm_force_flag: Force permutation test, even when design matrix is not\
            orthogonal.
        diag_level: Set diagnostic level.
        diag_cluster_flag: Save significant volume and exit from first\
            simulation loop.
        debug_flag: Turn on debugging mode.
        checkopts_flag: Check options and exit without executing.
        help_flag: Display help information.
        version_flag: Print out version and exit.
        no_fix_vertex_area_flag: Turn off fixing of vertex area (backward\
            compatibility).
        allowsubjrep_flag: Allow subject names to repeat in the fsgd file.
        allow_zero_dof_flag: Allow analyses with zero degrees of freedom.
        illcond_flag: Allow ill-conditioned design matrices.
        sim_done_file: Create done file when simulation finishes.
        no_sig_double_flag: Compute sig = -log10(p) from float p value, not\
            double.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MriGlmfitOutputs`).
    """
    params = mri_glmfit_params(
        glmdir=glmdir,
        y_input=y_input,
        table_input=table_input,
        fsgd=fsgd,
        design_matrix=design_matrix,
        contrast_matrix=contrast_matrix,
        osgm_flag=osgm_flag,
        no_contrasts_ok_flag=no_contrasts_ok_flag,
        dti_params=dti_params,
        dti_matrix=dti_matrix,
        pvr=pvr,
        selfreg=selfreg,
        wls=wls,
        yffxvar=yffxvar,
        ffxdof=ffxdof,
        ffxdofdat=ffxdofdat,
        weight=weight,
        weight_inv_flag=weight_inv_flag,
        weight_sqrt_flag=weight_sqrt_flag,
        fwhm=fwhm,
        var_fwhm=var_fwhm,
        no_mask_smooth_flag=no_mask_smooth_flag,
        no_est_fwhm_flag=no_est_fwhm_flag,
        mask=mask,
        label=label,
        no_mask_flag=no_mask_flag,
        no_cortex_flag=no_cortex_flag,
        mask_inv_flag=mask_inv_flag,
        prune_flag=prune_flag,
        no_prune_flag=no_prune_flag,
        logy_flag=logy_flag,
        no_logy_flag=no_logy_flag,
        rm_spatial_mean_flag=rm_spatial_mean_flag,
        yhat_save_flag=yhat_save_flag,
        eres_save_flag=eres_save_flag,
        eres_scm_flag=eres_scm_flag,
        save_fwhm_map_flag=save_fwhm_map_flag,
        y_out=y_out,
        surface=surface,
        skew_flag=skew_flag,
        kurtosis_flag=kurtosis_flag,
        sim_params=sim_params,
        sim_sign=sim_sign,
        uniform_params=uniform_params,
        permute_input_flag=permute_input_flag,
        pca_flag=pca_flag,
        tar1_flag=tar1_flag,
        save_yhat_flag=save_yhat_flag,
        save_cond_flag=save_cond_flag,
        voxdump=voxdump,
        seed=seed,
        synth_flag=synth_flag,
        resynthtest_it=resynthtest_it,
        profile_it=profile_it,
        mrtm1_params=mrtm1_params,
        mrtm2_params=mrtm2_params,
        logan_params=logan_params,
        bp_clip_neg_flag=bp_clip_neg_flag,
        bp_clip_max=bp_clip_max,
        perm_force_flag=perm_force_flag,
        diag_level=diag_level,
        diag_cluster_flag=diag_cluster_flag,
        debug_flag=debug_flag,
        checkopts_flag=checkopts_flag,
        help_flag=help_flag,
        version_flag=version_flag,
        no_fix_vertex_area_flag=no_fix_vertex_area_flag,
        allowsubjrep_flag=allowsubjrep_flag,
        allow_zero_dof_flag=allow_zero_dof_flag,
        illcond_flag=illcond_flag,
        sim_done_file=sim_done_file,
        no_sig_double_flag=no_sig_double_flag,
    )
    return mri_glmfit_execute(params, runner)


__all__ = [
    "MRI_GLMFIT_METADATA",
    "MriGlmfitOutputs",
    "MriGlmfitParamsDict",
    "MriGlmfitParamsDictTagged",
    "mri_glmfit",
    "mri_glmfit_execute",
    "mri_glmfit_params",
]
