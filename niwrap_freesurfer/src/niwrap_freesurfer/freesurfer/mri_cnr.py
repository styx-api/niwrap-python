# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

MRI_CNR_METADATA = Metadata(
    id="249a13827f999466eba8e033ff312a9ead206a4c.boutiques",
    name="mri_cnr",
    package="freesurfer",
    container_image_tag="freesurfer/freesurfer:7.4.1",
)


_MriCnrParamsDictNoTag = typing.TypedDict('_MriCnrParamsDictNoTag', {
    "surf_dir": str,
    "volume_files": list[InputPathType],
    "slope": typing.NotRequired[list[str] | None],
    "logfile": typing.NotRequired[str | None],
    "labels": typing.NotRequired[list[str] | None],
    "print_total_cnr": bool,
    "version_flag": bool,
    "help_flag": bool,
})
MriCnrParamsDictTagged = typing.TypedDict('MriCnrParamsDictTagged', {
    "@type": typing.Literal["freesurfer/mri_cnr"],
    "surf_dir": str,
    "volume_files": list[InputPathType],
    "slope": typing.NotRequired[list[str] | None],
    "logfile": typing.NotRequired[str | None],
    "labels": typing.NotRequired[list[str] | None],
    "print_total_cnr": bool,
    "version_flag": bool,
    "help_flag": bool,
})
MriCnrParamsDict = _MriCnrParamsDictNoTag | MriCnrParamsDictTagged


class MriCnrOutputs(typing.NamedTuple):
    """
    Output object returned when calling `MriCnrParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""


def mri_cnr_params(
    surf_dir: str,
    volume_files: list[InputPathType],
    slope: list[str] | None = None,
    logfile: str | None = None,
    labels: list[str] | None = None,
    print_total_cnr: bool = False,
    version_flag: bool = False,
    help_flag: bool = False,
) -> MriCnrParamsDictTagged:
    """
    Build parameters.
    
    Args:
        surf_dir: Directory containing surface data.
        volume_files: Volumes to process.
        slope: Compute slope and write to files labeled with slope_fname.\
            Requires four additional values: dist_in, dist_out, step_in, and\
            step_out.
        logfile: Log CNR to specified logfile. Will contain 8 values in a\
            specific order: gray_white_cnr, gray_csf_cnr, white_mean, gray_mean,\
            csf_mean, sqrt(white_var), sqrt(gray_var), sqrt(csf_var).
        labels: Read hemisphere labels from specified left and right hemisphere\
            files.
        print_total_cnr: Print only the total CNR to stdout.
        version_flag: Print software version information and quit.
        help_flag: Print usage information and quit.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "freesurfer/mri_cnr",
        "surf_dir": surf_dir,
        "volume_files": volume_files,
        "print_total_cnr": print_total_cnr,
        "version_flag": version_flag,
        "help_flag": help_flag,
    }
    if slope is not None:
        params["slope"] = slope
    if logfile is not None:
        params["logfile"] = logfile
    if labels is not None:
        params["labels"] = labels
    return params


def mri_cnr_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `MriCnrParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("surf_dir", None) is None:
        raise StyxValidationError("`surf_dir` must not be None")
    if not isinstance(params["surf_dir"], str):
        raise StyxValidationError(f'`surf_dir` has the wrong type: Received `{type(params.get("surf_dir", None))}` expected `str`')
    if params.get("volume_files", None) is None:
        raise StyxValidationError("`volume_files` must not be None")
    if not isinstance(params["volume_files"], list):
        raise StyxValidationError(f'`volume_files` has the wrong type: Received `{type(params.get("volume_files", None))}` expected `list[InputPathType]`')
    for e in params["volume_files"]:
        if not isinstance(e, (pathlib.Path, str)):
            raise StyxValidationError(f'`volume_files` has the wrong type: Received `{type(params.get("volume_files", None))}` expected `list[InputPathType]`')
    if params.get("slope", None) is not None:
        if not isinstance(params["slope"], list):
            raise StyxValidationError(f'`slope` has the wrong type: Received `{type(params.get("slope", None))}` expected `list[str] | None`')
        if len(params["slope"]) != 5:
            raise StyxValidationError("Parameter `slope` must contain exactly 5 elements")
        for e in params["slope"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`slope` has the wrong type: Received `{type(params.get("slope", None))}` expected `list[str] | None`')
    if params.get("logfile", None) is not None:
        if not isinstance(params["logfile"], str):
            raise StyxValidationError(f'`logfile` has the wrong type: Received `{type(params.get("logfile", None))}` expected `str | None`')
    if params.get("labels", None) is not None:
        if not isinstance(params["labels"], list):
            raise StyxValidationError(f'`labels` has the wrong type: Received `{type(params.get("labels", None))}` expected `list[str] | None`')
        if len(params["labels"]) != 2:
            raise StyxValidationError("Parameter `labels` must contain exactly 2 elements")
        for e in params["labels"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`labels` has the wrong type: Received `{type(params.get("labels", None))}` expected `list[str] | None`')
    if params.get("print_total_cnr", False) is None:
        raise StyxValidationError("`print_total_cnr` must not be None")
    if not isinstance(params["print_total_cnr"], bool):
        raise StyxValidationError(f'`print_total_cnr` has the wrong type: Received `{type(params.get("print_total_cnr", False))}` expected `bool`')
    if params.get("version_flag", False) is None:
        raise StyxValidationError("`version_flag` must not be None")
    if not isinstance(params["version_flag"], bool):
        raise StyxValidationError(f'`version_flag` has the wrong type: Received `{type(params.get("version_flag", False))}` expected `bool`')
    if params.get("help_flag", False) is None:
        raise StyxValidationError("`help_flag` must not be None")
    if not isinstance(params["help_flag"], bool):
        raise StyxValidationError(f'`help_flag` has the wrong type: Received `{type(params.get("help_flag", False))}` expected `bool`')


def mri_cnr_cargs(
    params: MriCnrParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("mri_cnr")
    cargs.append(params.get("surf_dir", None))
    cargs.extend([execution.input_file(f) for f in params.get("volume_files", None)])
    if params.get("slope", None) is not None:
        cargs.extend([
            "-s",
            *params.get("slope", None)
        ])
    if params.get("logfile", None) is not None:
        cargs.extend([
            "-l",
            params.get("logfile", None)
        ])
    if params.get("labels", None) is not None:
        cargs.extend([
            "label",
            *params.get("labels", None)
        ])
    if params.get("print_total_cnr", False):
        cargs.append("-t")
    if params.get("version_flag", False):
        cargs.append("-version")
    if params.get("help_flag", False):
        cargs.append("-help")
    return cargs


def mri_cnr_outputs(
    params: MriCnrParamsDict,
    execution: Execution,
) -> MriCnrOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = MriCnrOutputs(
        root=execution.output_file("."),
    )
    return ret


def mri_cnr_execute(
    params: MriCnrParamsDict,
    runner: Runner | None = None,
) -> MriCnrOutputs:
    """
    mri_cnr
    
    Compute the gray/white/csf contrast-to-noise ratio for volumes using
    FreeSurfer.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MriCnrOutputs`).
    """
    mri_cnr_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(MRI_CNR_METADATA)
    params = execution.params(params)
    cargs = mri_cnr_cargs(params, execution)
    ret = mri_cnr_outputs(params, execution)
    execution.run(cargs)
    return ret


def mri_cnr(
    surf_dir: str,
    volume_files: list[InputPathType],
    slope: list[str] | None = None,
    logfile: str | None = None,
    labels: list[str] | None = None,
    print_total_cnr: bool = False,
    version_flag: bool = False,
    help_flag: bool = False,
    runner: Runner | None = None,
) -> MriCnrOutputs:
    """
    mri_cnr
    
    Compute the gray/white/csf contrast-to-noise ratio for volumes using
    FreeSurfer.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        surf_dir: Directory containing surface data.
        volume_files: Volumes to process.
        slope: Compute slope and write to files labeled with slope_fname.\
            Requires four additional values: dist_in, dist_out, step_in, and\
            step_out.
        logfile: Log CNR to specified logfile. Will contain 8 values in a\
            specific order: gray_white_cnr, gray_csf_cnr, white_mean, gray_mean,\
            csf_mean, sqrt(white_var), sqrt(gray_var), sqrt(csf_var).
        labels: Read hemisphere labels from specified left and right hemisphere\
            files.
        print_total_cnr: Print only the total CNR to stdout.
        version_flag: Print software version information and quit.
        help_flag: Print usage information and quit.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MriCnrOutputs`).
    """
    params = mri_cnr_params(
        surf_dir=surf_dir,
        volume_files=volume_files,
        slope=slope,
        logfile=logfile,
        labels=labels,
        print_total_cnr=print_total_cnr,
        version_flag=version_flag,
        help_flag=help_flag,
    )
    return mri_cnr_execute(params, runner)


__all__ = [
    "MRI_CNR_METADATA",
    "MriCnrOutputs",
    "MriCnrParamsDict",
    "MriCnrParamsDictTagged",
    "mri_cnr",
    "mri_cnr_execute",
    "mri_cnr_params",
]
