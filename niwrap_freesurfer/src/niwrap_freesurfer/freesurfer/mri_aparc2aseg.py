# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

MRI_APARC2ASEG_METADATA = Metadata(
    id="dc941a2089f873008413fb964e54b8f35532e9b7.boutiques",
    name="mri_aparc2aseg",
    package="freesurfer",
    container_image_tag="freesurfer/freesurfer:7.4.1",
)


_MriAparc2asegParamsDictNoTag = typing.TypedDict('_MriAparc2asegParamsDictNoTag', {
    "subject": typing.NotRequired[str | None],
    "output_volfile": typing.NotRequired[str | None],
    "old_ribbon": bool,
    "new_ribbon": bool,
    "a2005s": bool,
    "a2009s": bool,
    "annot_name": typing.NotRequired[str | None],
    "annot_table": typing.NotRequired[str | None],
    "base_offset": typing.NotRequired[float | None],
    "label_wm": bool,
    "wmparc_dmax": typing.NotRequired[float | None],
    "rip_unknown": bool,
    "hypo_as_wm": bool,
    "no_fix_parahip": bool,
    "smooth_normals": typing.NotRequired[float | None],
    "crs_test": typing.NotRequired[str | None],
    "left_hemisphere": bool,
    "right_hemisphere": bool,
    "threads": typing.NotRequired[float | None],
    "help": bool,
    "version": bool,
})
MriAparc2asegParamsDictTagged = typing.TypedDict('MriAparc2asegParamsDictTagged', {
    "@type": typing.Literal["freesurfer/mri_aparc2aseg"],
    "subject": typing.NotRequired[str | None],
    "output_volfile": typing.NotRequired[str | None],
    "old_ribbon": bool,
    "new_ribbon": bool,
    "a2005s": bool,
    "a2009s": bool,
    "annot_name": typing.NotRequired[str | None],
    "annot_table": typing.NotRequired[str | None],
    "base_offset": typing.NotRequired[float | None],
    "label_wm": bool,
    "wmparc_dmax": typing.NotRequired[float | None],
    "rip_unknown": bool,
    "hypo_as_wm": bool,
    "no_fix_parahip": bool,
    "smooth_normals": typing.NotRequired[float | None],
    "crs_test": typing.NotRequired[str | None],
    "left_hemisphere": bool,
    "right_hemisphere": bool,
    "threads": typing.NotRequired[float | None],
    "help": bool,
    "version": bool,
})
MriAparc2asegParamsDict = _MriAparc2asegParamsDictNoTag | MriAparc2asegParamsDictTagged


class MriAparc2asegOutputs(typing.NamedTuple):
    """
    Output object returned when calling `MriAparc2asegParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    output_volume: OutputPathType
    """Output segmentation volume."""


def mri_aparc2aseg_params(
    subject: str | None = None,
    output_volfile: str | None = None,
    old_ribbon: bool = False,
    new_ribbon: bool = False,
    a2005s: bool = False,
    a2009s: bool = False,
    annot_name: str | None = None,
    annot_table: str | None = None,
    base_offset: float | None = None,
    label_wm: bool = False,
    wmparc_dmax: float | None = None,
    rip_unknown: bool = False,
    hypo_as_wm: bool = False,
    no_fix_parahip: bool = False,
    smooth_normals: float | None = None,
    crs_test: str | None = None,
    left_hemisphere: bool = False,
    right_hemisphere: bool = False,
    threads: float | None = None,
    help_: bool = False,
    version: bool = False,
) -> MriAparc2asegParamsDictTagged:
    """
    Build parameters.
    
    Args:
        subject: Name of the subject as found in the SUBJECTS_DIR.
        output_volfile: Full path of file to save the output segmentation in.\
            Default is mri/aparc+aseg.mgz.
        old_ribbon: Use mri/hemi.ribbon.mgz as a mask for the cortex.
        new_ribbon: Mask cortical voxels with mri/ribbon.mgz. Same as --volmask.
        a2005s: Use ?h.aparc.a2005s.annot. Output will be\
            aparc.a2005s+aseg.mgz.
        a2009s: Use ?h.aparc.a2009s.annot. Output will be\
            aparc.a2009s+aseg.mgz.
        annot_name: Use annotname surface annotation. By default, uses\
            ?h.aparc.annot.
        annot_table: Annotation table file. Default is\
            $FREESURFER_HOME/Simple_surface_labels2009.txt.
        base_offset: Add offset to all segmentation ids.
        label_wm: Re-assign white matter voxel labels to the closest cortical\
            point if within distance.
        wmparc_dmax: Max distance (mm) from cortex to be labeled as gyral WM\
            (default 5mm).
        rip_unknown: Do not label WM based on 'unknown' cortical label.
        hypo_as_wm: Label hypointensities as WM.
        no_fix_parahip: Do not remove unconnected regions from WM parahip.
        smooth_normals: Change number of surface normal smoothing steps\
            (default is 10).
        crs_test: Test mapping of column, row, slice.
        left_hemisphere: Only process the left hemisphere.
        right_hemisphere: Only process the right hemisphere.
        threads: Run in parallel with the specified number of threads.
        help_: Print out information on how to use this program.
        version: Print out version and exit.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "freesurfer/mri_aparc2aseg",
        "old_ribbon": old_ribbon,
        "new_ribbon": new_ribbon,
        "a2005s": a2005s,
        "a2009s": a2009s,
        "label_wm": label_wm,
        "rip_unknown": rip_unknown,
        "hypo_as_wm": hypo_as_wm,
        "no_fix_parahip": no_fix_parahip,
        "left_hemisphere": left_hemisphere,
        "right_hemisphere": right_hemisphere,
        "help": help_,
        "version": version,
    }
    if subject is not None:
        params["subject"] = subject
    if output_volfile is not None:
        params["output_volfile"] = output_volfile
    if annot_name is not None:
        params["annot_name"] = annot_name
    if annot_table is not None:
        params["annot_table"] = annot_table
    if base_offset is not None:
        params["base_offset"] = base_offset
    if wmparc_dmax is not None:
        params["wmparc_dmax"] = wmparc_dmax
    if smooth_normals is not None:
        params["smooth_normals"] = smooth_normals
    if crs_test is not None:
        params["crs_test"] = crs_test
    if threads is not None:
        params["threads"] = threads
    return params


def mri_aparc2aseg_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `MriAparc2asegParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("subject", None) is not None:
        if not isinstance(params["subject"], str):
            raise StyxValidationError(f'`subject` has the wrong type: Received `{type(params.get("subject", None))}` expected `str | None`')
    if params.get("output_volfile", None) is not None:
        if not isinstance(params["output_volfile"], str):
            raise StyxValidationError(f'`output_volfile` has the wrong type: Received `{type(params.get("output_volfile", None))}` expected `str | None`')
    if params.get("old_ribbon", False) is None:
        raise StyxValidationError("`old_ribbon` must not be None")
    if not isinstance(params["old_ribbon"], bool):
        raise StyxValidationError(f'`old_ribbon` has the wrong type: Received `{type(params.get("old_ribbon", False))}` expected `bool`')
    if params.get("new_ribbon", False) is None:
        raise StyxValidationError("`new_ribbon` must not be None")
    if not isinstance(params["new_ribbon"], bool):
        raise StyxValidationError(f'`new_ribbon` has the wrong type: Received `{type(params.get("new_ribbon", False))}` expected `bool`')
    if params.get("a2005s", False) is None:
        raise StyxValidationError("`a2005s` must not be None")
    if not isinstance(params["a2005s"], bool):
        raise StyxValidationError(f'`a2005s` has the wrong type: Received `{type(params.get("a2005s", False))}` expected `bool`')
    if params.get("a2009s", False) is None:
        raise StyxValidationError("`a2009s` must not be None")
    if not isinstance(params["a2009s"], bool):
        raise StyxValidationError(f'`a2009s` has the wrong type: Received `{type(params.get("a2009s", False))}` expected `bool`')
    if params.get("annot_name", None) is not None:
        if not isinstance(params["annot_name"], str):
            raise StyxValidationError(f'`annot_name` has the wrong type: Received `{type(params.get("annot_name", None))}` expected `str | None`')
    if params.get("annot_table", None) is not None:
        if not isinstance(params["annot_table"], str):
            raise StyxValidationError(f'`annot_table` has the wrong type: Received `{type(params.get("annot_table", None))}` expected `str | None`')
    if params.get("base_offset", None) is not None:
        if not isinstance(params["base_offset"], (float, int)):
            raise StyxValidationError(f'`base_offset` has the wrong type: Received `{type(params.get("base_offset", None))}` expected `float | None`')
    if params.get("label_wm", False) is None:
        raise StyxValidationError("`label_wm` must not be None")
    if not isinstance(params["label_wm"], bool):
        raise StyxValidationError(f'`label_wm` has the wrong type: Received `{type(params.get("label_wm", False))}` expected `bool`')
    if params.get("wmparc_dmax", None) is not None:
        if not isinstance(params["wmparc_dmax"], (float, int)):
            raise StyxValidationError(f'`wmparc_dmax` has the wrong type: Received `{type(params.get("wmparc_dmax", None))}` expected `float | None`')
    if params.get("rip_unknown", False) is None:
        raise StyxValidationError("`rip_unknown` must not be None")
    if not isinstance(params["rip_unknown"], bool):
        raise StyxValidationError(f'`rip_unknown` has the wrong type: Received `{type(params.get("rip_unknown", False))}` expected `bool`')
    if params.get("hypo_as_wm", False) is None:
        raise StyxValidationError("`hypo_as_wm` must not be None")
    if not isinstance(params["hypo_as_wm"], bool):
        raise StyxValidationError(f'`hypo_as_wm` has the wrong type: Received `{type(params.get("hypo_as_wm", False))}` expected `bool`')
    if params.get("no_fix_parahip", False) is None:
        raise StyxValidationError("`no_fix_parahip` must not be None")
    if not isinstance(params["no_fix_parahip"], bool):
        raise StyxValidationError(f'`no_fix_parahip` has the wrong type: Received `{type(params.get("no_fix_parahip", False))}` expected `bool`')
    if params.get("smooth_normals", None) is not None:
        if not isinstance(params["smooth_normals"], (float, int)):
            raise StyxValidationError(f'`smooth_normals` has the wrong type: Received `{type(params.get("smooth_normals", None))}` expected `float | None`')
    if params.get("crs_test", None) is not None:
        if not isinstance(params["crs_test"], str):
            raise StyxValidationError(f'`crs_test` has the wrong type: Received `{type(params.get("crs_test", None))}` expected `str | None`')
    if params.get("left_hemisphere", False) is None:
        raise StyxValidationError("`left_hemisphere` must not be None")
    if not isinstance(params["left_hemisphere"], bool):
        raise StyxValidationError(f'`left_hemisphere` has the wrong type: Received `{type(params.get("left_hemisphere", False))}` expected `bool`')
    if params.get("right_hemisphere", False) is None:
        raise StyxValidationError("`right_hemisphere` must not be None")
    if not isinstance(params["right_hemisphere"], bool):
        raise StyxValidationError(f'`right_hemisphere` has the wrong type: Received `{type(params.get("right_hemisphere", False))}` expected `bool`')
    if params.get("threads", None) is not None:
        if not isinstance(params["threads"], (float, int)):
            raise StyxValidationError(f'`threads` has the wrong type: Received `{type(params.get("threads", None))}` expected `float | None`')
    if params.get("help", False) is None:
        raise StyxValidationError("`help` must not be None")
    if not isinstance(params["help"], bool):
        raise StyxValidationError(f'`help` has the wrong type: Received `{type(params.get("help", False))}` expected `bool`')
    if params.get("version", False) is None:
        raise StyxValidationError("`version` must not be None")
    if not isinstance(params["version"], bool):
        raise StyxValidationError(f'`version` has the wrong type: Received `{type(params.get("version", False))}` expected `bool`')


def mri_aparc2aseg_cargs(
    params: MriAparc2asegParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("mri_aparc2aseg")
    if params.get("subject", None) is not None:
        cargs.extend([
            "--s",
            params.get("subject", None)
        ])
    if params.get("output_volfile", None) is not None:
        cargs.extend([
            "--o",
            params.get("output_volfile", None)
        ])
    if params.get("old_ribbon", False):
        cargs.append("--old-ribbon")
    if params.get("new_ribbon", False):
        cargs.append("--new-ribbon")
    if params.get("a2005s", False):
        cargs.append("--a2005s")
    if params.get("a2009s", False):
        cargs.append("--a2009s")
    if params.get("annot_name", None) is not None:
        cargs.extend([
            "--annot",
            params.get("annot_name", None)
        ])
    if params.get("annot_table", None) is not None:
        cargs.extend([
            "--annot-table",
            params.get("annot_table", None)
        ])
    if params.get("base_offset", None) is not None:
        cargs.extend([
            "--base-offset",
            str(params.get("base_offset", None))
        ])
    if params.get("label_wm", False):
        cargs.append("--labelwm")
    if params.get("wmparc_dmax", None) is not None:
        cargs.extend([
            "--wmparc-dmax",
            str(params.get("wmparc_dmax", None))
        ])
    if params.get("rip_unknown", False):
        cargs.append("--rip-unknown")
    if params.get("hypo_as_wm", False):
        cargs.append("--hypo-as-wm")
    if params.get("no_fix_parahip", False):
        cargs.append("--no-fix-parahip")
    if params.get("smooth_normals", None) is not None:
        cargs.extend([
            "--smooth_normals",
            str(params.get("smooth_normals", None))
        ])
    if params.get("crs_test", None) is not None:
        cargs.extend([
            "--crs-test",
            params.get("crs_test", None)
        ])
    if params.get("left_hemisphere", False):
        cargs.append("--lh")
    if params.get("right_hemisphere", False):
        cargs.append("--rh")
    if params.get("threads", None) is not None:
        cargs.extend([
            "--threads",
            str(params.get("threads", None))
        ])
    if params.get("help", False):
        cargs.append("--help")
    if params.get("version", False):
        cargs.append("--version")
    return cargs


def mri_aparc2aseg_outputs(
    params: MriAparc2asegParamsDict,
    execution: Execution,
) -> MriAparc2asegOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = MriAparc2asegOutputs(
        root=execution.output_file("."),
        output_volume=execution.output_file("mri/aparc+aseg.mgz"),
    )
    return ret


def mri_aparc2aseg_execute(
    params: MriAparc2asegParamsDict,
    runner: Runner | None = None,
) -> MriAparc2asegOutputs:
    """
    mri_aparc2aseg
    
    Maps the cortical labels from the automatic cortical parcellation to the
    automatic segmentation volume.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MriAparc2asegOutputs`).
    """
    mri_aparc2aseg_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(MRI_APARC2ASEG_METADATA)
    params = execution.params(params)
    cargs = mri_aparc2aseg_cargs(params, execution)
    ret = mri_aparc2aseg_outputs(params, execution)
    execution.run(cargs)
    return ret


def mri_aparc2aseg(
    subject: str | None = None,
    output_volfile: str | None = None,
    old_ribbon: bool = False,
    new_ribbon: bool = False,
    a2005s: bool = False,
    a2009s: bool = False,
    annot_name: str | None = None,
    annot_table: str | None = None,
    base_offset: float | None = None,
    label_wm: bool = False,
    wmparc_dmax: float | None = None,
    rip_unknown: bool = False,
    hypo_as_wm: bool = False,
    no_fix_parahip: bool = False,
    smooth_normals: float | None = None,
    crs_test: str | None = None,
    left_hemisphere: bool = False,
    right_hemisphere: bool = False,
    threads: float | None = None,
    help_: bool = False,
    version: bool = False,
    runner: Runner | None = None,
) -> MriAparc2asegOutputs:
    """
    mri_aparc2aseg
    
    Maps the cortical labels from the automatic cortical parcellation to the
    automatic segmentation volume.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        subject: Name of the subject as found in the SUBJECTS_DIR.
        output_volfile: Full path of file to save the output segmentation in.\
            Default is mri/aparc+aseg.mgz.
        old_ribbon: Use mri/hemi.ribbon.mgz as a mask for the cortex.
        new_ribbon: Mask cortical voxels with mri/ribbon.mgz. Same as --volmask.
        a2005s: Use ?h.aparc.a2005s.annot. Output will be\
            aparc.a2005s+aseg.mgz.
        a2009s: Use ?h.aparc.a2009s.annot. Output will be\
            aparc.a2009s+aseg.mgz.
        annot_name: Use annotname surface annotation. By default, uses\
            ?h.aparc.annot.
        annot_table: Annotation table file. Default is\
            $FREESURFER_HOME/Simple_surface_labels2009.txt.
        base_offset: Add offset to all segmentation ids.
        label_wm: Re-assign white matter voxel labels to the closest cortical\
            point if within distance.
        wmparc_dmax: Max distance (mm) from cortex to be labeled as gyral WM\
            (default 5mm).
        rip_unknown: Do not label WM based on 'unknown' cortical label.
        hypo_as_wm: Label hypointensities as WM.
        no_fix_parahip: Do not remove unconnected regions from WM parahip.
        smooth_normals: Change number of surface normal smoothing steps\
            (default is 10).
        crs_test: Test mapping of column, row, slice.
        left_hemisphere: Only process the left hemisphere.
        right_hemisphere: Only process the right hemisphere.
        threads: Run in parallel with the specified number of threads.
        help_: Print out information on how to use this program.
        version: Print out version and exit.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MriAparc2asegOutputs`).
    """
    params = mri_aparc2aseg_params(
        subject=subject,
        output_volfile=output_volfile,
        old_ribbon=old_ribbon,
        new_ribbon=new_ribbon,
        a2005s=a2005s,
        a2009s=a2009s,
        annot_name=annot_name,
        annot_table=annot_table,
        base_offset=base_offset,
        label_wm=label_wm,
        wmparc_dmax=wmparc_dmax,
        rip_unknown=rip_unknown,
        hypo_as_wm=hypo_as_wm,
        no_fix_parahip=no_fix_parahip,
        smooth_normals=smooth_normals,
        crs_test=crs_test,
        left_hemisphere=left_hemisphere,
        right_hemisphere=right_hemisphere,
        threads=threads,
        help_=help_,
        version=version,
    )
    return mri_aparc2aseg_execute(params, runner)


__all__ = [
    "MRI_APARC2ASEG_METADATA",
    "MriAparc2asegOutputs",
    "MriAparc2asegParamsDict",
    "MriAparc2asegParamsDictTagged",
    "mri_aparc2aseg",
    "mri_aparc2aseg_execute",
    "mri_aparc2aseg_params",
]
