# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

MKHEADSURF_METADATA = Metadata(
    id="1cfc94620745a88f35a5393a7c822c27660f72fa.boutiques",
    name="mkheadsurf",
    package="freesurfer",
    container_image_tag="freesurfer/freesurfer:7.4.1",
)


_MkheadsurfParamsDictNoTag = typing.TypedDict('_MkheadsurfParamsDictNoTag', {
    "input_vol": InputPathType,
    "output_vol": str,
    "output_surf": str,
    "subject_id": str,
    "nsmooth": typing.NotRequired[float | None],
    "noseghead": bool,
    "thresh1": typing.NotRequired[float | None],
    "thresh2": typing.NotRequired[float | None],
    "nhitsmin": typing.NotRequired[float | None],
    "ndilate": typing.NotRequired[float | None],
    "nerode": typing.NotRequired[float | None],
    "fillval": typing.NotRequired[float | None],
    "fhi": typing.NotRequired[float | None],
    "no_rescale": bool,
    "no_fill_holes_islands": bool,
    "or_mask": typing.NotRequired[InputPathType | None],
    "tessellation_method": typing.NotRequired[str | None],
    "inflate": bool,
    "curv": bool,
    "srcvol": typing.NotRequired[str | None],
    "headvol": typing.NotRequired[str | None],
    "headsurf": typing.NotRequired[str | None],
    "smheadsurf": typing.NotRequired[str | None],
    "hemi": typing.NotRequired[str | None],
    "subjects_dir": typing.NotRequired[str | None],
    "umask": typing.NotRequired[float | None],
    "logfile": typing.NotRequired[str | None],
})
MkheadsurfParamsDictTagged = typing.TypedDict('MkheadsurfParamsDictTagged', {
    "@type": typing.Literal["freesurfer/mkheadsurf"],
    "input_vol": InputPathType,
    "output_vol": str,
    "output_surf": str,
    "subject_id": str,
    "nsmooth": typing.NotRequired[float | None],
    "noseghead": bool,
    "thresh1": typing.NotRequired[float | None],
    "thresh2": typing.NotRequired[float | None],
    "nhitsmin": typing.NotRequired[float | None],
    "ndilate": typing.NotRequired[float | None],
    "nerode": typing.NotRequired[float | None],
    "fillval": typing.NotRequired[float | None],
    "fhi": typing.NotRequired[float | None],
    "no_rescale": bool,
    "no_fill_holes_islands": bool,
    "or_mask": typing.NotRequired[InputPathType | None],
    "tessellation_method": typing.NotRequired[str | None],
    "inflate": bool,
    "curv": bool,
    "srcvol": typing.NotRequired[str | None],
    "headvol": typing.NotRequired[str | None],
    "headsurf": typing.NotRequired[str | None],
    "smheadsurf": typing.NotRequired[str | None],
    "hemi": typing.NotRequired[str | None],
    "subjects_dir": typing.NotRequired[str | None],
    "umask": typing.NotRequired[float | None],
    "logfile": typing.NotRequired[str | None],
})
MkheadsurfParamsDict = _MkheadsurfParamsDictNoTag | MkheadsurfParamsDictTagged


class MkheadsurfOutputs(typing.NamedTuple):
    """
    Output object returned when calling `MkheadsurfParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""


def mkheadsurf_params(
    input_vol: InputPathType,
    output_vol: str,
    output_surf: str,
    subject_id: str,
    nsmooth: float | None = None,
    noseghead: bool = False,
    thresh1: float | None = None,
    thresh2: float | None = None,
    nhitsmin: float | None = None,
    ndilate: float | None = None,
    nerode: float | None = None,
    fillval: float | None = None,
    fhi: float | None = None,
    no_rescale: bool = False,
    no_fill_holes_islands: bool = False,
    or_mask: InputPathType | None = None,
    tessellation_method: str | None = None,
    inflate: bool = False,
    curv: bool = False,
    srcvol: str | None = None,
    headvol: str | None = None,
    headsurf: str | None = None,
    smheadsurf: str | None = None,
    hemi: str | None = None,
    subjects_dir: str | None = None,
    umask: float | None = None,
    logfile: str | None = None,
) -> MkheadsurfParamsDictTagged:
    """
    Build parameters.
    
    Args:
        input_vol: Input volume.
        output_vol: Output volume.
        output_surf: Output surface.
        subject_id: Subject ID.
        nsmooth: Number of smoothing iterations (default 10).
        noseghead: Do not segment the head, only tessellate and smooth existing.
        thresh1: Threshold 1 value (default 20).
        thresh2: Threshold 2 value (default 20).
        nhitsmin: Minimum number of hits (default 2).
        ndilate: Number of dilations (default 0).
        nerode: Number of erosions (default 0).
        fillval: Fill value (default 1).
        fhi: FHI for MRIchangeType; default is to use default in mri_seghead.
        no_rescale: Do not rescale input when converting to uchar.
        no_fill_holes_islands: Do not fill holes and remove islands.
        or_mask: Include all voxels in ormask in the head seg.
        tessellation_method: Tessellation method using mri_tessellate or mri_mc\
            (default is -mc).
        inflate: Inflate and compute sulc.
        curv: Compute curv with smoothing.
        srcvol: Source volume ID (default is T1).
        headvol: Head volume ID (default is seghead).
        headsurf: Head surface ID (default is seghead).
        smheadsurf: Smoothed head surface ID (default is smseghead).
        hemi: Hemisphere (default is lh).
        subjects_dir: Subjects directory (default is SUBJECTS_DIR).
        umask: Umask setting (default is 2).
        logfile: Log file.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "freesurfer/mkheadsurf",
        "input_vol": input_vol,
        "output_vol": output_vol,
        "output_surf": output_surf,
        "subject_id": subject_id,
        "noseghead": noseghead,
        "no_rescale": no_rescale,
        "no_fill_holes_islands": no_fill_holes_islands,
        "inflate": inflate,
        "curv": curv,
    }
    if nsmooth is not None:
        params["nsmooth"] = nsmooth
    if thresh1 is not None:
        params["thresh1"] = thresh1
    if thresh2 is not None:
        params["thresh2"] = thresh2
    if nhitsmin is not None:
        params["nhitsmin"] = nhitsmin
    if ndilate is not None:
        params["ndilate"] = ndilate
    if nerode is not None:
        params["nerode"] = nerode
    if fillval is not None:
        params["fillval"] = fillval
    if fhi is not None:
        params["fhi"] = fhi
    if or_mask is not None:
        params["or_mask"] = or_mask
    if tessellation_method is not None:
        params["tessellation_method"] = tessellation_method
    if srcvol is not None:
        params["srcvol"] = srcvol
    if headvol is not None:
        params["headvol"] = headvol
    if headsurf is not None:
        params["headsurf"] = headsurf
    if smheadsurf is not None:
        params["smheadsurf"] = smheadsurf
    if hemi is not None:
        params["hemi"] = hemi
    if subjects_dir is not None:
        params["subjects_dir"] = subjects_dir
    if umask is not None:
        params["umask"] = umask
    if logfile is not None:
        params["logfile"] = logfile
    return params


def mkheadsurf_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `MkheadsurfParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("input_vol", None) is None:
        raise StyxValidationError("`input_vol` must not be None")
    if not isinstance(params["input_vol"], (pathlib.Path, str)):
        raise StyxValidationError(f'`input_vol` has the wrong type: Received `{type(params.get("input_vol", None))}` expected `InputPathType`')
    if params.get("output_vol", None) is None:
        raise StyxValidationError("`output_vol` must not be None")
    if not isinstance(params["output_vol"], str):
        raise StyxValidationError(f'`output_vol` has the wrong type: Received `{type(params.get("output_vol", None))}` expected `str`')
    if params.get("output_surf", None) is None:
        raise StyxValidationError("`output_surf` must not be None")
    if not isinstance(params["output_surf"], str):
        raise StyxValidationError(f'`output_surf` has the wrong type: Received `{type(params.get("output_surf", None))}` expected `str`')
    if params.get("subject_id", None) is None:
        raise StyxValidationError("`subject_id` must not be None")
    if not isinstance(params["subject_id"], str):
        raise StyxValidationError(f'`subject_id` has the wrong type: Received `{type(params.get("subject_id", None))}` expected `str`')
    if params.get("nsmooth", None) is not None:
        if not isinstance(params["nsmooth"], (float, int)):
            raise StyxValidationError(f'`nsmooth` has the wrong type: Received `{type(params.get("nsmooth", None))}` expected `float | None`')
    if params.get("noseghead", False) is None:
        raise StyxValidationError("`noseghead` must not be None")
    if not isinstance(params["noseghead"], bool):
        raise StyxValidationError(f'`noseghead` has the wrong type: Received `{type(params.get("noseghead", False))}` expected `bool`')
    if params.get("thresh1", None) is not None:
        if not isinstance(params["thresh1"], (float, int)):
            raise StyxValidationError(f'`thresh1` has the wrong type: Received `{type(params.get("thresh1", None))}` expected `float | None`')
    if params.get("thresh2", None) is not None:
        if not isinstance(params["thresh2"], (float, int)):
            raise StyxValidationError(f'`thresh2` has the wrong type: Received `{type(params.get("thresh2", None))}` expected `float | None`')
    if params.get("nhitsmin", None) is not None:
        if not isinstance(params["nhitsmin"], (float, int)):
            raise StyxValidationError(f'`nhitsmin` has the wrong type: Received `{type(params.get("nhitsmin", None))}` expected `float | None`')
    if params.get("ndilate", None) is not None:
        if not isinstance(params["ndilate"], (float, int)):
            raise StyxValidationError(f'`ndilate` has the wrong type: Received `{type(params.get("ndilate", None))}` expected `float | None`')
    if params.get("nerode", None) is not None:
        if not isinstance(params["nerode"], (float, int)):
            raise StyxValidationError(f'`nerode` has the wrong type: Received `{type(params.get("nerode", None))}` expected `float | None`')
    if params.get("fillval", None) is not None:
        if not isinstance(params["fillval"], (float, int)):
            raise StyxValidationError(f'`fillval` has the wrong type: Received `{type(params.get("fillval", None))}` expected `float | None`')
    if params.get("fhi", None) is not None:
        if not isinstance(params["fhi"], (float, int)):
            raise StyxValidationError(f'`fhi` has the wrong type: Received `{type(params.get("fhi", None))}` expected `float | None`')
    if params.get("no_rescale", False) is None:
        raise StyxValidationError("`no_rescale` must not be None")
    if not isinstance(params["no_rescale"], bool):
        raise StyxValidationError(f'`no_rescale` has the wrong type: Received `{type(params.get("no_rescale", False))}` expected `bool`')
    if params.get("no_fill_holes_islands", False) is None:
        raise StyxValidationError("`no_fill_holes_islands` must not be None")
    if not isinstance(params["no_fill_holes_islands"], bool):
        raise StyxValidationError(f'`no_fill_holes_islands` has the wrong type: Received `{type(params.get("no_fill_holes_islands", False))}` expected `bool`')
    if params.get("or_mask", None) is not None:
        if not isinstance(params["or_mask"], (pathlib.Path, str)):
            raise StyxValidationError(f'`or_mask` has the wrong type: Received `{type(params.get("or_mask", None))}` expected `InputPathType | None`')
    if params.get("tessellation_method", None) is not None:
        if not isinstance(params["tessellation_method"], str):
            raise StyxValidationError(f'`tessellation_method` has the wrong type: Received `{type(params.get("tessellation_method", None))}` expected `str | None`')
    if params.get("inflate", False) is None:
        raise StyxValidationError("`inflate` must not be None")
    if not isinstance(params["inflate"], bool):
        raise StyxValidationError(f'`inflate` has the wrong type: Received `{type(params.get("inflate", False))}` expected `bool`')
    if params.get("curv", False) is None:
        raise StyxValidationError("`curv` must not be None")
    if not isinstance(params["curv"], bool):
        raise StyxValidationError(f'`curv` has the wrong type: Received `{type(params.get("curv", False))}` expected `bool`')
    if params.get("srcvol", None) is not None:
        if not isinstance(params["srcvol"], str):
            raise StyxValidationError(f'`srcvol` has the wrong type: Received `{type(params.get("srcvol", None))}` expected `str | None`')
    if params.get("headvol", None) is not None:
        if not isinstance(params["headvol"], str):
            raise StyxValidationError(f'`headvol` has the wrong type: Received `{type(params.get("headvol", None))}` expected `str | None`')
    if params.get("headsurf", None) is not None:
        if not isinstance(params["headsurf"], str):
            raise StyxValidationError(f'`headsurf` has the wrong type: Received `{type(params.get("headsurf", None))}` expected `str | None`')
    if params.get("smheadsurf", None) is not None:
        if not isinstance(params["smheadsurf"], str):
            raise StyxValidationError(f'`smheadsurf` has the wrong type: Received `{type(params.get("smheadsurf", None))}` expected `str | None`')
    if params.get("hemi", None) is not None:
        if not isinstance(params["hemi"], str):
            raise StyxValidationError(f'`hemi` has the wrong type: Received `{type(params.get("hemi", None))}` expected `str | None`')
    if params.get("subjects_dir", None) is not None:
        if not isinstance(params["subjects_dir"], str):
            raise StyxValidationError(f'`subjects_dir` has the wrong type: Received `{type(params.get("subjects_dir", None))}` expected `str | None`')
    if params.get("umask", None) is not None:
        if not isinstance(params["umask"], (float, int)):
            raise StyxValidationError(f'`umask` has the wrong type: Received `{type(params.get("umask", None))}` expected `float | None`')
    if params.get("logfile", None) is not None:
        if not isinstance(params["logfile"], str):
            raise StyxValidationError(f'`logfile` has the wrong type: Received `{type(params.get("logfile", None))}` expected `str | None`')


def mkheadsurf_cargs(
    params: MkheadsurfParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("mkheadsurf")
    cargs.extend([
        "-i",
        execution.input_file(params.get("input_vol", None))
    ])
    cargs.extend([
        "-o",
        params.get("output_vol", None)
    ])
    cargs.extend([
        "-surf",
        params.get("output_surf", None)
    ])
    cargs.extend([
        "-s",
        params.get("subject_id", None)
    ])
    if params.get("nsmooth", None) is not None:
        cargs.extend([
            "-nsmooth",
            str(params.get("nsmooth", None))
        ])
    if params.get("noseghead", False):
        cargs.append("-noseghead")
    if params.get("thresh1", None) is not None:
        cargs.extend([
            "-thresh1",
            str(params.get("thresh1", None))
        ])
    if params.get("thresh2", None) is not None:
        cargs.extend([
            "-thresh2",
            str(params.get("thresh2", None))
        ])
    if params.get("nhitsmin", None) is not None:
        cargs.extend([
            "-nhitsmin",
            str(params.get("nhitsmin", None))
        ])
    if params.get("ndilate", None) is not None:
        cargs.extend([
            "-ndilate",
            str(params.get("ndilate", None))
        ])
    if params.get("nerode", None) is not None:
        cargs.extend([
            "-nerode",
            str(params.get("nerode", None))
        ])
    if params.get("fillval", None) is not None:
        cargs.extend([
            "-fillval",
            str(params.get("fillval", None))
        ])
    if params.get("fhi", None) is not None:
        cargs.extend([
            "-fhi",
            str(params.get("fhi", None))
        ])
    if params.get("no_rescale", False):
        cargs.append("-no-rescale")
    if params.get("no_fill_holes_islands", False):
        cargs.append("-no-fill-holes-islands")
    if params.get("or_mask", None) is not None:
        cargs.extend([
            "-or-mask",
            execution.input_file(params.get("or_mask", None))
        ])
    if params.get("tessellation_method", None) is not None:
        cargs.extend([
            "-tess",
            params.get("tessellation_method", None)
        ])
    if params.get("inflate", False):
        cargs.append("-inflate")
    if params.get("curv", False):
        cargs.append("-curv")
    if params.get("srcvol", None) is not None:
        cargs.extend([
            "-srcvol",
            params.get("srcvol", None)
        ])
    if params.get("headvol", None) is not None:
        cargs.extend([
            "-headvol",
            params.get("headvol", None)
        ])
    if params.get("headsurf", None) is not None:
        cargs.extend([
            "-headsurf",
            params.get("headsurf", None)
        ])
    if params.get("smheadsurf", None) is not None:
        cargs.extend([
            "-smheadsurf",
            params.get("smheadsurf", None)
        ])
    if params.get("hemi", None) is not None:
        cargs.extend([
            "-hemi",
            params.get("hemi", None)
        ])
    if params.get("subjects_dir", None) is not None:
        cargs.extend([
            "-sd",
            params.get("subjects_dir", None)
        ])
    if params.get("umask", None) is not None:
        cargs.extend([
            "-umask",
            str(params.get("umask", None))
        ])
    if params.get("logfile", None) is not None:
        cargs.extend([
            "-log",
            params.get("logfile", None)
        ])
    return cargs


def mkheadsurf_outputs(
    params: MkheadsurfParamsDict,
    execution: Execution,
) -> MkheadsurfOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = MkheadsurfOutputs(
        root=execution.output_file("."),
    )
    return ret


def mkheadsurf_execute(
    params: MkheadsurfParamsDict,
    runner: Runner | None = None,
) -> MkheadsurfOutputs:
    """
    mkheadsurf
    
    Segment and create a surface representation of the head for visualization
    and further processing.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MkheadsurfOutputs`).
    """
    mkheadsurf_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(MKHEADSURF_METADATA)
    params = execution.params(params)
    cargs = mkheadsurf_cargs(params, execution)
    ret = mkheadsurf_outputs(params, execution)
    execution.run(cargs)
    return ret


def mkheadsurf(
    input_vol: InputPathType,
    output_vol: str,
    output_surf: str,
    subject_id: str,
    nsmooth: float | None = None,
    noseghead: bool = False,
    thresh1: float | None = None,
    thresh2: float | None = None,
    nhitsmin: float | None = None,
    ndilate: float | None = None,
    nerode: float | None = None,
    fillval: float | None = None,
    fhi: float | None = None,
    no_rescale: bool = False,
    no_fill_holes_islands: bool = False,
    or_mask: InputPathType | None = None,
    tessellation_method: str | None = None,
    inflate: bool = False,
    curv: bool = False,
    srcvol: str | None = None,
    headvol: str | None = None,
    headsurf: str | None = None,
    smheadsurf: str | None = None,
    hemi: str | None = None,
    subjects_dir: str | None = None,
    umask: float | None = None,
    logfile: str | None = None,
    runner: Runner | None = None,
) -> MkheadsurfOutputs:
    """
    mkheadsurf
    
    Segment and create a surface representation of the head for visualization
    and further processing.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        input_vol: Input volume.
        output_vol: Output volume.
        output_surf: Output surface.
        subject_id: Subject ID.
        nsmooth: Number of smoothing iterations (default 10).
        noseghead: Do not segment the head, only tessellate and smooth existing.
        thresh1: Threshold 1 value (default 20).
        thresh2: Threshold 2 value (default 20).
        nhitsmin: Minimum number of hits (default 2).
        ndilate: Number of dilations (default 0).
        nerode: Number of erosions (default 0).
        fillval: Fill value (default 1).
        fhi: FHI for MRIchangeType; default is to use default in mri_seghead.
        no_rescale: Do not rescale input when converting to uchar.
        no_fill_holes_islands: Do not fill holes and remove islands.
        or_mask: Include all voxels in ormask in the head seg.
        tessellation_method: Tessellation method using mri_tessellate or mri_mc\
            (default is -mc).
        inflate: Inflate and compute sulc.
        curv: Compute curv with smoothing.
        srcvol: Source volume ID (default is T1).
        headvol: Head volume ID (default is seghead).
        headsurf: Head surface ID (default is seghead).
        smheadsurf: Smoothed head surface ID (default is smseghead).
        hemi: Hemisphere (default is lh).
        subjects_dir: Subjects directory (default is SUBJECTS_DIR).
        umask: Umask setting (default is 2).
        logfile: Log file.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MkheadsurfOutputs`).
    """
    params = mkheadsurf_params(
        input_vol=input_vol,
        output_vol=output_vol,
        output_surf=output_surf,
        subject_id=subject_id,
        nsmooth=nsmooth,
        noseghead=noseghead,
        thresh1=thresh1,
        thresh2=thresh2,
        nhitsmin=nhitsmin,
        ndilate=ndilate,
        nerode=nerode,
        fillval=fillval,
        fhi=fhi,
        no_rescale=no_rescale,
        no_fill_holes_islands=no_fill_holes_islands,
        or_mask=or_mask,
        tessellation_method=tessellation_method,
        inflate=inflate,
        curv=curv,
        srcvol=srcvol,
        headvol=headvol,
        headsurf=headsurf,
        smheadsurf=smheadsurf,
        hemi=hemi,
        subjects_dir=subjects_dir,
        umask=umask,
        logfile=logfile,
    )
    return mkheadsurf_execute(params, runner)


__all__ = [
    "MKHEADSURF_METADATA",
    "MkheadsurfOutputs",
    "MkheadsurfParamsDict",
    "MkheadsurfParamsDictTagged",
    "mkheadsurf",
    "mkheadsurf_execute",
    "mkheadsurf_params",
]
