# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

SEGMENT_SUBREGIONS_METADATA = Metadata(
    id="a23e365a3bdaf28e2566ccd0387371b490a84bc2.boutiques",
    name="segment_subregions",
    package="freesurfer",
    container_image_tag="freesurfer/freesurfer:7.4.1",
)


_SegmentSubregionsParamsDictNoTag = typing.TypedDict('_SegmentSubregionsParamsDictNoTag', {
    "structure": str,
    "cross": typing.NotRequired[str | None],
    "long_base": typing.NotRequired[str | None],
    "sd": typing.NotRequired[str | None],
    "suffix": typing.NotRequired[str | None],
    "temp_dir": typing.NotRequired[str | None],
    "out_dir": typing.NotRequired[str | None],
    "debug": bool,
    "threads": typing.NotRequired[float | None],
})
SegmentSubregionsParamsDictTagged = typing.TypedDict('SegmentSubregionsParamsDictTagged', {
    "@type": typing.Literal["freesurfer/segment_subregions"],
    "structure": str,
    "cross": typing.NotRequired[str | None],
    "long_base": typing.NotRequired[str | None],
    "sd": typing.NotRequired[str | None],
    "suffix": typing.NotRequired[str | None],
    "temp_dir": typing.NotRequired[str | None],
    "out_dir": typing.NotRequired[str | None],
    "debug": bool,
    "threads": typing.NotRequired[float | None],
})
SegmentSubregionsParamsDict = _SegmentSubregionsParamsDictNoTag | SegmentSubregionsParamsDictTagged


class SegmentSubregionsOutputs(typing.NamedTuple):
    """
    Output object returned when calling `SegmentSubregionsParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""


def segment_subregions_params(
    structure: str,
    cross: str | None = None,
    long_base: str | None = None,
    sd: str | None = None,
    suffix: str | None = None,
    temp_dir: str | None = None,
    out_dir: str | None = None,
    debug: bool = False,
    threads: float | None = None,
) -> SegmentSubregionsParamsDictTagged:
    """
    Build parameters.
    
    Args:
        structure: Structure to segment. Options are: thalamus, brainstem,\
            hippo-amygdala.
        cross: Subject to segment in cross-sectional analysis.
        long_base: Base subject for longitudinal analysis. Timepoints are\
            extracted from the base-tps file.
        sd: Specify subjects directory (will override SUBJECTS_DIR env\
            variable).
        suffix: Optional output file suffix.
        temp_dir: Use alternative temporary directory. This will get deleted\
            unless --debug is enabled.
        out_dir: Use alternative output directory (only for cross-sectional).\
            Default is the subject's `mri` directory.
        debug: Write intermediate debugging outputs.
        threads: Number of threads to use. Defaults to 1.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "freesurfer/segment_subregions",
        "structure": structure,
        "debug": debug,
    }
    if cross is not None:
        params["cross"] = cross
    if long_base is not None:
        params["long_base"] = long_base
    if sd is not None:
        params["sd"] = sd
    if suffix is not None:
        params["suffix"] = suffix
    if temp_dir is not None:
        params["temp_dir"] = temp_dir
    if out_dir is not None:
        params["out_dir"] = out_dir
    if threads is not None:
        params["threads"] = threads
    return params


def segment_subregions_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `SegmentSubregionsParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("structure", None) is None:
        raise StyxValidationError("`structure` must not be None")
    if not isinstance(params["structure"], str):
        raise StyxValidationError(f'`structure` has the wrong type: Received `{type(params.get("structure", None))}` expected `str`')
    if params.get("cross", None) is not None:
        if not isinstance(params["cross"], str):
            raise StyxValidationError(f'`cross` has the wrong type: Received `{type(params.get("cross", None))}` expected `str | None`')
    if params.get("long_base", None) is not None:
        if not isinstance(params["long_base"], str):
            raise StyxValidationError(f'`long_base` has the wrong type: Received `{type(params.get("long_base", None))}` expected `str | None`')
    if params.get("sd", None) is not None:
        if not isinstance(params["sd"], str):
            raise StyxValidationError(f'`sd` has the wrong type: Received `{type(params.get("sd", None))}` expected `str | None`')
    if params.get("suffix", None) is not None:
        if not isinstance(params["suffix"], str):
            raise StyxValidationError(f'`suffix` has the wrong type: Received `{type(params.get("suffix", None))}` expected `str | None`')
    if params.get("temp_dir", None) is not None:
        if not isinstance(params["temp_dir"], str):
            raise StyxValidationError(f'`temp_dir` has the wrong type: Received `{type(params.get("temp_dir", None))}` expected `str | None`')
    if params.get("out_dir", None) is not None:
        if not isinstance(params["out_dir"], str):
            raise StyxValidationError(f'`out_dir` has the wrong type: Received `{type(params.get("out_dir", None))}` expected `str | None`')
    if params.get("debug", False) is None:
        raise StyxValidationError("`debug` must not be None")
    if not isinstance(params["debug"], bool):
        raise StyxValidationError(f'`debug` has the wrong type: Received `{type(params.get("debug", False))}` expected `bool`')
    if params.get("threads", None) is not None:
        if not isinstance(params["threads"], (float, int)):
            raise StyxValidationError(f'`threads` has the wrong type: Received `{type(params.get("threads", None))}` expected `float | None`')


def segment_subregions_cargs(
    params: SegmentSubregionsParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("segment_subregions")
    cargs.append(params.get("structure", None))
    if params.get("cross", None) is not None:
        cargs.extend([
            "--cross",
            params.get("cross", None)
        ])
    if params.get("long_base", None) is not None:
        cargs.extend([
            "--long-base",
            params.get("long_base", None)
        ])
    if params.get("sd", None) is not None:
        cargs.extend([
            "--sd",
            params.get("sd", None)
        ])
    if params.get("suffix", None) is not None:
        cargs.extend([
            "--suffix",
            params.get("suffix", None)
        ])
    if params.get("temp_dir", None) is not None:
        cargs.extend([
            "--temp-dir",
            params.get("temp_dir", None)
        ])
    if params.get("out_dir", None) is not None:
        cargs.extend([
            "--out-dir",
            params.get("out_dir", None)
        ])
    if params.get("debug", False):
        cargs.append("--debug")
    if params.get("threads", None) is not None:
        cargs.extend([
            "--threads",
            str(params.get("threads", None))
        ])
    return cargs


def segment_subregions_outputs(
    params: SegmentSubregionsParamsDict,
    execution: Execution,
) -> SegmentSubregionsOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = SegmentSubregionsOutputs(
        root=execution.output_file("."),
    )
    return ret


def segment_subregions_execute(
    params: SegmentSubregionsParamsDict,
    runner: Runner | None = None,
) -> SegmentSubregionsOutputs:
    """
    segment_subregions
    
    Cross-sectional and longitudinal segmentation for brain structures like
    thalamus, brainstem, and hippo-amygdala.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `SegmentSubregionsOutputs`).
    """
    segment_subregions_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(SEGMENT_SUBREGIONS_METADATA)
    params = execution.params(params)
    cargs = segment_subregions_cargs(params, execution)
    ret = segment_subregions_outputs(params, execution)
    execution.run(cargs)
    return ret


def segment_subregions(
    structure: str,
    cross: str | None = None,
    long_base: str | None = None,
    sd: str | None = None,
    suffix: str | None = None,
    temp_dir: str | None = None,
    out_dir: str | None = None,
    debug: bool = False,
    threads: float | None = None,
    runner: Runner | None = None,
) -> SegmentSubregionsOutputs:
    """
    segment_subregions
    
    Cross-sectional and longitudinal segmentation for brain structures like
    thalamus, brainstem, and hippo-amygdala.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        structure: Structure to segment. Options are: thalamus, brainstem,\
            hippo-amygdala.
        cross: Subject to segment in cross-sectional analysis.
        long_base: Base subject for longitudinal analysis. Timepoints are\
            extracted from the base-tps file.
        sd: Specify subjects directory (will override SUBJECTS_DIR env\
            variable).
        suffix: Optional output file suffix.
        temp_dir: Use alternative temporary directory. This will get deleted\
            unless --debug is enabled.
        out_dir: Use alternative output directory (only for cross-sectional).\
            Default is the subject's `mri` directory.
        debug: Write intermediate debugging outputs.
        threads: Number of threads to use. Defaults to 1.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `SegmentSubregionsOutputs`).
    """
    params = segment_subregions_params(
        structure=structure,
        cross=cross,
        long_base=long_base,
        sd=sd,
        suffix=suffix,
        temp_dir=temp_dir,
        out_dir=out_dir,
        debug=debug,
        threads=threads,
    )
    return segment_subregions_execute(params, runner)


__all__ = [
    "SEGMENT_SUBREGIONS_METADATA",
    "SegmentSubregionsOutputs",
    "SegmentSubregionsParamsDict",
    "SegmentSubregionsParamsDictTagged",
    "segment_subregions",
    "segment_subregions_execute",
    "segment_subregions_params",
]
