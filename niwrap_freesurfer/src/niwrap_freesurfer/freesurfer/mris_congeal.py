# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

MRIS_CONGEAL_METADATA = Metadata(
    id="5d3ce3c9dd1e656395d4e4e559382a2a9e94ff6d.boutiques",
    name="mris_congeal",
    package="freesurfer",
    container_image_tag="freesurfer/freesurfer:7.4.1",
)


_MrisCongealParamsDictNoTag = typing.TypedDict('_MrisCongealParamsDictNoTag', {
    "input_surface_name": str,
    "hemi": str,
    "subjects": list[str],
    "output_surface_name": str,
    "subjects_dir": typing.NotRequired[str | None],
    "disable_rigid_alignment": bool,
    "disable_sulc_alignment": bool,
    "smoothwm_curv": bool,
    "jacobian_output": typing.NotRequired[str | None],
    "distance_term": typing.NotRequired[float | None],
    "manual_label": typing.NotRequired[list[str] | None],
    "addframe": typing.NotRequired[list[str] | None],
    "overlay": typing.NotRequired[list[str] | None],
    "overlay_dir": typing.NotRequired[str | None],
    "target_subject": bool,
})
MrisCongealParamsDictTagged = typing.TypedDict('MrisCongealParamsDictTagged', {
    "@type": typing.Literal["freesurfer/mris_congeal"],
    "input_surface_name": str,
    "hemi": str,
    "subjects": list[str],
    "output_surface_name": str,
    "subjects_dir": typing.NotRequired[str | None],
    "disable_rigid_alignment": bool,
    "disable_sulc_alignment": bool,
    "smoothwm_curv": bool,
    "jacobian_output": typing.NotRequired[str | None],
    "distance_term": typing.NotRequired[float | None],
    "manual_label": typing.NotRequired[list[str] | None],
    "addframe": typing.NotRequired[list[str] | None],
    "overlay": typing.NotRequired[list[str] | None],
    "overlay_dir": typing.NotRequired[str | None],
    "target_subject": bool,
})
MrisCongealParamsDict = _MrisCongealParamsDictNoTag | MrisCongealParamsDictTagged


class MrisCongealOutputs(typing.NamedTuple):
    """
    Output object returned when calling `MrisCongealParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    output_surface: OutputPathType
    """Output surface"""


def mris_congeal_params(
    input_surface_name: str,
    hemi: str,
    subjects: list[str],
    output_surface_name: str,
    subjects_dir: str | None = None,
    disable_rigid_alignment: bool = False,
    disable_sulc_alignment: bool = False,
    smoothwm_curv: bool = False,
    jacobian_output: str | None = None,
    distance_term: float | None = None,
    manual_label: list[str] | None = None,
    addframe: list[str] | None = None,
    overlay: list[str] | None = None,
    overlay_dir: str | None = None,
    target_subject: bool = False,
) -> MrisCongealParamsDictTagged:
    """
    Build parameters.
    
    Args:
        input_surface_name: Input surface name.
        hemi: Hemisphere (hemi).
        subjects: List of subjects.
        output_surface_name: Output surface name.
        subjects_dir: Subjects directory.
        disable_rigid_alignment: Disable initial rigid alignment.
        disable_sulc_alignment: Disable initial sulc alignment.
        smoothwm_curv: Use smoothwm curvature for final alignment.
        jacobian_output: Write-out jacobian overlay data to file.
        distance_term: Specify distance term.
        manual_label: Specify a manual label to align with atlas label.
        addframe: Add frame with specified parameters.
        overlay: Specify overlay surface values and number of averages.
        overlay_dir: Specify overlay directory.
        target_subject: Target specifies a subject's surface, not a template\
            file.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "freesurfer/mris_congeal",
        "input_surface_name": input_surface_name,
        "hemi": hemi,
        "subjects": subjects,
        "output_surface_name": output_surface_name,
        "disable_rigid_alignment": disable_rigid_alignment,
        "disable_sulc_alignment": disable_sulc_alignment,
        "smoothwm_curv": smoothwm_curv,
        "target_subject": target_subject,
    }
    if subjects_dir is not None:
        params["subjects_dir"] = subjects_dir
    if jacobian_output is not None:
        params["jacobian_output"] = jacobian_output
    if distance_term is not None:
        params["distance_term"] = distance_term
    if manual_label is not None:
        params["manual_label"] = manual_label
    if addframe is not None:
        params["addframe"] = addframe
    if overlay is not None:
        params["overlay"] = overlay
    if overlay_dir is not None:
        params["overlay_dir"] = overlay_dir
    return params


def mris_congeal_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `MrisCongealParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("input_surface_name", None) is None:
        raise StyxValidationError("`input_surface_name` must not be None")
    if not isinstance(params["input_surface_name"], str):
        raise StyxValidationError(f'`input_surface_name` has the wrong type: Received `{type(params.get("input_surface_name", None))}` expected `str`')
    if params.get("hemi", None) is None:
        raise StyxValidationError("`hemi` must not be None")
    if not isinstance(params["hemi"], str):
        raise StyxValidationError(f'`hemi` has the wrong type: Received `{type(params.get("hemi", None))}` expected `str`')
    if params.get("subjects", None) is None:
        raise StyxValidationError("`subjects` must not be None")
    if not isinstance(params["subjects"], list):
        raise StyxValidationError(f'`subjects` has the wrong type: Received `{type(params.get("subjects", None))}` expected `list[str]`')
    for e in params["subjects"]:
        if not isinstance(e, str):
            raise StyxValidationError(f'`subjects` has the wrong type: Received `{type(params.get("subjects", None))}` expected `list[str]`')
    if params.get("output_surface_name", None) is None:
        raise StyxValidationError("`output_surface_name` must not be None")
    if not isinstance(params["output_surface_name"], str):
        raise StyxValidationError(f'`output_surface_name` has the wrong type: Received `{type(params.get("output_surface_name", None))}` expected `str`')
    if params.get("subjects_dir", None) is not None:
        if not isinstance(params["subjects_dir"], str):
            raise StyxValidationError(f'`subjects_dir` has the wrong type: Received `{type(params.get("subjects_dir", None))}` expected `str | None`')
    if params.get("disable_rigid_alignment", False) is None:
        raise StyxValidationError("`disable_rigid_alignment` must not be None")
    if not isinstance(params["disable_rigid_alignment"], bool):
        raise StyxValidationError(f'`disable_rigid_alignment` has the wrong type: Received `{type(params.get("disable_rigid_alignment", False))}` expected `bool`')
    if params.get("disable_sulc_alignment", False) is None:
        raise StyxValidationError("`disable_sulc_alignment` must not be None")
    if not isinstance(params["disable_sulc_alignment"], bool):
        raise StyxValidationError(f'`disable_sulc_alignment` has the wrong type: Received `{type(params.get("disable_sulc_alignment", False))}` expected `bool`')
    if params.get("smoothwm_curv", False) is None:
        raise StyxValidationError("`smoothwm_curv` must not be None")
    if not isinstance(params["smoothwm_curv"], bool):
        raise StyxValidationError(f'`smoothwm_curv` has the wrong type: Received `{type(params.get("smoothwm_curv", False))}` expected `bool`')
    if params.get("jacobian_output", None) is not None:
        if not isinstance(params["jacobian_output"], str):
            raise StyxValidationError(f'`jacobian_output` has the wrong type: Received `{type(params.get("jacobian_output", None))}` expected `str | None`')
    if params.get("distance_term", None) is not None:
        if not isinstance(params["distance_term"], (float, int)):
            raise StyxValidationError(f'`distance_term` has the wrong type: Received `{type(params.get("distance_term", None))}` expected `float | None`')
    if params.get("manual_label", None) is not None:
        if not isinstance(params["manual_label"], list):
            raise StyxValidationError(f'`manual_label` has the wrong type: Received `{type(params.get("manual_label", None))}` expected `list[str] | None`')
        if len(params["manual_label"]) > 3:
            raise StyxValidationError("Parameter `manual_label` must contain at most 3 elements")
        for e in params["manual_label"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`manual_label` has the wrong type: Received `{type(params.get("manual_label", None))}` expected `list[str] | None`')
    if params.get("addframe", None) is not None:
        if not isinstance(params["addframe"], list):
            raise StyxValidationError(f'`addframe` has the wrong type: Received `{type(params.get("addframe", None))}` expected `list[str] | None`')
        if len(params["addframe"]) > 4:
            raise StyxValidationError("Parameter `addframe` must contain at most 4 elements")
        for e in params["addframe"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`addframe` has the wrong type: Received `{type(params.get("addframe", None))}` expected `list[str] | None`')
    if params.get("overlay", None) is not None:
        if not isinstance(params["overlay"], list):
            raise StyxValidationError(f'`overlay` has the wrong type: Received `{type(params.get("overlay", None))}` expected `list[str] | None`')
        if len(params["overlay"]) > 2:
            raise StyxValidationError("Parameter `overlay` must contain at most 2 elements")
        for e in params["overlay"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`overlay` has the wrong type: Received `{type(params.get("overlay", None))}` expected `list[str] | None`')
    if params.get("overlay_dir", None) is not None:
        if not isinstance(params["overlay_dir"], str):
            raise StyxValidationError(f'`overlay_dir` has the wrong type: Received `{type(params.get("overlay_dir", None))}` expected `str | None`')
    if params.get("target_subject", False) is None:
        raise StyxValidationError("`target_subject` must not be None")
    if not isinstance(params["target_subject"], bool):
        raise StyxValidationError(f'`target_subject` has the wrong type: Received `{type(params.get("target_subject", False))}` expected `bool`')


def mris_congeal_cargs(
    params: MrisCongealParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("mris_congeal")
    cargs.append(params.get("input_surface_name", None))
    cargs.append(params.get("hemi", None))
    cargs.extend(params.get("subjects", None))
    cargs.append(params.get("output_surface_name", None))
    if params.get("subjects_dir", None) is not None:
        cargs.extend([
            "-SDIR",
            params.get("subjects_dir", None)
        ])
    if params.get("disable_rigid_alignment", False):
        cargs.append("-norot")
    if params.get("disable_sulc_alignment", False):
        cargs.append("-nosulc")
    if params.get("smoothwm_curv", False):
        cargs.append("-curv")
    if params.get("jacobian_output", None) is not None:
        cargs.extend([
            "-jacobian",
            params.get("jacobian_output", None)
        ])
    if params.get("distance_term", None) is not None:
        cargs.extend([
            "-dist",
            str(params.get("distance_term", None))
        ])
    if params.get("manual_label", None) is not None:
        cargs.extend([
            "-l",
            *params.get("manual_label", None)
        ])
    if params.get("addframe", None) is not None:
        cargs.extend([
            "-addframe",
            *params.get("addframe", None)
        ])
    if params.get("overlay", None) is not None:
        cargs.extend([
            "-overlay",
            *params.get("overlay", None)
        ])
    if params.get("overlay_dir", None) is not None:
        cargs.extend([
            "-overlay-dir",
            params.get("overlay_dir", None)
        ])
    if params.get("target_subject", False):
        cargs.append("-1")
    return cargs


def mris_congeal_outputs(
    params: MrisCongealParamsDict,
    execution: Execution,
) -> MrisCongealOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = MrisCongealOutputs(
        root=execution.output_file("."),
        output_surface=execution.output_file(params.get("output_surface_name", None)),
    )
    return ret


def mris_congeal_execute(
    params: MrisCongealParamsDict,
    runner: Runner | None = None,
) -> MrisCongealOutputs:
    """
    mris_congeal
    
    Program that registers a set of input surfaces together and generates an
    atlas.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MrisCongealOutputs`).
    """
    mris_congeal_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(MRIS_CONGEAL_METADATA)
    params = execution.params(params)
    cargs = mris_congeal_cargs(params, execution)
    ret = mris_congeal_outputs(params, execution)
    execution.run(cargs)
    return ret


def mris_congeal(
    input_surface_name: str,
    hemi: str,
    subjects: list[str],
    output_surface_name: str,
    subjects_dir: str | None = None,
    disable_rigid_alignment: bool = False,
    disable_sulc_alignment: bool = False,
    smoothwm_curv: bool = False,
    jacobian_output: str | None = None,
    distance_term: float | None = None,
    manual_label: list[str] | None = None,
    addframe: list[str] | None = None,
    overlay: list[str] | None = None,
    overlay_dir: str | None = None,
    target_subject: bool = False,
    runner: Runner | None = None,
) -> MrisCongealOutputs:
    """
    mris_congeal
    
    Program that registers a set of input surfaces together and generates an
    atlas.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        input_surface_name: Input surface name.
        hemi: Hemisphere (hemi).
        subjects: List of subjects.
        output_surface_name: Output surface name.
        subjects_dir: Subjects directory.
        disable_rigid_alignment: Disable initial rigid alignment.
        disable_sulc_alignment: Disable initial sulc alignment.
        smoothwm_curv: Use smoothwm curvature for final alignment.
        jacobian_output: Write-out jacobian overlay data to file.
        distance_term: Specify distance term.
        manual_label: Specify a manual label to align with atlas label.
        addframe: Add frame with specified parameters.
        overlay: Specify overlay surface values and number of averages.
        overlay_dir: Specify overlay directory.
        target_subject: Target specifies a subject's surface, not a template\
            file.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MrisCongealOutputs`).
    """
    params = mris_congeal_params(
        input_surface_name=input_surface_name,
        hemi=hemi,
        subjects=subjects,
        output_surface_name=output_surface_name,
        subjects_dir=subjects_dir,
        disable_rigid_alignment=disable_rigid_alignment,
        disable_sulc_alignment=disable_sulc_alignment,
        smoothwm_curv=smoothwm_curv,
        jacobian_output=jacobian_output,
        distance_term=distance_term,
        manual_label=manual_label,
        addframe=addframe,
        overlay=overlay,
        overlay_dir=overlay_dir,
        target_subject=target_subject,
    )
    return mris_congeal_execute(params, runner)


__all__ = [
    "MRIS_CONGEAL_METADATA",
    "MrisCongealOutputs",
    "MrisCongealParamsDict",
    "MrisCongealParamsDictTagged",
    "mris_congeal",
    "mris_congeal_execute",
    "mris_congeal_params",
]
