# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

GROUPSTATSDIFF_METADATA = Metadata(
    id="737e572b68d7acaf48ce6e41a064fe62f0b93177.boutiques",
    name="groupstatsdiff",
    package="freesurfer",
    container_image_tag="freesurfer/freesurfer:7.4.1",
)


_GroupstatsdiffParamsDictNoTag = typing.TypedDict('_GroupstatsdiffParamsDictNoTag', {
    "group1_dir": str,
    "group2_dir": str,
    "output_dir": str,
    "no_maps": bool,
    "osgm": bool,
    "no_common": bool,
    "allow_subj_diff": bool,
    "no_area": bool,
    "no_volume": bool,
    "no_ba": bool,
    "no_aparcstats": bool,
    "no_asegstats": bool,
    "no_wparcstats": bool,
    "no_stats": bool,
    "no_prune": bool,
    "fwhm_value": typing.NotRequired[float | None],
    "subjects_dir1": typing.NotRequired[str | None],
    "subjects_dir2": typing.NotRequired[str | None],
    "no_dice": bool,
    "dice_ctab": typing.NotRequired[str | None],
})
GroupstatsdiffParamsDictTagged = typing.TypedDict('GroupstatsdiffParamsDictTagged', {
    "@type": typing.Literal["freesurfer/groupstatsdiff"],
    "group1_dir": str,
    "group2_dir": str,
    "output_dir": str,
    "no_maps": bool,
    "osgm": bool,
    "no_common": bool,
    "allow_subj_diff": bool,
    "no_area": bool,
    "no_volume": bool,
    "no_ba": bool,
    "no_aparcstats": bool,
    "no_asegstats": bool,
    "no_wparcstats": bool,
    "no_stats": bool,
    "no_prune": bool,
    "fwhm_value": typing.NotRequired[float | None],
    "subjects_dir1": typing.NotRequired[str | None],
    "subjects_dir2": typing.NotRequired[str | None],
    "no_dice": bool,
    "dice_ctab": typing.NotRequired[str | None],
})
GroupstatsdiffParamsDict = _GroupstatsdiffParamsDictNoTag | GroupstatsdiffParamsDictTagged


class GroupstatsdiffOutputs(typing.NamedTuple):
    """
    Output object returned when calling `GroupstatsdiffParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""


def groupstatsdiff_params(
    group1_dir: str,
    group2_dir: str,
    output_dir: str,
    no_maps: bool = False,
    osgm: bool = False,
    no_common: bool = False,
    allow_subj_diff: bool = False,
    no_area: bool = False,
    no_volume: bool = False,
    no_ba: bool = False,
    no_aparcstats: bool = False,
    no_asegstats: bool = False,
    no_wparcstats: bool = False,
    no_stats: bool = False,
    no_prune: bool = False,
    fwhm_value: float | None = None,
    subjects_dir1: str | None = None,
    subjects_dir2: str | None = None,
    no_dice: bool = False,
    dice_ctab: str | None = None,
) -> GroupstatsdiffParamsDictTagged:
    """
    Build parameters.
    
    Args:
        group1_dir: Output folder from groupstats for group 1.
        group2_dir: Output folder from groupstats for group 2.
        output_dir: Output folder for the difference analysis.
        no_maps: Only analyze ROI data, no maps.
        osgm: Use OSGM instead of native FSGD.
        no_common: Do not select common segments when running stattablediff.
        allow_subj_diff: Allow list of subjects to be different between the two\
            analyses.
        no_area: Do not compute area differences.
        no_volume: Do not compute volume differences.
        no_ba: Do not compute differences for BA labels.
        no_aparcstats: Do not do aparcstats.
        no_asegstats: Do not do asegstats.
        no_wparcstats: Do not do wmparcstats.
        no_stats: Do not do any ROI stats.
        no_prune: Do not prune when running mri_glmfit.
        fwhm_value: Override the FWHM from group analysis.
        subjects_dir1: Subjects directory 1 for computing dice (default is\
            parent dir of groupdir).
        subjects_dir2: Subjects directory 2 for computing dice (default is\
            parent dir of groupdir).
        no_dice: Do not compute dice.
        dice_ctab: CTAB to use for dice computation (default is\
            /usr/local/freesurfer/ASegStatsLUT.txt).
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "freesurfer/groupstatsdiff",
        "group1_dir": group1_dir,
        "group2_dir": group2_dir,
        "output_dir": output_dir,
        "no_maps": no_maps,
        "osgm": osgm,
        "no_common": no_common,
        "allow_subj_diff": allow_subj_diff,
        "no_area": no_area,
        "no_volume": no_volume,
        "no_ba": no_ba,
        "no_aparcstats": no_aparcstats,
        "no_asegstats": no_asegstats,
        "no_wparcstats": no_wparcstats,
        "no_stats": no_stats,
        "no_prune": no_prune,
        "no_dice": no_dice,
    }
    if fwhm_value is not None:
        params["fwhm_value"] = fwhm_value
    if subjects_dir1 is not None:
        params["subjects_dir1"] = subjects_dir1
    if subjects_dir2 is not None:
        params["subjects_dir2"] = subjects_dir2
    if dice_ctab is not None:
        params["dice_ctab"] = dice_ctab
    return params


def groupstatsdiff_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `GroupstatsdiffParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("group1_dir", None) is None:
        raise StyxValidationError("`group1_dir` must not be None")
    if not isinstance(params["group1_dir"], str):
        raise StyxValidationError(f'`group1_dir` has the wrong type: Received `{type(params.get("group1_dir", None))}` expected `str`')
    if params.get("group2_dir", None) is None:
        raise StyxValidationError("`group2_dir` must not be None")
    if not isinstance(params["group2_dir"], str):
        raise StyxValidationError(f'`group2_dir` has the wrong type: Received `{type(params.get("group2_dir", None))}` expected `str`')
    if params.get("output_dir", None) is None:
        raise StyxValidationError("`output_dir` must not be None")
    if not isinstance(params["output_dir"], str):
        raise StyxValidationError(f'`output_dir` has the wrong type: Received `{type(params.get("output_dir", None))}` expected `str`')
    if params.get("no_maps", False) is None:
        raise StyxValidationError("`no_maps` must not be None")
    if not isinstance(params["no_maps"], bool):
        raise StyxValidationError(f'`no_maps` has the wrong type: Received `{type(params.get("no_maps", False))}` expected `bool`')
    if params.get("osgm", False) is None:
        raise StyxValidationError("`osgm` must not be None")
    if not isinstance(params["osgm"], bool):
        raise StyxValidationError(f'`osgm` has the wrong type: Received `{type(params.get("osgm", False))}` expected `bool`')
    if params.get("no_common", False) is None:
        raise StyxValidationError("`no_common` must not be None")
    if not isinstance(params["no_common"], bool):
        raise StyxValidationError(f'`no_common` has the wrong type: Received `{type(params.get("no_common", False))}` expected `bool`')
    if params.get("allow_subj_diff", False) is None:
        raise StyxValidationError("`allow_subj_diff` must not be None")
    if not isinstance(params["allow_subj_diff"], bool):
        raise StyxValidationError(f'`allow_subj_diff` has the wrong type: Received `{type(params.get("allow_subj_diff", False))}` expected `bool`')
    if params.get("no_area", False) is None:
        raise StyxValidationError("`no_area` must not be None")
    if not isinstance(params["no_area"], bool):
        raise StyxValidationError(f'`no_area` has the wrong type: Received `{type(params.get("no_area", False))}` expected `bool`')
    if params.get("no_volume", False) is None:
        raise StyxValidationError("`no_volume` must not be None")
    if not isinstance(params["no_volume"], bool):
        raise StyxValidationError(f'`no_volume` has the wrong type: Received `{type(params.get("no_volume", False))}` expected `bool`')
    if params.get("no_ba", False) is None:
        raise StyxValidationError("`no_ba` must not be None")
    if not isinstance(params["no_ba"], bool):
        raise StyxValidationError(f'`no_ba` has the wrong type: Received `{type(params.get("no_ba", False))}` expected `bool`')
    if params.get("no_aparcstats", False) is None:
        raise StyxValidationError("`no_aparcstats` must not be None")
    if not isinstance(params["no_aparcstats"], bool):
        raise StyxValidationError(f'`no_aparcstats` has the wrong type: Received `{type(params.get("no_aparcstats", False))}` expected `bool`')
    if params.get("no_asegstats", False) is None:
        raise StyxValidationError("`no_asegstats` must not be None")
    if not isinstance(params["no_asegstats"], bool):
        raise StyxValidationError(f'`no_asegstats` has the wrong type: Received `{type(params.get("no_asegstats", False))}` expected `bool`')
    if params.get("no_wparcstats", False) is None:
        raise StyxValidationError("`no_wparcstats` must not be None")
    if not isinstance(params["no_wparcstats"], bool):
        raise StyxValidationError(f'`no_wparcstats` has the wrong type: Received `{type(params.get("no_wparcstats", False))}` expected `bool`')
    if params.get("no_stats", False) is None:
        raise StyxValidationError("`no_stats` must not be None")
    if not isinstance(params["no_stats"], bool):
        raise StyxValidationError(f'`no_stats` has the wrong type: Received `{type(params.get("no_stats", False))}` expected `bool`')
    if params.get("no_prune", False) is None:
        raise StyxValidationError("`no_prune` must not be None")
    if not isinstance(params["no_prune"], bool):
        raise StyxValidationError(f'`no_prune` has the wrong type: Received `{type(params.get("no_prune", False))}` expected `bool`')
    if params.get("fwhm_value", None) is not None:
        if not isinstance(params["fwhm_value"], (float, int)):
            raise StyxValidationError(f'`fwhm_value` has the wrong type: Received `{type(params.get("fwhm_value", None))}` expected `float | None`')
    if params.get("subjects_dir1", None) is not None:
        if not isinstance(params["subjects_dir1"], str):
            raise StyxValidationError(f'`subjects_dir1` has the wrong type: Received `{type(params.get("subjects_dir1", None))}` expected `str | None`')
    if params.get("subjects_dir2", None) is not None:
        if not isinstance(params["subjects_dir2"], str):
            raise StyxValidationError(f'`subjects_dir2` has the wrong type: Received `{type(params.get("subjects_dir2", None))}` expected `str | None`')
    if params.get("no_dice", False) is None:
        raise StyxValidationError("`no_dice` must not be None")
    if not isinstance(params["no_dice"], bool):
        raise StyxValidationError(f'`no_dice` has the wrong type: Received `{type(params.get("no_dice", False))}` expected `bool`')
    if params.get("dice_ctab", None) is not None:
        if not isinstance(params["dice_ctab"], str):
            raise StyxValidationError(f'`dice_ctab` has the wrong type: Received `{type(params.get("dice_ctab", None))}` expected `str | None`')


def groupstatsdiff_cargs(
    params: GroupstatsdiffParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("groupstatsdiff")
    cargs.extend([
        "-g1",
        params.get("group1_dir", None)
    ])
    cargs.extend([
        "-g2",
        params.get("group2_dir", None)
    ])
    cargs.extend([
        "-o",
        params.get("output_dir", None)
    ])
    if params.get("no_maps", False):
        cargs.append("--no-maps")
    if params.get("osgm", False):
        cargs.append("--osgm")
    if params.get("no_common", False):
        cargs.append("--no-common")
    if params.get("allow_subj_diff", False):
        cargs.append("--allow-subj-diff")
    if params.get("no_area", False):
        cargs.append("--no-area")
    if params.get("no_volume", False):
        cargs.append("--no-volume")
    if params.get("no_ba", False):
        cargs.append("--no-ba")
    if params.get("no_aparcstats", False):
        cargs.append("--no-aparcstats")
    if params.get("no_asegstats", False):
        cargs.append("--no-asegstats")
    if params.get("no_wparcstats", False):
        cargs.append("--no-wparcstats")
    if params.get("no_stats", False):
        cargs.append("--no-stats")
    if params.get("no_prune", False):
        cargs.append("--no-prune")
    if params.get("fwhm_value", None) is not None:
        cargs.extend([
            "--fwhm",
            str(params.get("fwhm_value", None))
        ])
    if params.get("subjects_dir1", None) is not None:
        cargs.extend([
            "--sd1",
            params.get("subjects_dir1", None)
        ])
    if params.get("subjects_dir2", None) is not None:
        cargs.extend([
            "--sd2",
            params.get("subjects_dir2", None)
        ])
    if params.get("no_dice", False):
        cargs.append("--no-dice")
    if params.get("dice_ctab", None) is not None:
        cargs.extend([
            "--dice-ctab",
            params.get("dice_ctab", None)
        ])
    return cargs


def groupstatsdiff_outputs(
    params: GroupstatsdiffParamsDict,
    execution: Execution,
) -> GroupstatsdiffOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = GroupstatsdiffOutputs(
        root=execution.output_file("."),
    )
    return ret


def groupstatsdiff_execute(
    params: GroupstatsdiffParamsDict,
    runner: Runner | None = None,
) -> GroupstatsdiffOutputs:
    """
    groupstatsdiff
    
    Evaluate the differences between two groupstats outputs from recon-all
    analyses in Freesurfer.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `GroupstatsdiffOutputs`).
    """
    groupstatsdiff_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(GROUPSTATSDIFF_METADATA)
    params = execution.params(params)
    cargs = groupstatsdiff_cargs(params, execution)
    ret = groupstatsdiff_outputs(params, execution)
    execution.run(cargs)
    return ret


def groupstatsdiff(
    group1_dir: str,
    group2_dir: str,
    output_dir: str,
    no_maps: bool = False,
    osgm: bool = False,
    no_common: bool = False,
    allow_subj_diff: bool = False,
    no_area: bool = False,
    no_volume: bool = False,
    no_ba: bool = False,
    no_aparcstats: bool = False,
    no_asegstats: bool = False,
    no_wparcstats: bool = False,
    no_stats: bool = False,
    no_prune: bool = False,
    fwhm_value: float | None = None,
    subjects_dir1: str | None = None,
    subjects_dir2: str | None = None,
    no_dice: bool = False,
    dice_ctab: str | None = None,
    runner: Runner | None = None,
) -> GroupstatsdiffOutputs:
    """
    groupstatsdiff
    
    Evaluate the differences between two groupstats outputs from recon-all
    analyses in Freesurfer.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        group1_dir: Output folder from groupstats for group 1.
        group2_dir: Output folder from groupstats for group 2.
        output_dir: Output folder for the difference analysis.
        no_maps: Only analyze ROI data, no maps.
        osgm: Use OSGM instead of native FSGD.
        no_common: Do not select common segments when running stattablediff.
        allow_subj_diff: Allow list of subjects to be different between the two\
            analyses.
        no_area: Do not compute area differences.
        no_volume: Do not compute volume differences.
        no_ba: Do not compute differences for BA labels.
        no_aparcstats: Do not do aparcstats.
        no_asegstats: Do not do asegstats.
        no_wparcstats: Do not do wmparcstats.
        no_stats: Do not do any ROI stats.
        no_prune: Do not prune when running mri_glmfit.
        fwhm_value: Override the FWHM from group analysis.
        subjects_dir1: Subjects directory 1 for computing dice (default is\
            parent dir of groupdir).
        subjects_dir2: Subjects directory 2 for computing dice (default is\
            parent dir of groupdir).
        no_dice: Do not compute dice.
        dice_ctab: CTAB to use for dice computation (default is\
            /usr/local/freesurfer/ASegStatsLUT.txt).
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `GroupstatsdiffOutputs`).
    """
    params = groupstatsdiff_params(
        group1_dir=group1_dir,
        group2_dir=group2_dir,
        output_dir=output_dir,
        no_maps=no_maps,
        osgm=osgm,
        no_common=no_common,
        allow_subj_diff=allow_subj_diff,
        no_area=no_area,
        no_volume=no_volume,
        no_ba=no_ba,
        no_aparcstats=no_aparcstats,
        no_asegstats=no_asegstats,
        no_wparcstats=no_wparcstats,
        no_stats=no_stats,
        no_prune=no_prune,
        fwhm_value=fwhm_value,
        subjects_dir1=subjects_dir1,
        subjects_dir2=subjects_dir2,
        no_dice=no_dice,
        dice_ctab=dice_ctab,
    )
    return groupstatsdiff_execute(params, runner)


__all__ = [
    "GROUPSTATSDIFF_METADATA",
    "GroupstatsdiffOutputs",
    "GroupstatsdiffParamsDict",
    "GroupstatsdiffParamsDictTagged",
    "groupstatsdiff",
    "groupstatsdiff_execute",
    "groupstatsdiff_params",
]
