# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

MRI_SEG_DIFF_METADATA = Metadata(
    id="6008110879226277aaf1fbd6a697cbdc19b49716.boutiques",
    name="mri_seg_diff",
    package="freesurfer",
    container_image_tag="freesurfer/freesurfer:7.4.1",
)


_MriSegDiffParamsDictNoTag = typing.TypedDict('_MriSegDiffParamsDictNoTag', {
    "seg1": typing.NotRequired[InputPathType | None],
    "seg2": typing.NotRequired[InputPathType | None],
    "seg": typing.NotRequired[InputPathType | None],
    "diff": str,
    "diff_in": typing.NotRequired[InputPathType | None],
    "merged": typing.NotRequired[str | None],
    "diff_force": bool,
    "debug": bool,
    "checkopts": bool,
    "version": bool,
})
MriSegDiffParamsDictTagged = typing.TypedDict('MriSegDiffParamsDictTagged', {
    "@type": typing.Literal["freesurfer/mri_seg_diff"],
    "seg1": typing.NotRequired[InputPathType | None],
    "seg2": typing.NotRequired[InputPathType | None],
    "seg": typing.NotRequired[InputPathType | None],
    "diff": str,
    "diff_in": typing.NotRequired[InputPathType | None],
    "merged": typing.NotRequired[str | None],
    "diff_force": bool,
    "debug": bool,
    "checkopts": bool,
    "version": bool,
})
MriSegDiffParamsDict = _MriSegDiffParamsDictNoTag | MriSegDiffParamsDictTagged


class MriSegDiffOutputs(typing.NamedTuple):
    """
    Output object returned when calling `MriSegDiffParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    diff_output: OutputPathType
    """Output diff segmentation file."""
    merged_output: OutputPathType | None
    """Output merged segmentation file."""


def mri_seg_diff_params(
    diff: str,
    seg1: InputPathType | None = None,
    seg2: InputPathType | None = None,
    seg: InputPathType | None = None,
    diff_in: InputPathType | None = None,
    merged: str | None = None,
    diff_force: bool = False,
    debug: bool = False,
    checkopts: bool = False,
    version: bool = False,
) -> MriSegDiffParamsDictTagged:
    """
    Build parameters.
    
    Args:
        diff: Output diff segmentation volume.
        seg1: First segmentation file (e.g., unedited).
        seg2: Second segmentation file (e.g., edited).
        seg: Source segmentation file (e.g., unedited).
        diff_in: Input diff segmentation volume.
        merged: Merged output, combining unedited with diff.
        diff_force: Force creation of a diff even if no diff is detected.
        debug: Turn on debugging.
        checkopts: Check options and exit without running.
        version: Print out version and exit.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "freesurfer/mri_seg_diff",
        "diff": diff,
        "diff_force": diff_force,
        "debug": debug,
        "checkopts": checkopts,
        "version": version,
    }
    if seg1 is not None:
        params["seg1"] = seg1
    if seg2 is not None:
        params["seg2"] = seg2
    if seg is not None:
        params["seg"] = seg
    if diff_in is not None:
        params["diff_in"] = diff_in
    if merged is not None:
        params["merged"] = merged
    return params


def mri_seg_diff_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `MriSegDiffParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("seg1", None) is not None:
        if not isinstance(params["seg1"], (pathlib.Path, str)):
            raise StyxValidationError(f'`seg1` has the wrong type: Received `{type(params.get("seg1", None))}` expected `InputPathType | None`')
    if params.get("seg2", None) is not None:
        if not isinstance(params["seg2"], (pathlib.Path, str)):
            raise StyxValidationError(f'`seg2` has the wrong type: Received `{type(params.get("seg2", None))}` expected `InputPathType | None`')
    if params.get("seg", None) is not None:
        if not isinstance(params["seg"], (pathlib.Path, str)):
            raise StyxValidationError(f'`seg` has the wrong type: Received `{type(params.get("seg", None))}` expected `InputPathType | None`')
    if params.get("diff", None) is None:
        raise StyxValidationError("`diff` must not be None")
    if not isinstance(params["diff"], str):
        raise StyxValidationError(f'`diff` has the wrong type: Received `{type(params.get("diff", None))}` expected `str`')
    if params.get("diff_in", None) is not None:
        if not isinstance(params["diff_in"], (pathlib.Path, str)):
            raise StyxValidationError(f'`diff_in` has the wrong type: Received `{type(params.get("diff_in", None))}` expected `InputPathType | None`')
    if params.get("merged", None) is not None:
        if not isinstance(params["merged"], str):
            raise StyxValidationError(f'`merged` has the wrong type: Received `{type(params.get("merged", None))}` expected `str | None`')
    if params.get("diff_force", False) is None:
        raise StyxValidationError("`diff_force` must not be None")
    if not isinstance(params["diff_force"], bool):
        raise StyxValidationError(f'`diff_force` has the wrong type: Received `{type(params.get("diff_force", False))}` expected `bool`')
    if params.get("debug", False) is None:
        raise StyxValidationError("`debug` must not be None")
    if not isinstance(params["debug"], bool):
        raise StyxValidationError(f'`debug` has the wrong type: Received `{type(params.get("debug", False))}` expected `bool`')
    if params.get("checkopts", False) is None:
        raise StyxValidationError("`checkopts` must not be None")
    if not isinstance(params["checkopts"], bool):
        raise StyxValidationError(f'`checkopts` has the wrong type: Received `{type(params.get("checkopts", False))}` expected `bool`')
    if params.get("version", False) is None:
        raise StyxValidationError("`version` must not be None")
    if not isinstance(params["version"], bool):
        raise StyxValidationError(f'`version` has the wrong type: Received `{type(params.get("version", False))}` expected `bool`')


def mri_seg_diff_cargs(
    params: MriSegDiffParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("mri_seg_diff")
    if params.get("seg1", None) is not None:
        cargs.extend([
            "--seg1",
            execution.input_file(params.get("seg1", None))
        ])
    if params.get("seg2", None) is not None:
        cargs.extend([
            "--seg2",
            execution.input_file(params.get("seg2", None))
        ])
    if params.get("seg", None) is not None:
        cargs.extend([
            "--seg",
            execution.input_file(params.get("seg", None))
        ])
    cargs.extend([
        "--diff",
        params.get("diff", None)
    ])
    if params.get("diff_in", None) is not None:
        cargs.extend([
            "--diff-in",
            execution.input_file(params.get("diff_in", None))
        ])
    if params.get("merged", None) is not None:
        cargs.extend([
            "--merged",
            params.get("merged", None)
        ])
    if params.get("diff_force", False):
        cargs.append("--diff-force")
    if params.get("debug", False):
        cargs.append("--debug")
    if params.get("checkopts", False):
        cargs.append("--checkopts")
    if params.get("version", False):
        cargs.append("--version")
    return cargs


def mri_seg_diff_outputs(
    params: MriSegDiffParamsDict,
    execution: Execution,
) -> MriSegDiffOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = MriSegDiffOutputs(
        root=execution.output_file("."),
        diff_output=execution.output_file(params.get("diff", None)),
        merged_output=execution.output_file(params.get("merged", None)) if (params.get("merged") is not None) else None,
    )
    return ret


def mri_seg_diff_execute(
    params: MriSegDiffParamsDict,
    runner: Runner | None = None,
) -> MriSegDiffOutputs:
    """
    mri_seg_diff
    
    This program computes and merges differences in segmentation volumes,
    primarily for managing manual edits in FreeSurfer's aseg.mgz.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MriSegDiffOutputs`).
    """
    mri_seg_diff_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(MRI_SEG_DIFF_METADATA)
    params = execution.params(params)
    cargs = mri_seg_diff_cargs(params, execution)
    ret = mri_seg_diff_outputs(params, execution)
    execution.run(cargs)
    return ret


def mri_seg_diff(
    diff: str,
    seg1: InputPathType | None = None,
    seg2: InputPathType | None = None,
    seg: InputPathType | None = None,
    diff_in: InputPathType | None = None,
    merged: str | None = None,
    diff_force: bool = False,
    debug: bool = False,
    checkopts: bool = False,
    version: bool = False,
    runner: Runner | None = None,
) -> MriSegDiffOutputs:
    """
    mri_seg_diff
    
    This program computes and merges differences in segmentation volumes,
    primarily for managing manual edits in FreeSurfer's aseg.mgz.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        diff: Output diff segmentation volume.
        seg1: First segmentation file (e.g., unedited).
        seg2: Second segmentation file (e.g., edited).
        seg: Source segmentation file (e.g., unedited).
        diff_in: Input diff segmentation volume.
        merged: Merged output, combining unedited with diff.
        diff_force: Force creation of a diff even if no diff is detected.
        debug: Turn on debugging.
        checkopts: Check options and exit without running.
        version: Print out version and exit.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MriSegDiffOutputs`).
    """
    params = mri_seg_diff_params(
        seg1=seg1,
        seg2=seg2,
        seg=seg,
        diff=diff,
        diff_in=diff_in,
        merged=merged,
        diff_force=diff_force,
        debug=debug,
        checkopts=checkopts,
        version=version,
    )
    return mri_seg_diff_execute(params, runner)


__all__ = [
    "MRI_SEG_DIFF_METADATA",
    "MriSegDiffOutputs",
    "MriSegDiffParamsDict",
    "MriSegDiffParamsDictTagged",
    "mri_seg_diff",
    "mri_seg_diff_execute",
    "mri_seg_diff_params",
]
