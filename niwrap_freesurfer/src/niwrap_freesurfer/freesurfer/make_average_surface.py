# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

MAKE_AVERAGE_SURFACE_METADATA = Metadata(
    id="94c5bf3efca7b9fdd1f04d2277eaabf0efcf3d85.boutiques",
    name="make_average_surface",
    package="freesurfer",
    container_image_tag="freesurfer/freesurfer:7.4.1",
)


_MakeAverageSurfaceParamsDictNoTag = typing.TypedDict('_MakeAverageSurfaceParamsDictNoTag', {
    "subjects": list[str],
    "fsgd_file": typing.NotRequired[InputPathType | None],
    "average_subject_name": typing.NotRequired[str | None],
    "subjects_dir": typing.NotRequired[str | None],
    "sd_out_dir": typing.NotRequired[str | None],
    "transform_file": typing.NotRequired[str | None],
    "icosahedron_number": typing.NotRequired[float | None],
    "surf_reg": typing.NotRequired[str | None],
    "left_hemi": bool,
    "right_hemi": bool,
    "force": bool,
    "annot_template": bool,
    "template_only": bool,
    "no_template_only": bool,
    "no_annot": bool,
    "no_cortex_label": bool,
    "annot_list": typing.NotRequired[list[str] | None],
    "meas_list": typing.NotRequired[list[str] | None],
    "no_surf2surf": bool,
    "no_symlink": bool,
    "version": bool,
    "echo": bool,
})
MakeAverageSurfaceParamsDictTagged = typing.TypedDict('MakeAverageSurfaceParamsDictTagged', {
    "@type": typing.Literal["freesurfer/make_average_surface"],
    "subjects": list[str],
    "fsgd_file": typing.NotRequired[InputPathType | None],
    "average_subject_name": typing.NotRequired[str | None],
    "subjects_dir": typing.NotRequired[str | None],
    "sd_out_dir": typing.NotRequired[str | None],
    "transform_file": typing.NotRequired[str | None],
    "icosahedron_number": typing.NotRequired[float | None],
    "surf_reg": typing.NotRequired[str | None],
    "left_hemi": bool,
    "right_hemi": bool,
    "force": bool,
    "annot_template": bool,
    "template_only": bool,
    "no_template_only": bool,
    "no_annot": bool,
    "no_cortex_label": bool,
    "annot_list": typing.NotRequired[list[str] | None],
    "meas_list": typing.NotRequired[list[str] | None],
    "no_surf2surf": bool,
    "no_symlink": bool,
    "version": bool,
    "echo": bool,
})
MakeAverageSurfaceParamsDict = _MakeAverageSurfaceParamsDictNoTag | MakeAverageSurfaceParamsDictTagged


class MakeAverageSurfaceOutputs(typing.NamedTuple):
    """
    Output object returned when calling `MakeAverageSurfaceParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""


def make_average_surface_params(
    subjects: list[str],
    fsgd_file: InputPathType | None = None,
    average_subject_name: str | None = None,
    subjects_dir: str | None = None,
    sd_out_dir: str | None = None,
    transform_file: str | None = None,
    icosahedron_number: float | None = None,
    surf_reg: str | None = None,
    left_hemi: bool = False,
    right_hemi: bool = False,
    force: bool = False,
    annot_template: bool = False,
    template_only: bool = False,
    no_template_only: bool = False,
    no_annot: bool = False,
    no_cortex_label: bool = False,
    annot_list: list[str] | None = None,
    meas_list: list[str] | None = None,
    no_surf2surf: bool = False,
    no_symlink: bool = False,
    version: bool = False,
    echo: bool = False,
) -> MakeAverageSurfaceParamsDictTagged:
    """
    Build parameters.
    
    Args:
        subjects: List of subject names.
        fsgd_file: File from which to get the subject list.
        average_subject_name: Average subject name.
        subjects_dir: Directory for SUBJECTS_DIR (if different from the\
            environment variable).
        sd_out_dir: Directory to put output data.
        transform_file: Filename of the transform file.
        icosahedron_number: Specify icosahedron number.
        surf_reg: Alternative registration surface name.
        left_hemi: Only process the left hemisphere.
        right_hemi: Only process the right hemisphere.
        force: Overwrite existing average subject data.
        annot_template: Use annotation when making tif.
        template_only: Useful when creating iterative atlases.
        no_template_only: Turns off --template-only.
        no_annot: Do not create average annotations.
        no_cortex_label: Do not create ?h.cortex.label.
        annot_list: List of annotations to use.
        meas_list: List of measurements to use.
        no_surf2surf: Use old parametric surface method.
        no_symlink: Do not use symbolic links, just copy files.
        version: Script version information.
        echo: Enable command echo for debugging.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "freesurfer/make_average_surface",
        "subjects": subjects,
        "left_hemi": left_hemi,
        "right_hemi": right_hemi,
        "force": force,
        "annot_template": annot_template,
        "template_only": template_only,
        "no_template_only": no_template_only,
        "no_annot": no_annot,
        "no_cortex_label": no_cortex_label,
        "no_surf2surf": no_surf2surf,
        "no_symlink": no_symlink,
        "version": version,
        "echo": echo,
    }
    if fsgd_file is not None:
        params["fsgd_file"] = fsgd_file
    if average_subject_name is not None:
        params["average_subject_name"] = average_subject_name
    if subjects_dir is not None:
        params["subjects_dir"] = subjects_dir
    if sd_out_dir is not None:
        params["sd_out_dir"] = sd_out_dir
    if transform_file is not None:
        params["transform_file"] = transform_file
    if icosahedron_number is not None:
        params["icosahedron_number"] = icosahedron_number
    if surf_reg is not None:
        params["surf_reg"] = surf_reg
    if annot_list is not None:
        params["annot_list"] = annot_list
    if meas_list is not None:
        params["meas_list"] = meas_list
    return params


def make_average_surface_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `MakeAverageSurfaceParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("subjects", None) is None:
        raise StyxValidationError("`subjects` must not be None")
    if not isinstance(params["subjects"], list):
        raise StyxValidationError(f'`subjects` has the wrong type: Received `{type(params.get("subjects", None))}` expected `list[str]`')
    for e in params["subjects"]:
        if not isinstance(e, str):
            raise StyxValidationError(f'`subjects` has the wrong type: Received `{type(params.get("subjects", None))}` expected `list[str]`')
    if params.get("fsgd_file", None) is not None:
        if not isinstance(params["fsgd_file"], (pathlib.Path, str)):
            raise StyxValidationError(f'`fsgd_file` has the wrong type: Received `{type(params.get("fsgd_file", None))}` expected `InputPathType | None`')
    if params.get("average_subject_name", None) is not None:
        if not isinstance(params["average_subject_name"], str):
            raise StyxValidationError(f'`average_subject_name` has the wrong type: Received `{type(params.get("average_subject_name", None))}` expected `str | None`')
    if params.get("subjects_dir", None) is not None:
        if not isinstance(params["subjects_dir"], str):
            raise StyxValidationError(f'`subjects_dir` has the wrong type: Received `{type(params.get("subjects_dir", None))}` expected `str | None`')
    if params.get("sd_out_dir", None) is not None:
        if not isinstance(params["sd_out_dir"], str):
            raise StyxValidationError(f'`sd_out_dir` has the wrong type: Received `{type(params.get("sd_out_dir", None))}` expected `str | None`')
    if params.get("transform_file", None) is not None:
        if not isinstance(params["transform_file"], str):
            raise StyxValidationError(f'`transform_file` has the wrong type: Received `{type(params.get("transform_file", None))}` expected `str | None`')
    if params.get("icosahedron_number", None) is not None:
        if not isinstance(params["icosahedron_number"], (float, int)):
            raise StyxValidationError(f'`icosahedron_number` has the wrong type: Received `{type(params.get("icosahedron_number", None))}` expected `float | None`')
    if params.get("surf_reg", None) is not None:
        if not isinstance(params["surf_reg"], str):
            raise StyxValidationError(f'`surf_reg` has the wrong type: Received `{type(params.get("surf_reg", None))}` expected `str | None`')
    if params.get("left_hemi", False) is None:
        raise StyxValidationError("`left_hemi` must not be None")
    if not isinstance(params["left_hemi"], bool):
        raise StyxValidationError(f'`left_hemi` has the wrong type: Received `{type(params.get("left_hemi", False))}` expected `bool`')
    if params.get("right_hemi", False) is None:
        raise StyxValidationError("`right_hemi` must not be None")
    if not isinstance(params["right_hemi"], bool):
        raise StyxValidationError(f'`right_hemi` has the wrong type: Received `{type(params.get("right_hemi", False))}` expected `bool`')
    if params.get("force", False) is None:
        raise StyxValidationError("`force` must not be None")
    if not isinstance(params["force"], bool):
        raise StyxValidationError(f'`force` has the wrong type: Received `{type(params.get("force", False))}` expected `bool`')
    if params.get("annot_template", False) is None:
        raise StyxValidationError("`annot_template` must not be None")
    if not isinstance(params["annot_template"], bool):
        raise StyxValidationError(f'`annot_template` has the wrong type: Received `{type(params.get("annot_template", False))}` expected `bool`')
    if params.get("template_only", False) is None:
        raise StyxValidationError("`template_only` must not be None")
    if not isinstance(params["template_only"], bool):
        raise StyxValidationError(f'`template_only` has the wrong type: Received `{type(params.get("template_only", False))}` expected `bool`')
    if params.get("no_template_only", False) is None:
        raise StyxValidationError("`no_template_only` must not be None")
    if not isinstance(params["no_template_only"], bool):
        raise StyxValidationError(f'`no_template_only` has the wrong type: Received `{type(params.get("no_template_only", False))}` expected `bool`')
    if params.get("no_annot", False) is None:
        raise StyxValidationError("`no_annot` must not be None")
    if not isinstance(params["no_annot"], bool):
        raise StyxValidationError(f'`no_annot` has the wrong type: Received `{type(params.get("no_annot", False))}` expected `bool`')
    if params.get("no_cortex_label", False) is None:
        raise StyxValidationError("`no_cortex_label` must not be None")
    if not isinstance(params["no_cortex_label"], bool):
        raise StyxValidationError(f'`no_cortex_label` has the wrong type: Received `{type(params.get("no_cortex_label", False))}` expected `bool`')
    if params.get("annot_list", None) is not None:
        if not isinstance(params["annot_list"], list):
            raise StyxValidationError(f'`annot_list` has the wrong type: Received `{type(params.get("annot_list", None))}` expected `list[str] | None`')
        for e in params["annot_list"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`annot_list` has the wrong type: Received `{type(params.get("annot_list", None))}` expected `list[str] | None`')
    if params.get("meas_list", None) is not None:
        if not isinstance(params["meas_list"], list):
            raise StyxValidationError(f'`meas_list` has the wrong type: Received `{type(params.get("meas_list", None))}` expected `list[str] | None`')
        for e in params["meas_list"]:
            if not isinstance(e, str):
                raise StyxValidationError(f'`meas_list` has the wrong type: Received `{type(params.get("meas_list", None))}` expected `list[str] | None`')
    if params.get("no_surf2surf", False) is None:
        raise StyxValidationError("`no_surf2surf` must not be None")
    if not isinstance(params["no_surf2surf"], bool):
        raise StyxValidationError(f'`no_surf2surf` has the wrong type: Received `{type(params.get("no_surf2surf", False))}` expected `bool`')
    if params.get("no_symlink", False) is None:
        raise StyxValidationError("`no_symlink` must not be None")
    if not isinstance(params["no_symlink"], bool):
        raise StyxValidationError(f'`no_symlink` has the wrong type: Received `{type(params.get("no_symlink", False))}` expected `bool`')
    if params.get("version", False) is None:
        raise StyxValidationError("`version` must not be None")
    if not isinstance(params["version"], bool):
        raise StyxValidationError(f'`version` has the wrong type: Received `{type(params.get("version", False))}` expected `bool`')
    if params.get("echo", False) is None:
        raise StyxValidationError("`echo` must not be None")
    if not isinstance(params["echo"], bool):
        raise StyxValidationError(f'`echo` has the wrong type: Received `{type(params.get("echo", False))}` expected `bool`')


def make_average_surface_cargs(
    params: MakeAverageSurfaceParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("make_average_surface")
    cargs.extend(params.get("subjects", None))
    if params.get("fsgd_file", None) is not None:
        cargs.extend([
            "--fsgd",
            execution.input_file(params.get("fsgd_file", None))
        ])
    if params.get("average_subject_name", None) is not None:
        cargs.extend([
            "--out",
            params.get("average_subject_name", None)
        ])
    if params.get("subjects_dir", None) is not None:
        cargs.extend([
            "--sdir",
            params.get("subjects_dir", None)
        ])
    if params.get("sd_out_dir", None) is not None:
        cargs.extend([
            "--sd-out",
            params.get("sd_out_dir", None)
        ])
    if params.get("transform_file", None) is not None:
        cargs.extend([
            "--xform",
            params.get("transform_file", None)
        ])
    if params.get("icosahedron_number", None) is not None:
        cargs.extend([
            "--ico",
            str(params.get("icosahedron_number", None))
        ])
    if params.get("surf_reg", None) is not None:
        cargs.extend([
            "--surf-reg",
            params.get("surf_reg", None)
        ])
    if params.get("left_hemi", False):
        cargs.append("--lh")
    if params.get("right_hemi", False):
        cargs.append("--rh")
    if params.get("force", False):
        cargs.append("--force")
    if params.get("annot_template", False):
        cargs.append("--annot-template")
    if params.get("template_only", False):
        cargs.append("--template-only")
    if params.get("no_template_only", False):
        cargs.append("--no-template-only")
    if params.get("no_annot", False):
        cargs.append("--no-annot")
    if params.get("no_cortex_label", False):
        cargs.append("--no-cortex-label")
    if params.get("annot_list", None) is not None:
        cargs.extend([
            "--annot",
            *params.get("annot_list", None)
        ])
    if params.get("meas_list", None) is not None:
        cargs.extend([
            "--meas",
            *params.get("meas_list", None)
        ])
    if params.get("no_surf2surf", False):
        cargs.append("--no-surf2surf")
    if params.get("no_symlink", False):
        cargs.append("--no-symlink")
    if params.get("version", False):
        cargs.append("--version")
    if params.get("echo", False):
        cargs.append("--echo")
    return cargs


def make_average_surface_outputs(
    params: MakeAverageSurfaceParamsDict,
    execution: Execution,
) -> MakeAverageSurfaceOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = MakeAverageSurfaceOutputs(
        root=execution.output_file("."),
    )
    return ret


def make_average_surface_execute(
    params: MakeAverageSurfaceParamsDict,
    runner: Runner | None = None,
) -> MakeAverageSurfaceOutputs:
    """
    make_average_surface
    
    Creates average surfaces and curvatures from a set of subjects.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MakeAverageSurfaceOutputs`).
    """
    make_average_surface_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(MAKE_AVERAGE_SURFACE_METADATA)
    params = execution.params(params)
    cargs = make_average_surface_cargs(params, execution)
    ret = make_average_surface_outputs(params, execution)
    execution.run(cargs)
    return ret


def make_average_surface(
    subjects: list[str],
    fsgd_file: InputPathType | None = None,
    average_subject_name: str | None = None,
    subjects_dir: str | None = None,
    sd_out_dir: str | None = None,
    transform_file: str | None = None,
    icosahedron_number: float | None = None,
    surf_reg: str | None = None,
    left_hemi: bool = False,
    right_hemi: bool = False,
    force: bool = False,
    annot_template: bool = False,
    template_only: bool = False,
    no_template_only: bool = False,
    no_annot: bool = False,
    no_cortex_label: bool = False,
    annot_list: list[str] | None = None,
    meas_list: list[str] | None = None,
    no_surf2surf: bool = False,
    no_symlink: bool = False,
    version: bool = False,
    echo: bool = False,
    runner: Runner | None = None,
) -> MakeAverageSurfaceOutputs:
    """
    make_average_surface
    
    Creates average surfaces and curvatures from a set of subjects.
    
    Author: FreeSurfer Developers
    
    URL: https://github.com/freesurfer/freesurfer
    
    Args:
        subjects: List of subject names.
        fsgd_file: File from which to get the subject list.
        average_subject_name: Average subject name.
        subjects_dir: Directory for SUBJECTS_DIR (if different from the\
            environment variable).
        sd_out_dir: Directory to put output data.
        transform_file: Filename of the transform file.
        icosahedron_number: Specify icosahedron number.
        surf_reg: Alternative registration surface name.
        left_hemi: Only process the left hemisphere.
        right_hemi: Only process the right hemisphere.
        force: Overwrite existing average subject data.
        annot_template: Use annotation when making tif.
        template_only: Useful when creating iterative atlases.
        no_template_only: Turns off --template-only.
        no_annot: Do not create average annotations.
        no_cortex_label: Do not create ?h.cortex.label.
        annot_list: List of annotations to use.
        meas_list: List of measurements to use.
        no_surf2surf: Use old parametric surface method.
        no_symlink: Do not use symbolic links, just copy files.
        version: Script version information.
        echo: Enable command echo for debugging.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `MakeAverageSurfaceOutputs`).
    """
    params = make_average_surface_params(
        subjects=subjects,
        fsgd_file=fsgd_file,
        average_subject_name=average_subject_name,
        subjects_dir=subjects_dir,
        sd_out_dir=sd_out_dir,
        transform_file=transform_file,
        icosahedron_number=icosahedron_number,
        surf_reg=surf_reg,
        left_hemi=left_hemi,
        right_hemi=right_hemi,
        force=force,
        annot_template=annot_template,
        template_only=template_only,
        no_template_only=no_template_only,
        no_annot=no_annot,
        no_cortex_label=no_cortex_label,
        annot_list=annot_list,
        meas_list=meas_list,
        no_surf2surf=no_surf2surf,
        no_symlink=no_symlink,
        version=version,
        echo=echo,
    )
    return make_average_surface_execute(params, runner)


__all__ = [
    "MAKE_AVERAGE_SURFACE_METADATA",
    "MakeAverageSurfaceOutputs",
    "MakeAverageSurfaceParamsDict",
    "MakeAverageSurfaceParamsDictTagged",
    "make_average_surface",
    "make_average_surface_execute",
    "make_average_surface_params",
]
