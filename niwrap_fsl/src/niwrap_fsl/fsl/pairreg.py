# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *

PAIRREG_METADATA = Metadata(
    id="3e9223920603dd7835b054320694b4391fa48046.boutiques",
    name="pairreg",
    package="fsl",
    container_image_tag="brainlife/fsl:6.0.4-patched2",
)


_PairregParamsDictNoTag = typing.TypedDict('_PairregParamsDictNoTag', {
    "brain1": InputPathType,
    "brain2": InputPathType,
    "skull1": InputPathType,
    "skull2": InputPathType,
    "outputmatrix": InputPathType,
    "extra_flirt_args": typing.NotRequired[str | None],
})
PairregParamsDictTagged = typing.TypedDict('PairregParamsDictTagged', {
    "@type": typing.Literal["fsl/pairreg"],
    "brain1": InputPathType,
    "brain2": InputPathType,
    "skull1": InputPathType,
    "skull2": InputPathType,
    "outputmatrix": InputPathType,
    "extra_flirt_args": typing.NotRequired[str | None],
})
PairregParamsDict = _PairregParamsDictNoTag | PairregParamsDictTagged


class PairregOutputs(typing.NamedTuple):
    """
    Output object returned when calling `PairregParamsDict(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""
    output_matrix: OutputPathType
    """Pairwise registration output transformation matrix file"""


def pairreg_params(
    brain1: InputPathType,
    brain2: InputPathType,
    skull1: InputPathType,
    skull2: InputPathType,
    outputmatrix: InputPathType,
    extra_flirt_args: str | None = None,
) -> PairregParamsDictTagged:
    """
    Build parameters.
    
    Args:
        brain1: Brain image 1 (used as -ref internally).
        brain2: Brain image 2.
        skull1: Skull image 1 (used as -ref internally).
        skull2: Skull image 2.
        outputmatrix: Output transformation matrix file.
        extra_flirt_args: Extra arguments to pass to flirt.
    Returns:
        Parameter dictionary
    """
    params = {
        "@type": "fsl/pairreg",
        "brain1": brain1,
        "brain2": brain2,
        "skull1": skull1,
        "skull2": skull2,
        "outputmatrix": outputmatrix,
    }
    if extra_flirt_args is not None:
        params["extra_flirt_args"] = extra_flirt_args
    return params


def pairreg_validate(
    params: typing.Any,
) -> None:
    """
    Validate parameters. Throws an error if `params` is not a valid
    `PairregParamsDict` object.
    
    Args:
        params: The parameters object to validate.
    """
    if params is None or not isinstance(params, dict):
        raise StyxValidationError(f'Params object has the wrong type \'{type(params)}\'')
    if params.get("brain1", None) is None:
        raise StyxValidationError("`brain1` must not be None")
    if not isinstance(params["brain1"], (pathlib.Path, str)):
        raise StyxValidationError(f'`brain1` has the wrong type: Received `{type(params.get("brain1", None))}` expected `InputPathType`')
    if params.get("brain2", None) is None:
        raise StyxValidationError("`brain2` must not be None")
    if not isinstance(params["brain2"], (pathlib.Path, str)):
        raise StyxValidationError(f'`brain2` has the wrong type: Received `{type(params.get("brain2", None))}` expected `InputPathType`')
    if params.get("skull1", None) is None:
        raise StyxValidationError("`skull1` must not be None")
    if not isinstance(params["skull1"], (pathlib.Path, str)):
        raise StyxValidationError(f'`skull1` has the wrong type: Received `{type(params.get("skull1", None))}` expected `InputPathType`')
    if params.get("skull2", None) is None:
        raise StyxValidationError("`skull2` must not be None")
    if not isinstance(params["skull2"], (pathlib.Path, str)):
        raise StyxValidationError(f'`skull2` has the wrong type: Received `{type(params.get("skull2", None))}` expected `InputPathType`')
    if params.get("outputmatrix", None) is None:
        raise StyxValidationError("`outputmatrix` must not be None")
    if not isinstance(params["outputmatrix"], (pathlib.Path, str)):
        raise StyxValidationError(f'`outputmatrix` has the wrong type: Received `{type(params.get("outputmatrix", None))}` expected `InputPathType`')
    if params.get("extra_flirt_args", None) is not None:
        if not isinstance(params["extra_flirt_args"], str):
            raise StyxValidationError(f'`extra_flirt_args` has the wrong type: Received `{type(params.get("extra_flirt_args", None))}` expected `str | None`')


def pairreg_cargs(
    params: PairregParamsDict,
    execution: Execution,
) -> list[str]:
    """
    Build command-line arguments from parameters.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Command-line arguments.
    """
    cargs = []
    cargs.append("pairreg")
    cargs.append(execution.input_file(params.get("brain1", None)))
    cargs.append(execution.input_file(params.get("brain2", None)))
    cargs.append(execution.input_file(params.get("skull1", None)))
    cargs.append(execution.input_file(params.get("skull2", None)))
    cargs.append(execution.input_file(params.get("outputmatrix", None)))
    if params.get("extra_flirt_args", None) is not None:
        cargs.append(params.get("extra_flirt_args", None))
    return cargs


def pairreg_outputs(
    params: PairregParamsDict,
    execution: Execution,
) -> PairregOutputs:
    """
    Build outputs object containing output file paths and possibly stdout/stderr.
    
    Args:
        params: The parameters.
        execution: The execution object for resolving input paths.
    Returns:
        Outputs object.
    """
    ret = PairregOutputs(
        root=execution.output_file("."),
        output_matrix=execution.output_file(pathlib.Path(params.get("outputmatrix", None)).name),
    )
    return ret


def pairreg_execute(
    params: PairregParamsDict,
    runner: Runner | None = None,
) -> PairregOutputs:
    """
    pairreg
    
    Pairwise registration tool.
    
    Author: FMRIB Analysis Group, University of Oxford
    
    URL: https://fsl.fmrib.ox.ac.uk/fsl/fslwiki
    
    Args:
        params: The parameters.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `PairregOutputs`).
    """
    pairreg_validate(params)
    runner = runner or get_global_runner()
    execution = runner.start_execution(PAIRREG_METADATA)
    params = execution.params(params)
    cargs = pairreg_cargs(params, execution)
    ret = pairreg_outputs(params, execution)
    execution.run(cargs)
    return ret


def pairreg(
    brain1: InputPathType,
    brain2: InputPathType,
    skull1: InputPathType,
    skull2: InputPathType,
    outputmatrix: InputPathType,
    extra_flirt_args: str | None = None,
    runner: Runner | None = None,
) -> PairregOutputs:
    """
    pairreg
    
    Pairwise registration tool.
    
    Author: FMRIB Analysis Group, University of Oxford
    
    URL: https://fsl.fmrib.ox.ac.uk/fsl/fslwiki
    
    Args:
        brain1: Brain image 1 (used as -ref internally).
        brain2: Brain image 2.
        skull1: Skull image 1 (used as -ref internally).
        skull2: Skull image 2.
        outputmatrix: Output transformation matrix file.
        extra_flirt_args: Extra arguments to pass to flirt.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `PairregOutputs`).
    """
    params = pairreg_params(
        brain1=brain1,
        brain2=brain2,
        skull1=skull1,
        skull2=skull2,
        outputmatrix=outputmatrix,
        extra_flirt_args=extra_flirt_args,
    )
    return pairreg_execute(params, runner)


__all__ = [
    "PAIRREG_METADATA",
    "PairregOutputs",
    "PairregParamsDict",
    "PairregParamsDictTagged",
    "pairreg",
    "pairreg_execute",
    "pairreg_params",
]
